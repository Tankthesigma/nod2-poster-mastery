<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NOD2 Project Mastery ‚Äî ISEF 2026</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=DM+Sans:wght@400;500;700;900&family=Fraunces:wght@700;900&display=swap" rel="stylesheet">
<style>
:root{--bg:#07070d;--s1:#0f0f1a;--s2:#161625;--s3:#1e1e32;--brd:#2a2a42;--txt:#d0d0e0;--mut:#7878a0;--acc:#7c3aed;--a2:#a78bfa;--grn:#10b981;--red:#ef4444;--org:#f59e0b;--cyn:#06b6d4;--pnk:#ec4899;--blu:#3b82f6}
*{margin:0;padding:0;box-sizing:border-box}body{background:var(--bg);color:var(--txt);font-family:'DM Sans',sans-serif;line-height:1.85;font-size:15px}
h1,h2,h3{font-family:'Fraunces',serif}code,pre{font-family:'JetBrains Mono',monospace}
.shell{display:flex;min-height:100vh}.sidebar{width:220px;background:var(--s1);border-right:1px solid var(--brd);position:fixed;top:0;left:0;bottom:0;overflow-y:auto;z-index:50;padding:12px 0}
.sidebar h2{font-size:11px;color:var(--mut);padding:16px 16px 6px;letter-spacing:1.5px;text-transform:uppercase;font-family:'DM Sans',sans-serif;font-weight:700}
.sb{display:block;width:100%;text-align:left;background:none;border:none;color:var(--mut);padding:9px 16px;font-size:13px;font-family:'DM Sans',sans-serif;cursor:pointer;transition:all .12s;border-left:3px solid transparent}
.sb:hover{color:var(--txt);background:rgba(124,58,237,.06)}.sb.on{color:var(--a2);background:rgba(124,58,237,.1);border-left-color:var(--acc)}
.ct{margin-left:220px;flex:1;padding:28px 36px 80px;max-width:900px}
@media(max-width:800px){.sidebar{display:none}.ct{margin-left:0;padding:14px}.mn{display:flex!important}}
.mn{display:none;position:sticky;top:0;z-index:50;background:rgba(7,7,13,.95);backdrop-filter:blur(10px);overflow-x:auto;border-bottom:1px solid var(--brd);padding:0 6px}
.mb{background:none;border:none;color:var(--mut);padding:10px 12px;font-size:11px;font-family:'DM Sans',sans-serif;cursor:pointer;white-space:nowrap;border-bottom:2px solid transparent}
.mb.on{color:var(--a2);border-bottom-color:var(--acc)}
.sec{display:none;animation:fu .25s}.sec.on{display:block}@keyframes fu{from{opacity:0;transform:translateY(5px)}to{opacity:1;transform:none}}
h1{font-size:1.9em;margin-bottom:4px;background:linear-gradient(135deg,var(--a2),var(--cyn));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.sub{color:var(--mut);font-size:13px;margin-bottom:20px}h2{font-size:1.35em;color:var(--a2);margin:28px 0 12px}h3{font-size:1.05em;color:var(--cyn);margin:18px 0 8px;font-family:'DM Sans',sans-serif;font-weight:700}
p{margin-bottom:12px}strong{color:#fff}em{color:var(--a2)}
pre{background:#090914;border:1px solid var(--brd);border-radius:7px;padding:12px;overflow-x:auto;font-size:12px;line-height:1.65;margin:8px 0;color:#b0b0c8}
code{background:rgba(124,58,237,.12);padding:1px 4px;border-radius:3px;font-size:.87em;color:var(--a2)}
table{width:100%;border-collapse:collapse;margin:8px 0;font-size:13px}th{background:var(--s2);padding:8px 10px;text-align:left;border-bottom:2px solid var(--acc);font-weight:700;font-size:11px;text-transform:uppercase;letter-spacing:.4px}td{padding:8px 10px;border-bottom:1px solid var(--brd)}
.n{color:var(--org);font-weight:700;font-family:'JetBrains Mono',monospace}
.au{display:inline-flex;align-items:center;gap:3px;background:rgba(245,158,11,.1);border:1px solid rgba(245,158,11,.22);color:var(--org);padding:2px 8px;border-radius:16px;font-size:11px;cursor:pointer;font-family:'DM Sans',sans-serif;transition:all .12s;margin:1px;vertical-align:middle}
.au:hover{background:rgba(245,158,11,.2)}.au.pl{background:rgba(245,158,11,.3);box-shadow:0 0 6px rgba(245,158,11,.25)}
ol,ul{padding-left:20px;margin-bottom:10px}li{margin-bottom:5px}
.c{background:var(--s1);border:1px solid var(--brd);border-radius:10px;padding:18px;margin:12px 0}
.ca{border-left:3px solid var(--acc)}.cg{border-left:3px solid var(--grn)}.co{border-left:3px solid var(--org)}.cr{border-left:3px solid var(--red)}.cc{border-left:3px solid var(--cyn)}.cp{border-left:3px solid var(--pnk)}.cb{border-left:3px solid var(--blu)}
.ex{margin:8px 0}.exh{display:flex;align-items:center;gap:6px;cursor:pointer;padding:10px 12px;background:var(--s2);border:1px solid var(--brd);border-radius:7px;font-weight:500;transition:all .12s;font-size:13px}
.exh:hover{background:var(--s3)}.ea{transition:transform .12s;font-size:10px}.exh.op .ea{transform:rotate(90deg)}
.exb{display:none;padding:14px;background:var(--s1);border:1px solid var(--brd);border-top:none;border-radius:0 0 7px 7px;font-size:13.5px;line-height:1.85}.exb.op{display:block}
.tg{display:inline-block;padding:1px 7px;border-radius:3px;font-size:10px;font-weight:700;margin-right:3px}
.tw{background:rgba(124,58,237,.2);color:var(--a2)}.tc{background:rgba(6,182,212,.2);color:var(--cyn)}.tj{background:rgba(16,185,129,.2);color:var(--grn)}.tx{background:rgba(239,68,68,.2);color:var(--red)}.tl{background:rgba(236,72,153,.2);color:var(--pnk)}.ti{background:rgba(245,158,11,.2);color:var(--org)}
.vs{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin:12px 0}@media(max-width:700px){.vs{grid-template-columns:1fr}}
.vw{padding:14px;border-radius:8px;background:rgba(16,185,129,.06);border:1px solid rgba(16,185,129,.22)}.vl{padding:14px;border-radius:8px;background:rgba(239,68,68,.04);border:1px solid rgba(239,68,68,.15)}
.ky{background:linear-gradient(135deg,rgba(124,58,237,.07),rgba(6,182,212,.07));border:1px solid rgba(124,58,237,.18);border-radius:10px;padding:16px 18px;margin:12px 0;position:relative}
.gg{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:6px;margin:10px 0}
.gi{background:var(--s2);border:1px solid var(--brd);border-radius:7px;padding:8px 10px;font-size:12px;cursor:pointer;transition:all .12s}
.gi:hover{border-color:var(--acc);background:var(--s3)}
.build{background:var(--s2);border:1px solid var(--brd);border-radius:8px;padding:14px 16px;margin:10px 0;position:relative;overflow:hidden}
.build::before{content:'üß±';position:absolute;top:10px;right:12px;font-size:16px;opacity:.5}
.build h4{color:var(--org);font-size:13px;font-family:'DM Sans',sans-serif;margin-bottom:6px;font-weight:700}
.bridge{background:linear-gradient(90deg,rgba(124,58,237,.08),rgba(6,182,212,.08));border:1px solid rgba(124,58,237,.15);border-radius:8px;padding:14px 16px;margin:16px 0;font-style:italic;color:var(--a2);font-size:14px}
.cmt{color:#6a9955}.kw{color:#c586c0}.str{color:#ce9178}.fn{color:#dcdcaa}
</style>
</head>
<body>
<div class="mn" id="mn"></div>
<div class="shell">
<nav class="sidebar" id="sb"><h2>ISEF Mastery</h2></nav>
<main class="ct" id="ct"></main>
</div>
<script>
let cA=null;
function pa(f,b){if(cA){cA.pause();document.querySelectorAll('.au.pl').forEach(x=>x.classList.remove('pl'))}
const a=new Audio('audio/'+f+'.mp3');cA=a;if(b)b.classList.add('pl');
a.onended=()=>{if(b)b.classList.remove('pl')};
a.onerror=()=>{if('speechSynthesis'in window){const u=new SpeechSynthesisUtterance(b?.dataset?.fb||f);u.rate=0.7;speechSynthesis.speak(u)}if(b)setTimeout(()=>b.classList.remove('pl'),2e3)};a.play()}
function au(f,l,fb){return`<button class="au" data-fb="${fb||l}" onclick="pa('${f}',this)">üîä ${l}</button>`}
function ex(t,ti,bo){const id='e'+Math.random().toString(36).substr(2,6);const tc={w:'tw',c:'tc',j:'tj',x:'tx',l:'tl',i:'ti'}[t]||'tw';const tn={w:'WHY THIS MATTERS',c:'YOUR ACTUAL CODE',j:'JUDGE Q&A',x:'CRASH STORY',l:'HOW YOU LEARNED THIS',i:'WHAT-IF'}[t]||t.toUpperCase();
return`<div class="ex"><div class="exh" onclick="this.classList.toggle('op');document.getElementById('${id}').classList.toggle('op')"><span class="ea">‚ñ∂</span><span class="tg ${tc}">${tn}</span>${ti}</div><div class="exb" id="${id}">${bo}</div></div>`}
function build(title,body){return`<div class="build"><h4>üß± BUILDING BLOCK ‚Äî ${title}</h4>${body}</div>`}
function bridge(text){return`<div class="bridge">üîó ${text}</div>`}

const S=[

// ============ GLOSSARY ============
{id:'glo',icon:'üìñ',label:'Audio Glossary',ct:`
<h1>Audio Pronunciation Glossary</h1>
<p class="sub">75 terms with Google TTS. Tap üîä to hear each one. Come back here whenever a term trips you up.</p>

<h2>Biology & Disease</h2>
<div class="gg">
<div class="gi"><strong>NOD2</strong><br><small>Immune sensor protein</small>${au('NOD2','NOD2')}</div>
<div class="gi"><strong>MDP</strong><br><small>Bacterial wall fragment</small>${au('MDP','MDP')}</div>
<div class="gi"><strong>Muramyl Dipeptide</strong><br><small>Full name of MDP</small>${au('muramyl_dipeptide','Muramyl Dipeptide')}</div>
<div class="gi"><strong>R702W</strong><br><small>Your mutation</small>${au('R702W','R702W')}</div>
<div class="gi"><strong>NF-Œ∫B</strong><br><small>Transcription factor</small>${au('NF_kappa_B','NF-Œ∫B')}</div>
<div class="gi"><strong>RIPK2</strong><br><small>Signaling kinase</small>${au('RIPK2','RIPK2')}</div>
<div class="gi"><strong>TAK1</strong><br><small>Kinase complex</small>${au('TAK1','TAK1')}</div>
<div class="gi"><strong>Crohn's Disease</strong><br><small>Inflammatory bowel</small>${au('crohns',"Crohn's")}</div>
<div class="gi"><strong>Allosteric</strong><br><small>Distant-site effect</small>${au('allosteric','Allosteric')}</div>
<div class="gi"><strong>LRR Domain</strong><br><small>Where drugs bind</small>${au('LRR','LRR')}</div>
<div class="gi"><strong>Arginine (R)</strong><br><small>Normal at 702</small>${au('arginine','Arginine')}</div>
<div class="gi"><strong>Tryptophan (W)</strong><br><small>Mutant at 702</small>${au('tryptophan','Tryptophan')}</div>
<div class="gi"><strong>ASP1011</strong><br><small>Key pocket residue</small>${au('ASP1011','ASP1011')}</div>
<div class="gi"><strong>Residue</strong><br><small>One amino acid in chain</small>${au('residue','Residue')}</div>
</div>

<h2>Computational Methods</h2>
<div class="gg">
<div class="gi"><strong>GNINA</strong><br><small>CNN docking tool</small>${au('GNINA','GNINA')}</div>
<div class="gi"><strong>CNN</strong><br><small>Neural network type</small>${au('CNN','CNN')}</div>
<div class="gi"><strong>XGBoost</strong><br><small>ML tree algorithm</small>${au('XGBoost','XGBoost')}</div>
<div class="gi"><strong>Morgan FP</strong><br><small>Molecular barcode</small>${au('morgan_fingerprint','Morgan FP')}</div>
<div class="gi"><strong>Scaffold Split</strong><br><small>Honest data splitting</small>${au('scaffold_split','Scaffold Split')}</div>
<div class="gi"><strong>Pseudo-Label</strong><br><small>Proxy training labels</small>${au('pseudo_label','Pseudo Label')}</div>
<div class="gi"><strong>AUC</strong><br><small>ML accuracy metric</small>${au('AUC','AUC')}</div>
<div class="gi"><strong>ROC</strong><br><small>Performance curve</small>${au('ROC','ROC')}</div>
<div class="gi"><strong>ADMET</strong><br><small>Drug safety filters</small>${au('ADMET','ADMET')}</div>
<div class="gi"><strong>Lipinski</strong><br><small>Rule of 5</small>${au('lipinski','Lipinski')}</div>
<div class="gi"><strong>PAINS</strong><br><small>False positive filters</small>${au('PAINS','PAINS')}</div>
<div class="gi"><strong>TPSA</strong><br><small>Polar surface area</small>${au('TPSA','TPSA')}</div>
<div class="gi"><strong>Murcko Scaffold</strong><br><small>Core backbone</small>${au('Murcko','Murcko')}</div>
<div class="gi"><strong>Docking</strong><br><small>Drug-protein fitting</small>${au('docking','Docking')}</div>
<div class="gi"><strong>Binding Pocket</strong><br><small>Where drugs sit</small>${au('binding_pocket','Binding Pocket')}</div>
<div class="gi"><strong>Data Leakage</strong><br><small>Test contamination</small>${au('data_leakage','Data Leakage')}</div>
</div>

<h2>Molecular Dynamics & Physics</h2>
<div class="gg">
<div class="gi"><strong>MD</strong><br><small>F=ma for atoms</small>${au('molecular_dynamics','MD')}</div>
<div class="gi"><strong>OpenMM</strong><br><small>Simulation engine</small>${au('OpenMM','OpenMM')}</div>
<div class="gi"><strong>AMBER14</strong><br><small>Protein force field</small>${au('AMBER14','AMBER14')}</div>
<div class="gi"><strong>TIP3P-FB</strong><br><small>Water model</small>${au('TIP3P_FB','TIP3P-FB')}</div>
<div class="gi"><strong>OpenFF</strong><br><small>Drug force field</small>${au('OpenFF','OpenFF')}</div>
<div class="gi"><strong>Force Field</strong><br><small>Atom interaction rules</small>${au('force_field','Force Field')}</div>
<div class="gi"><strong>NVT</strong><br><small>Const. N,V,T</small>${au('NVT','NVT')}</div>
<div class="gi"><strong>NPT</strong><br><small>Const. N,P,T</small>${au('NPT','NPT')}</div>
<div class="gi"><strong>RMSD</strong><br><small>Structure deviation</small>${au('RMSD','RMSD')}</div>
<div class="gi"><strong>HMR</strong><br><small>H-mass trick</small>${au('HMR','HMR')}</div>
<div class="gi"><strong>PME</strong><br><small>Electrostatics math</small>${au('PME','PME')}</div>
<div class="gi"><strong>Langevin</strong><br><small>Thermostat type</small>${au('Langevin','Langevin')}</div>
<div class="gi"><strong>Barostat</strong><br><small>Pressure control</small>${au('barostat','Barostat')}</div>
<div class="gi"><strong>Femtosecond</strong><br><small>10‚Åª¬π‚Åµ sec</small>${au('femtosecond','Femtosecond')}</div>
<div class="gi"><strong>Nanosecond</strong><br><small>10‚Åª‚Åπ sec</small>${au('nanosecond','Nanosecond')}</div>
<div class="gi"><strong>√Öngstr√∂m</strong><br><small>10‚Åª¬π‚Å∞ meters</small>${au('angstrom','Angstrom')}</div>
</div>

<h2>Free Energy & Thermodynamics</h2>
<div class="gg">
<div class="gi"><strong>FEP</strong><br><small>Free Energy Perturbation</small>${au('FEP','FEP')}</div>
<div class="gi"><strong>ŒîG</strong><br><small>Binding energy</small>${au('delta_G','Delta G')}</div>
<div class="gi"><strong>ŒîŒîG</strong><br><small>Mutation effect</small>${au('delta_delta_G','Delta Delta G')}</div>
<div class="gi"><strong>Lambda Window</strong><br><small>FEP intermediate</small>${au('lambda_window','Lambda Window')}</div>
<div class="gi"><strong>MBAR</strong><br><small>Energy estimator</small>${au('MBAR','MBAR')}</div>
<div class="gi"><strong>Boresch</strong><br><small>Orientation springs</small>${au('Boresch','Boresch')}</div>
<div class="gi"><strong>Softcore</strong><br><small>Prevents crashes</small>${au('softcore','Softcore')}</div>
<div class="gi"><strong>Gibbs Free Energy</strong><br><small>G = H ‚àí TS</small>${au('gibbs_free_energy','Gibbs')}</div>
<div class="gi"><strong>Enthalpy (H)</strong><br><small>Interaction energy</small>${au('enthalpy','Enthalpy')}</div>
<div class="gi"><strong>Entropy (S)</strong><br><small>Disorder/freedom</small>${au('entropy','Entropy')}</div>
<div class="gi"><strong>Boltzmann</strong><br><small>ŒîG‚ÜîKd math</small>${au('Boltzmann','Boltzmann')}</div>
<div class="gi"><strong>Kd</strong><br><small>Binding strength</small>${au('dissociation_constant','Kd')}</div>
<div class="gi"><strong>kcal/mol</strong><br><small>Energy unit</small>${au('kcal_mol','kcal/mol')}</div>
<div class="gi"><strong>Thermo Cycle</strong><br><small>Indirect calculation</small>${au('thermodynamic_cycle','Thermo Cycle')}</div>
<div class="gi"><strong>Endpoint Catastrophe</strong><br><small>Atom overlap crash</small>${au('endpoint_catastrophe','Endpoint Catastrophe')}</div>
</div>

<h2>Compounds & Future</h2>
<div class="gg">
<div class="gi"><strong>Febuxostat</strong><br><small>FDA drug, mut-sensitive</small>${au('febuxostat','Febuxostat')}</div>
<div class="gi"><strong>Bufadienolide</strong><br><small>Natural, mut-resistant</small>${au('bufadienolide','Bufadienolide')}</div>
<div class="gi"><strong>AlphaFold2</strong><br><small>AI structure prediction</small>${au('AlphaFold','AlphaFold')}</div>
<div class="gi"><strong>pLDDT</strong><br><small>AlphaFold confidence</small>${au('pLDDT','pLDDT')}</div>
<div class="gi"><strong>SPR</strong><br><small>Binding kinetics</small>${au('SPR','SPR')}</div>
<div class="gi"><strong>ITC</strong><br><small>Calorimetry</small>${au('ITC','ITC')}</div>
<div class="gi"><strong>HDX-MS</strong><br><small>H/D exchange</small>${au('HDX_MS','HDX-MS')}</div>
<div class="gi"><strong>Pharmacogenomics</strong><br><small>Gene-guided drugs</small>${au('pharmacogenomics','Pharmacogenomics')}</div>
<div class="gi"><strong>Precision Medicine</strong><br><small>Genotype-specific Rx</small>${au('precision_medicine','Precision Medicine')}</div>
</div>
`},


// ============ BIOLOGY ‚Äî AP Bio ‚Üí PhD ============
{id:'bio',icon:'üß¨',label:'1. Biology',ct:`
<h1>1. The Biology ‚Äî From AP Bio to Research-Level</h1>
<p class="sub">You know DNA makes proteins. Let's build from there until you understand NOD2, the R702W mutation, and why your project matters ‚Äî at a level you could defend to a PhD immunologist.</p>

${build("What AP Bio Already Taught You",`
<p>You know: <strong>DNA ‚Üí mRNA ‚Üí Protein.</strong> Genes are transcribed into mRNA, mRNA is translated by ribosomes into amino acid chains, and those chains fold into 3D proteins. Proteins are the machines that do everything in cells. You also know that a <strong>mutation</strong> = a change in the DNA sequence that can change the amino acid, which can change the protein's shape and function.</p>
<p>That's all you need to start. Everything below builds on this.</p>
`)}

<h2>From "Proteins Do Stuff" to "NOD2 Detects Bacteria"</h2>

<p>Your cells have thousands of different proteins, each with a specific job. Some are enzymes (speed up reactions), some are structural (hold cells together), and some are <strong>sensors</strong> ‚Äî proteins whose job is to detect something and trigger a response.</p>

<p>${au('NOD2','NOD2')} (Nucleotide-binding Oligomerization Domain-containing protein 2) is a <strong>bacterial sensor</strong>. It lives inside the cytoplasm of your intestinal epithelial cells ‚Äî the cells that line your gut. Its one job: detect whether bacteria have gotten inside the cell.</p>

<p>How does it detect bacteria? All bacteria ‚Äî gram-positive and gram-negative ‚Äî have cell walls made of <strong>peptidoglycan</strong>. When bacteria are broken down (by lysozyme, by digestion, by other immune cells), their cell walls fragment. One specific fragment is called ${au('MDP','MDP')} (${au('muramyl_dipeptide','Muramyl Dipeptide')}). MDP is like a bacterial fingerprint ‚Äî it's present in ALL bacteria but never in human cells.</p>

<p>NOD2 recognizes MDP. When MDP touches NOD2, NOD2 changes shape and triggers an immune response. Think of NOD2 as a smoke detector inside the cell. MDP is the smoke.</p>

${bridge("So NOD2 = sensor protein inside gut cells. MDP = bacterial fragment. When MDP binds NOD2 ‚Üí immune alarm goes off. Now let's see what happens when that alarm fires.")}

<h2>The Signaling Cascade (Your Poster Figure 1)</h2>

<p>In AP Bio you learned about signal transduction ‚Äî one protein activates the next in a chain reaction. NOD2 triggers one of these cascades. Here's the full chain, step by step:</p>

<div class="c cc">
<ol>
<li><strong>MDP enters the cell</strong> ‚Äî transported through endosomal membrane by peptide transporters (SLC15A3/A4)</li>
<li><strong>MDP binds NOD2's ${au('LRR','LRR')} domain</strong> ‚Äî the LRR (Leucine Rich Repeat) is the "sensor" region of the protein (residues 744‚Äì1040). It forms a horseshoe shape that cradles MDP.</li>
<li><strong>NOD2 changes shape</strong> ‚Äî the LRR domain was acting like a "lid" keeping NOD2 inactive. MDP binding opens this lid, exposing a region called the CARD domain.</li>
<li><strong>CARD domain recruits ${au('RIPK2','RIPK2')}</strong> ‚Äî CARD-to-CARD protein-protein interaction. RIPK2 is a kinase (a protein that adds phosphate groups to other proteins).</li>
<li><strong>RIPK2 activates ${au('TAK1','TAK1')}</strong> ‚Äî TAK1 is another kinase, part of a complex with TAB1/TAB2/TAB3.</li>
<li><strong>TAK1 activates the IKK complex</strong> ‚Äî IKK (IKKŒ± + IKKŒ≤ + NEMO) phosphorylates IŒ∫BŒ±.</li>
<li><strong>IŒ∫BŒ± gets destroyed</strong> ‚Äî phosphorylated IŒ∫BŒ± is tagged with ubiquitin ‚Üí degraded by the proteasome.</li>
<li><strong>${au('NF_kappa_B','NF-Œ∫B')} is freed</strong> ‚Äî IŒ∫BŒ± was holding NF-Œ∫B hostage in the cytoplasm. Now NF-Œ∫B moves into the nucleus.</li>
<li><strong>NF-Œ∫B turns on inflammatory genes</strong> ‚Äî IL-8, TNF-Œ±, IL-6, defensins ‚Üí cytokines are released ‚Üí neutrophils are recruited ‚Üí <strong>bacteria are killed.</strong></li>
</ol>
</div>

${build("Why You Need to Know This Cascade",`
<p>Judges will point at Figure 1 and ask "walk me through the pathway." You need to name every step and explain WHY each protein is needed. The cascade also explains why Crohn's happens ‚Äî if step 2 (MDP sensing) is broken, the entire downstream cascade fires incorrectly.</p>
`)}

<h2>NOD2's Domain Architecture ‚Äî The Protein Map</h2>

<p>In AP Bio you learned proteins have domains ‚Äî regions with distinct functions. NOD2 has five:</p>

<table>
<tr><th>Domain</th><th>Residues</th><th>Function</th><th>Why You Care</th></tr>
<tr><td><strong>CARD</strong></td><td>1‚Äì120</td><td>Recruits RIPK2 to start signaling</td><td>Downstream ‚Äî not your drug target</td></tr>
<tr><td><strong>NBD/NACHT</strong></td><td>273‚Äì577</td><td>Binds ATP, allows NOD2 to oligomerize (form clusters)</td><td>The "engine" ‚Äî needs ATP to fire</td></tr>
<tr><td><strong>HD1</strong></td><td>577‚Äì640</td><td>Helical linker domain</td><td>Structural connection</td></tr>
<tr><td><strong>HD2</strong></td><td>640‚Äì744</td><td>Helical domain ‚Äî flexibility hinge</td><td>‚ö†Ô∏è <strong>YOUR MUTATION (R702W) IS HERE</strong></td></tr>
<tr><td><strong>LRR</strong></td><td>744‚Äì1040</td><td>Senses MDP; has the binding pocket</td><td>‚ö†Ô∏è <strong>YOUR DRUGS BIND HERE</strong></td></tr>
</table>

<p><strong>Critical detail:</strong> The mutation is at position 702 (in HD2). Your drugs bind in the LRR domain (residues 744‚Äì1040). Distance between them: <span class="n">79.4 √Ö</span> ${au('angstrom','Angstrom')} ‚Äî that's 79.4 √ó 10‚Åª¬π‚Å∞ meters. Enormous at molecular scale. They are NOT next to each other. This means the mutation's effect on drug binding is <strong>${au('allosteric','allosteric')}</strong> ‚Äî an effect at a distance.</p>

${bridge("You now know the protein's layout and where the mutation vs the drug pocket are. Next: what IS the mutation, and why does it cause Crohn's?")}

<h2>The R702W Mutation ‚Äî YOUR Mutation ${au('R702W','R702W')}</h2>

<p>In AP Bio you learned amino acids have different properties ‚Äî some are charged, some hydrophobic, some polar. This matters here:</p>

<div class="c co">
<p><strong>${au('arginine','Arginine')} (R) ‚Äî the NORMAL amino acid at position 702:</strong></p>
<ul>
<li>Positively charged (guanidinium group, pKa ~12.5 ‚Äî always protonated at body pH)</li>
<li>Long, flexible side chain</li>
<li>Forms up to <strong>5 hydrogen bonds</strong> simultaneously</li>
<li>Forms <strong>salt bridges</strong> with negatively charged residues (ASP, GLU)</li>
<li>Creates a network of interactions that makes HD2 flexible ‚Äî like a well-oiled hinge</li>
</ul>

<p><strong>${au('tryptophan','Tryptophan')} (W) ‚Äî the MUTANT amino acid:</strong></p>
<ul>
<li>Neutral (no charge)</li>
<li>Largest amino acid ‚Äî bulky, flat indole ring</li>
<li>Hydrophobic ‚Äî tries to avoid water</li>
<li>Can only form <strong>1 hydrogen bond</strong> (from the indole NH)</li>
<li>Can't form the salt bridges Arginine made</li>
<li>Disrupts the interaction network ‚Üí HD2 becomes <strong>rigid</strong> instead of flexible</li>
</ul>
</div>

<p>The result: R702W turns a flexible hinge into a stiff rod. This rigidification propagates through the helical domains (HD2 ‚Üí HD1 ‚Üí LRR interface) and changes the shape of the binding pocket 79.4 √Ö away. This is the ${au('allosteric','allosteric')} mechanism your MD simulations proved.</p>

<h2>Why This Causes Crohn's Disease ${au('crohns',"Crohn's")}</h2>

<div class="c cr">
<p>Here's the paradox that confuses people (even scientists): Crohn's is an <strong>inflammatory</strong> disease, but it's caused by <strong>too little</strong> immune sensing.</p>
<p>With R702W, NOD2 can't sense MDP properly ‚Üí initial bacterial detection fails ‚Üí bacteria aren't cleared quickly ‚Üí bacteria proliferate ‚Üí the body compensates through other, less precise immune pathways (Toll-like receptors, inflammasomes) ‚Üí these backup systems trigger massive, chronic, uncontrolled inflammation ‚Üí tissue damage ‚Üí Crohn's disease.</p>
<p>It's like a fire alarm with dead batteries. The alarm doesn't go off, so the fire smolders for hours. Eventually someone notices and calls EVERY fire department in the city. The resulting flood of water causes more damage than the original fire.</p>
<p>You carry this mutation. You receive <strong>Remicade</strong> (infliximab) infusions ‚Äî an antibody that blocks TNF-Œ±, one of the inflammatory molecules at the END of the cascade. It treats the <em>symptom</em> (chronic inflammation) but not the <em>cause</em> (defective NOD2 sensing). Your project asks: can we fix things upstream, at the NOD2 protein itself?</p>
</div>

<h2>What Your Project Actually Does ‚Äî Precisely</h2>

<div class="ky">
<p>You are computationally screening thousands of existing drugs and natural products to find molecules that <strong>bind NOD2's LRR pocket</strong> and could potentially restore or modulate its sensing function.</p>
<p>Then ‚Äî and this is the novel part ‚Äî you use the most rigorous computational method available (${au('FEP','FEP')}) to measure how the R702W mutation changes each drug's binding strength. You discovered that the mutation's effect is <strong>drug-specific</strong>: some drugs lose binding (Febuxostat, 50√ó weaker) while others are unaffected (Bufadienolide).</p>
<p>This means drug treatment for NOD2-linked Crohn's should depend on the patient's genotype ‚Äî ${au('pharmacogenomics','pharmacogenomics')}. That's ${au('precision_medicine','precision medicine')}.</p>
</div>

${ex('j','Judge asks: "If the mutation is in HD2, why are you targeting the LRR pocket?"',`
<p>"The LRR domain is where MDP binds to activate NOD2. Our drugs target this same pocket to potentially modulate NOD2 activation. We're not trying to fix the mutation directly ‚Äî we're looking for compounds that bind the functional site, and then testing whether the allosteric effects of R702W change how well those compounds bind. The 79.4-Angstrom distance between the mutation and the pocket is what makes this an allosteric study ‚Äî and the ŒîŒîG we measure by FEP quantifies that allosteric effect on drug binding."</p>
`)}
`},


// ============ DOCKING ‚Äî AP Bio ‚Üí PhD ============
{id:'dock',icon:'‚öôÔ∏è',label:'2. Docking',ct:`
<h1>2. GNINA Docking ‚Äî Fitting 9,566 Keys Into One Lock</h1>
<p class="sub">You know proteins have shapes. Drugs fit into those shapes. Now learn exactly how a computer scores that fit.</p>

${build("Where You Are in the Pipeline",`<p>You have: NOD2's 3D structure (from ${au('AlphaFold','AlphaFold2')}, since no crystal structure exists) and 9,566 candidate molecules (2,152 FDA-approved drugs from e-Drug3D + 7,414 natural products from COCONUT). You need to score which ones fit into NOD2's LRR ${au('binding_pocket','binding pocket')}.</p>`)}

<h2>What Docking Actually Is ${au('docking','Molecular Docking')}</h2>

<p>In AP Bio, you learned about enzyme-substrate specificity ‚Äî the "lock and key" or "induced fit" model. Docking is the computational version. You have a cavity on the protein surface (the binding pocket) and a small molecule (the drug). The computer tries thousands of orientations ‚Äî rotating, flipping, bending the molecule ‚Äî and scores each one.</p>

<p>But what does "score" mean? The computer calculates the total interaction energy between the drug and the protein in each pose. This includes:</p>

<div class="c cc">
<ul>
<li><strong>Shape complementarity</strong> ‚Äî does the drug's shape fill the pocket without clashing? Atoms too close ‚Üí massive repulsion (van der Waals). Atoms at optimal distance (~3.5‚Äì4 √Ö) ‚Üí attraction.</li>
<li><strong>${au('hydrogen_bond','Hydrogen bonds')}</strong> ‚Äî drug OH/NH groups aligned with protein O/N atoms? Each H-bond contributes ~2‚Äì5 kJ/mol of stabilization.</li>
<li><strong>${au('electrostatic','Electrostatic interactions')}</strong> ‚Äî positive groups on drug near negative groups on protein? Coulomb's law: F = kq‚ÇÅq‚ÇÇ/r¬≤.</li>
<li><strong>${au('hydrophobic','Hydrophobic contacts')}</strong> ‚Äî nonpolar parts of the drug packing against nonpolar protein residues? These "oily" interactions stabilize binding by excluding water.</li>
<li><strong>Torsional penalty</strong> ‚Äî how many rotatable bonds in the drug had to freeze into one conformation? Each frozen bond costs entropy.</li>
</ul>
<p>Sum all terms ‚Üí one score per pose. Lower = better. Keep the best poses.</p>
</div>

<h2>Classical vs Deep Learning Scoring ‚Äî Why GNINA ${au('GNINA','GNINA')}</h2>

<p><strong>Classical (AutoDock Vina, 2010):</strong> Score = w‚ÇÅ√ósteric + w‚ÇÇ√óhbond + w‚ÇÉ√óhydrophobic + w‚ÇÑ√ótorsion. The weights (w‚ÇÅ, w‚ÇÇ...) were fitted to ~1,300 crystal structures in 2010. It's a fixed formula ‚Äî it can't learn new patterns.</p>

<p><strong>GNINA (2020):</strong> Uses a ${au('CNN','Convolutional Neural Network')} ‚Äî the same type of AI that recognizes faces in photos, except instead of 2D images, it processes 3D molecular grids. Here's how:</p>

<div class="c ca">
<ol>
<li>Take the protein-ligand complex. Place a 3D grid over it (like a cube of tiny boxes, each 0.5 √Ö wide).</li>
<li>At each grid point, store properties of nearby atoms: atom type (C, N, O, S...), charge, size, whether it's protein or drug. This creates a 3D "image" with ~36 channels (like RGB but with 36 colors).</li>
<li>Feed this 3D image into a CNN trained on <strong>PDBBind</strong> ‚Äî over 20,000 real protein-drug crystal structures where scientists measured actual binding affinity in the lab.</li>
<li>The CNN outputs two numbers: <strong>pose quality</strong> (0‚Äì1, is this a realistic binding mode?) and <strong>CNN affinity</strong> (predicted binding strength, like a predicted grade).</li>
</ol>
<p>Key insight: Vina uses a formula written by humans. GNINA learned from 20,000 real examples. It's like the difference between following a recipe vs. a chef who's cooked 20,000 meals and developed intuition.</p>
</div>

${bridge("You now understand docking conceptually. Let's look at exactly how YOU ran it ‚Äî the command, the parameters, the crashes.")}

<h2>Your Exact Setup</h2>

<table>
<tr><th>Parameter</th><th>Your Value</th><th>Why This Value</th></tr>
<tr><td>Protein structure</td><td>AlphaFold2 NOD2 LRR</td><td>No crystal structure exists. AlphaFold2 confidence (${au('pLDDT','pLDDT')}) >90 in LRR = very high.</td></tr>
<tr><td>Grid box</td><td class="n">30 √ó 30 √ó 30 √Ö</td><td>LRR pocket is ~20 √Ö across. 30¬≥ gives 5 √Ö padding on each side for large ligands to rotate freely.</td></tr>
<tr><td>Exhaustiveness</td><td class="n">32</td><td>4√ó default (8). Each unit = one independent random search. More = more thorough. GPU makes 32 feasible.</td></tr>
<tr><td>Poses kept</td><td class="n">9 per compound</td><td>Keep top 9 poses in case #1 is an artifact. The best is used for ML.</td></tr>
<tr><td>Score range</td><td class="n">2.47 ‚Äì 7.34</td><td>CNN affinity across all 9,566 compounds. Higher = stronger predicted binding.</td></tr>
</table>

<h2>The Actual Bash Command</h2>
<pre><span class="cmt"># Process each compound one at a time</span>
<span class="kw">for</span> f <span class="kw">in</span> ligands/*.pdbqt; <span class="kw">do</span>
  gnina -r human_NOD2_LRR.pdbqt \\
        -l <span class="str">"$f"</span> \\
        --center_x 12.5 --center_y -3.2 --center_z 8.7 \\
        --size_x 30 --size_y 30 --size_z 30 \\
        --exhaustiveness 32 \\
        --num_modes 9 \\
        -o <span class="str">"results/$(basename $f .pdbqt)_docked.sdf"</span>
<span class="kw">done</span></pre>

<p><code>-r</code> = receptor (protein). <code>-l</code> = ligand (drug). <code>--center</code> = where to look. <code>--size</code> = how big the search box is. <code>-o</code> = where to save results.</p>

${ex('x','ARG_MAX Crash ‚Äî Your first attempt failed silently',`
<p>First command: <code>gnina -l ligands/*.pdbqt</code> ‚Äî passing all 9,566 filenames at once via shell wildcard.</p>
<p>Linux has a maximum command-line length (ARG_MAX, ~2 MB). 9,566 filenames √ó ~30 characters = ~287 KB ‚Äî exceeded the limit. GNINA didn't error ‚Äî it just printed the help menu and exited. No results generated, no error message. You had to figure out WHY it silently failed.</p>
<p><strong>Fix:</strong> The <code>for</code> loop above ‚Äî processes one file at a time. Then you also learned to use <code>nohup</code> to prevent losing progress when the terminal closes.</p>
`)}

${ex('x','GPU at 1% utilization ‚Äî CUDA library path missing',`
<p>GNINA was running on CPU despite having an RTX 4060 Ti. <code>nvidia-smi</code> showed 1% GPU usage.</p>
<p>Cause: GNINA needs CUDA libraries (<code>libcudart.so</code>) in the system's library path. WSL2 didn't expose them by default.</p>
<p>Fix: <code>export LD_LIBRARY_PATH=/usr/local/cuda/lib64:$LD_LIBRARY_PATH</code></p>
<p>Result: GPU utilization jumped to ~50%. Docking speed: ~2 min/compound. Total: ~13 hours for all 9,566.</p>
`)}

${ex('l','How you learned docking',`
<p>YouTube tutorials on AutoDock Vina first (most beginner content). Vina installation failed on Windows. Searched for GPU alternatives, found GNINA through a 2021 benchmarking paper (McNutt et al.). Gemini helped set up WSL2 + CUDA. Claude debugged the ARG_MAX crash. Read the GNINA paper during a Remicade infusion.</p>
`)}

${bridge("9,566 compounds now have CNN affinity scores. But these scores are noisy ‚Äî CNN docking isn't perfect. Next: use machine learning to find the real signal in this data.")}
`},


// ============ ML ‚Äî AP Bio ‚Üí PhD ============
{id:'ml',icon:'ü§ñ',label:'3. ML Model',ct:`
<h1>3. NOD2-Scout ‚Äî Teaching a Computer to Recognize Binders ${au('XGBoost','XGBoost')}</h1>
<p class="sub">You know how evolution selects for fit organisms. Machine learning selects for correct predictions the same way. Let's build up from "what's a decision tree" to your actual code.</p>

${build("Why ML After Docking?",`<p>GNINA scored 9,566 compounds ‚Äî but CNN docking has noise. Some high-scoring compounds are false positives (lucky pose but won't really bind). Some low-scoring ones are false negatives. ML learns the deeper pattern: "what chemical PROPERTIES make a molecule a good NOD2 binder?" ‚Äî looking at the data holistically rather than one compound at a time.</p>`)}

<h2>Decision Trees ‚Äî The Foundation</h2>

<p>In AP Bio, you've used dichotomous keys ‚Äî "Does it have feathers? Yes ‚Üí bird. No ‚Üí continue." A decision tree is the same idea applied to data.</p>

<p>Imagine sorting compounds into binders vs non-binders. The tree asks questions about chemical properties:</p>

<pre style="background:transparent;border:none;color:var(--txt);padding:0">
               Is LogP > 3? (lipophilicity)
              /              \\
           Yes               No ‚Üí NON-BINDER
            |                (too water-soluble ‚Üí can't enter cell)
      Is TPSA < 100?
       /         \\
     Yes         No ‚Üí NON-BINDER
      |          (too polar ‚Üí can't cross membrane)
  Has aromatic ring?
    /    \\
  Yes    No ‚Üí NON-BINDER
   |
 BINDER ‚úì
</pre>

<p>The tree <strong>learns</strong> which questions to ask and where to set thresholds by looking at training data. It tries every possible split at every feature and picks the one that best separates binders from non-binders (measured by Gini impurity or information gain ‚Äî same concept as entropy in AP Bio thermodynamics).</p>

<p><strong>Problem:</strong> A single tree overfits ‚Äî it memorizes the training data instead of learning general patterns. Like a student who memorizes exam answers instead of understanding concepts.</p>

<h2>From One Tree to 100: XGBoost ${au('XGBoost','XGBoost')}</h2>

<div class="c ca">
<p><strong>Extreme Gradient Boosting</strong> builds trees <em>sequentially</em>. Each tree corrects the mistakes of all previous trees:</p>
<ol>
<li>Tree 1 makes predictions. Gets 70% right, 30% wrong.</li>
<li>Tree 2 is trained specifically on the 30% that Tree 1 got wrong. It "focuses" on the hard cases.</li>
<li>Tree 3 focuses on the remaining errors from Trees 1+2 combined.</li>
<li>Continue for <span class="n">100</span> trees.</li>
<li>Final prediction = weighted sum of all trees.</li>
</ol>
<p>"Gradient" means it uses calculus (gradient descent ‚Äî the same optimization method as neural networks) to find the best correction at each step. "Boosting" means each tree boosts the ensemble's performance by fixing predecessors' errors.</p>
</div>

<h2>The Labeling Problem ‚Äî No One Has Measured This Before</h2>

<p>ML needs labeled data: "this compound binds NOD2 (label = 1)" and "this doesn't (label = 0)." But <strong>nobody has ever experimentally measured NOD2 binding</strong> for any of these compounds. Zero experimental labels exist. The ChEMBL database confirmed this ‚Äî no NOD2 binding data anywhere in the literature.</p>

<div class="c co">
<p><strong>Solution: ${au('pseudo_label','Pseudo-labels')}</strong> from docking scores.</p>
<ul>
<li>Top 25% by GNINA CNN affinity ‚Üí label = 1 ("likely binder")</li>
<li>Bottom 25% ‚Üí label = 0 ("likely non-binder")</li>
<li>Middle 50% ‚Üí discarded (ambiguous ‚Äî would add noise)</li>
</ul>
<p>This works because GNINA's CNN scores, while noisy, do correlate with real binding. The top/bottom quartiles are confident enough to train on. The result: <span class="n">~858</span> labeled compounds.</p>
</div>

<h2>Features ‚Äî How You Describe Molecules to a Computer</h2>

<p>You can't show a computer a molecular structure directly. You need to convert each molecule into a list of numbers ‚Äî a <strong>feature vector</strong>. You used <span class="n">2,050</span> features:</p>

<h3>${au('morgan_fingerprint','Morgan Fingerprints')} ‚Äî 2,048 bits</h3>
<p>For each atom in the molecule, look at its chemical neighborhood within 2 bonds. Hash that neighborhood into a position in a 2,048-length binary vector (0 or 1). Different neighborhoods ‚Üí different positions get set to 1. The result is a unique "barcode" for each molecule.</p>
<p>Why this works: If two molecules activate the same fingerprint bits, they share chemical environments ‚Äî and probably interact with proteins similarly.</p>

<h3>10 Physicochemical Descriptors</h3>
<p>Molecular weight, LogP (lipophilicity), ${au('TPSA','TPSA')} (polar surface area), H-bond donors/acceptors, rotatable bonds, aromatic rings, sp3 fraction, heavy atom count, ring count. Each captures a different physical property relevant to drug binding.</p>

${bridge("Features encode molecules as numbers. Labels come from docking. But how do you HONESTLY evaluate if the model is learning real patterns?")}

<h2>Scaffold Split ‚Äî The Most Important Decision ${au('scaffold_split','Scaffold Split')}</h2>

<p>This is where your project goes from "good student project" to "publishable science."</p>

<div class="vs">
<div class="vl"><h3 style="color:var(--red)">‚ùå Random Split (what most people do)</h3>
<p>Randomly assign 80% to train, 20% to test. Problem: molecules with the SAME core structure (${au('Murcko','Murcko scaffold')}) end up in both sets. The model learns "scaffold X = binder" ‚Äî it memorized the chemical FAMILY, not the binding CHEMISTRY.</p>
<p>Your result with random split: AUC = <span class="n">0.998</span>. Suspiciously perfect. This was ${au('data_leakage','data leakage')} ‚Äî information from the test set leaked into training through shared scaffolds.</p></div>
<div class="vw"><h3 style="color:var(--grn)">‚úÖ Scaffold Split (what you did)</h3>
<p>Group all molecules by their core backbone (Murcko scaffold). ALL molecules with the same scaffold go into the SAME set. Train on 80% of scaffolds, test on 20% of scaffolds ‚Äî entirely new chemical families.</p>
<p>Your result with scaffold split: AUC = <span class="n">0.85‚Äì0.93</span>. Lower, but HONEST. The model must generalize to molecules it's never seen before.</p></div>
</div>

<h2>The Shuffled-Label Control ‚Äî Proving the Signal is Real</h2>

<div class="c cg">
<p>Scramble the labels randomly (break the connection between molecules and their binder/non-binder labels). Retrain with identical parameters. If the model still scores high ‚Üí it's learning from data structure, not real binding signal.</p>
<p>Your result: shuffled AUC = <span class="n">~0.50</span> = pure random chance (coin flip). Real AUC = 0.85‚Äì0.93. <strong>The signal is real, not an artifact.</strong></p>
</div>

<h2>Your Actual Training Code</h2>
<pre><span class="cmt"># From scripts/03_train_model.py</span>
<span class="kw">import</span> xgboost <span class="kw">as</span> xgb

<span class="cmt"># Pseudo-labeling: top/bottom by CNN affinity</span>
top_threshold = features_df[<span class="str">'cnn_affinity'</span>].quantile(0.90)
bottom_threshold = features_df[<span class="str">'cnn_affinity'</span>].quantile(0.10)
features_df.loc[features_df[<span class="str">'cnn_affinity'</span>] >= top_threshold, <span class="str">'label'</span>] = 1
features_df.loc[features_df[<span class="str">'cnn_affinity'</span>] <= bottom_threshold, <span class="str">'label'</span>] = 0

<span class="cmt"># Scaffold split: group by core backbone</span>
<span class="kw">def</span> <span class="fn">get_scaffold</span>(smiles):
    mol = Chem.MolFromSmiles(smiles)
    scaffold = MurckoScaffold.GetScaffoldForMol(mol)
    <span class="kw">return</span> Chem.MolToSmiles(scaffold)

<span class="cmt"># Features = fingerprints + descriptors</span>
X = np.hstack([X_desc, X_fp])  <span class="cmt"># Shape: (858, 2050)</span>

<span class="cmt"># Train</span>
model = xgb.XGBClassifier(
    n_estimators=100,        <span class="cmt"># 100 sequential trees</span>
    max_depth=6,             <span class="cmt"># Each tree up to 64 leaf nodes</span>
    learning_rate=0.05,      <span class="cmt"># Each tree corrects 5% of error</span>
    subsample=0.8,           <span class="cmt"># Each tree sees 80% of data</span>
    colsample_bytree=0.8,    <span class="cmt"># Each tree sees 80% of features</span>
    objective=<span class="str">'binary:logistic'</span>,
    eval_metric=<span class="str">'auc'</span>,
    random_state=42
)
model.fit(X_train, y_train)

<span class="cmt"># Negative control: scramble labels 10 times</span>
<span class="kw">for</span> i <span class="kw">in</span> range(10):
    y_shuffled = np.random.permutation(y_train)
    model_shuffle = xgb.XGBClassifier(**params)
    model_shuffle.fit(X_train, y_shuffled)
    <span class="cmt"># ‚Üí AUC ‚âà 0.50 every time</span></pre>

${ex('w','Why each hyperparameter has that value',`
<p><strong>n_estimators=100:</strong> With learning_rate=0.05, each tree contributes 5%. After 100 trees, the ensemble has converged. More trees ‚Üí overfitting on 858 samples. Code says 500 but poster says 100 ‚Äî poster is authority.</p>
<p><strong>max_depth=6:</strong> 2‚Å∂ = 64 leaf nodes. With 858 samples, that's ~13 samples per leaf ‚Äî enough for statistics. Depth 3 = too shallow (8 leaves). Depth 12 = too deep (4,096 leaves, would memorize).</p>
<p><strong>learning_rate=0.05:</strong> Small corrections per tree ‚Üí smoother learning. Higher (0.3) ‚Üí faster training but overshooting. Lower (0.01) ‚Üí would need 1,000+ trees.</p>
<p><strong>subsample=0.8 & colsample_bytree=0.8:</strong> Each tree sees 80% of rows AND 80% of features (randomly selected). This "double randomization" prevents overfitting ‚Äî no single tree can memorize the full dataset or rely on one dominant feature.</p>
`)}

${ex('x','Data Leakage Discovery ‚Äî AUC 0.998',`
<p>First run with random split ‚Üí AUC = 0.998. No biological data is that clean. Investigation: feature importance was dominated by fingerprint bits corresponding to common scaffolds. The model learned "if scaffold X ‚Üí high score" ‚Äî memorizing chemical FAMILIES, not binding CHEMISTRY.</p>
<p>Fix: scaffold split. AUC dropped to 0.85‚Äì0.93. This is honest. The 0.998 ‚Üí 0.90 drop is entirely from removing leakage. You caught your own error ‚Äî that's real science.</p>
`)}

<p>NOD2-Scout selected top <span class="n">2,129</span> predicted binders ‚Üí clustered to 150 diverse representatives ‚Üí ADMET filtering next.</p>
`},


// ============ ADMET ============
{id:'admet',icon:'üíä',label:'4. ADMET',ct:`
<h1>4. ADMET ‚Äî Can This Drug Actually Work in a Human Body? ${au('ADMET','ADMET')}</h1>
<p class="sub">A drug can bind perfectly in a computer but fail in a human. These filters catch that.</p>

${build("The 90% Problem",`<p>In AP Bio you learned about pharmacokinetics ‚Äî how drugs move through the body. Roughly 90% of drug candidates that bind their target in the lab FAIL in clinical trials because of ADMET problems. Filtering early saves years.</p>`)}

<p><strong>A</strong>bsorption ‚Äî Can it cross the gut wall into blood? <strong>D</strong>istribution ‚Äî Does it reach the right tissue? <strong>M</strong>etabolism ‚Äî Does the liver destroy it too fast? <strong>E</strong>xcretion ‚Äî Is it cleared appropriately? <strong>T</strong>oxicity ‚Äî Is it poisonous?</p>

<h2>Your Filters ‚Äî And the Physics Behind Each</h2>

<div class="c cc">
<h3>${au('lipinski','Lipinski Rule of 5')} ‚Äî Will it absorb orally?</h3>
<p>MW ‚â§ 500 (too big ‚Üí can't diffuse through intestinal membrane). LogP ‚â§ 5 (too hydrophobic ‚Üí gets stuck in membrane). HBD ‚â§ 5, HBA ‚â§ 10 (each H-bonding group must break bonds with water to enter the membrane ‚Äî desolvation penalty).</p>

<h3>Veber's Rules ‚Äî Flexibility and polarity</h3>
<p>${au('TPSA','TPSA')} ‚â§ 140 √Ö¬≤ ‚Äî <strong>THIS IS CRITICAL FOR NOD2</strong> because NOD2 is INSIDE the cell. The drug must cross the plasma membrane (a lipid bilayer ~30 √Ö thick). High polar surface = can't enter the fat layer = never reaches NOD2.</p>
<p>Rotatable bonds ‚â§ 10 ‚Äî Flexible molecules lose more ${au('entropy','entropy')} upon binding (they must freeze into one shape). Each frozen bond costs ~0.5 kcal/mol.</p>

<h3>${au('PAINS','PAINS')} ‚Äî Chemical Liars</h3>
<p>480 known substructure patterns that react nonspecifically ‚Äî they look "active" in EVERY assay. Quinones (redox cyclers), Michael acceptors (covalent binders), rhodanines. ~7% of compounds contain these. Your filter removed 2 compounds with PAINS alerts.</p>

<h3>Brenk Filters ‚Äî Toxic Substructures</h3>
<p>105 patterns of known problematic groups: epoxides (DNA alkylators), nitroso (carcinogens), acyl halides (reacts with everything). ‚â•2 alerts ‚Üí removed.</p>
</div>

<p>Result: <span class="n">148 of 150 passed (98.7%)</span>. High pass rate because FDA drugs and COCONUT natural products are already drug-like by nature. The 2 failures had PAINS alerts. ‚Üí 148 compounds proceed to expert curation ‚Üí 8 selected ‚Üí 5 to MD ‚Üí 2 to FEP.</p>

${ex('j','Judge: "Why does TPSA matter specifically for your target?"',`
<p>"NOD2 is a cytoplasmic protein ‚Äî it's inside the cell, not on the surface. This means any drug candidate must cross the plasma membrane to reach it. The membrane is a lipid bilayer about 30 Angstroms thick. Molecules with high topological polar surface area ‚Äî meaning lots of exposed oxygen and nitrogen atoms ‚Äî form strong hydrogen bonds with surrounding water and cannot partition into the hydrophobic membrane interior. The 140 square-Angstrom cutoff from Veber's analysis predicts less than 10% oral bioavailability above that threshold. For a surface receptor, membrane permeability is less critical. For NOD2, it's a hard requirement."</p>
`)}
`},

// ============ MD SIMULATION ‚Äî AP Bio ‚Üí PhD ============
{id:'md',icon:'üß™',label:'5. MD Simulation',ct:`
<h1>5. Molecular Dynamics ‚Äî Watching Atoms Move ${au('molecular_dynamics','Molecular Dynamics')}</h1>
<p class="sub">Docking gave you a snapshot. MD gives you a movie. Here's how you simulate Newton's laws for 217,986 atoms across 520 nanoseconds.</p>

${build("From AP Bio Physics to MD",`
<p>In AP Physics (or even AP Bio's energy chapters), you learned <strong>F = ma</strong>. Force = mass √ó acceleration. MD does this exact calculation ‚Äî but for EVERY atom in the system, EVERY ${au('femtosecond','femtosecond')} (10‚Åª¬π‚Åµ seconds). For 5,000,000 steps. That's how you simulate 20 nanoseconds of real time.</p>
<p>Why? Because proteins aren't frozen. They jiggle, breathe, flex at body temperature. A drug that looks perfect in a docking snapshot might wobble out of the pocket after 2 nanoseconds. MD tests: <strong>does the drug STAY?</strong></p>
`)}

<h2>The Force Field ‚Äî Rules for Atom Interactions ${au('force_field','Force Field')}</h2>

<p>To compute F = ma, you need to know the forces. A "force field" is a set of equations + parameters that describe how atoms interact. Think of it as the physics engine of a video game, except based on real quantum mechanics:</p>

<div class="c cc">
<p><strong>Bonded forces</strong> (atoms connected by covalent bonds):</p>
<ul>
<li><strong>Bond stretching:</strong> E = k(r ‚àí r‚ÇÄ)¬≤ ‚Äî spring between bonded atoms. Pull too far ‚Üí force pulls back.</li>
<li><strong>Angle bending:</strong> E = k(Œ∏ ‚àí Œ∏‚ÇÄ)¬≤ ‚Äî angle between 3 atoms wants to stay at equilibrium.</li>
<li><strong>Dihedral rotation:</strong> E = V[1 + cos(nœÜ ‚àí Œ≥)] ‚Äî torsion around bonds. Some rotations are preferred.</li>
</ul>
<p><strong>Non-bonded forces</strong> (all atom pairs):</p>
<ul>
<li><strong>${au('van_der_waals','Van der Waals')}:</strong> E = 4Œµ[(œÉ/r)¬π¬≤ ‚àí (œÉ/r)‚Å∂] ‚Äî repulsion when close (r‚Åª¬π¬≤), attraction at medium range (r‚Åª‚Å∂). This is the "shape" interaction.</li>
<li><strong>${au('electrostatic','Electrostatics')}:</strong> E = q‚ÇÅq‚ÇÇ/(4œÄŒµ‚ÇÄr) ‚Äî Coulomb's law. Opposite charges attract, same charges repel.</li>
</ul>
<p>Sum ALL these terms for ALL atom pairs ‚Üí total force on each atom ‚Üí F = ma ‚Üí update positions. Repeat.</p>
</div>

<p>You used three force fields: ${au('AMBER14','AMBER14')} for the protein, ${au('OpenFF','OpenFF')} 2.1 (Sage) for the drug molecules, and ${au('TIP3P_FB','TIP3P-FB')} for water. Each is optimized for its molecule type.</p>

<h2>Your 4-Stage Protocol</h2>

<div class="c">
<p><strong>1. Energy minimization</strong> (5,000 steps) ‚Äî Remove atomic clashes from docking pose. No dynamics, just optimization.</p>
<p><strong>2. ${au('NVT','NVT')} heating</strong> (100 ps) ‚Äî Heat system to <span class="n">310.15 K</span> (body temperature). Constant volume. ${au('Langevin','Langevin thermostat')} maintains temperature via friction + random kicks.</p>
<p><strong>3. ${au('NPT','NPT')} equilibration</strong> (500 ps) ‚Äî Now adjust box size for correct pressure (1 atm) and density (~1.0 g/mL). ${au('barostat','Monte Carlo barostat')} shrinks/expands the box.</p>
<p><strong>4. Production</strong> (20 ns √ó 3 replicates) ‚Äî Record positions every 5,000 steps. Analyze for pocket occupancy, RMSD, H-bonds.</p>
</div>

<h2>Every Parameter ‚Äî And Why That Value</h2>
<table>
<tr><th>Parameter</th><th>Value</th><th>Building from Physics</th></tr>
<tr><td>Temperature</td><td class="n">310.15 K</td><td>= 37¬∞C = body temp. Simulates the environment inside an intestinal cell.</td></tr>
<tr><td>Timestep</td><td class="n">4 fs</td><td>${au('HMR','HMR')}: Increase hydrogen mass (1.008 ‚Üí 1.5 amu). Heavier H vibrates slower ‚Üí fastest vibration period increases ‚Üí can safely use 4 fs instead of 2 fs ‚Üí 2√ó faster simulation. Like a pendulum: heavier = slower swing = fewer measurements needed.</td></tr>
<tr><td>Total atoms</td><td class="n">~217,986</td><td>Protein (~16K) + drug (~50) + ~65,000 water molecules (~195K atoms) + ~200 Na‚Å∫/Cl‚Åª ions. Water is 90% of the system.</td></tr>
<tr><td>Salt</td><td class="n">0.15 M NaCl</td><td>Physiological ionic strength. Neutralizes system charge and screens electrostatics realistically.</td></tr>
<tr><td>Nonbonded cutoff</td><td class="n">1.0 nm</td><td>Van der Waals decays as 1/r‚Å∂ ‚Üí negligible beyond 1 nm. Long-range electrostatics handled by ${au('PME','PME')} (Particle Mesh Ewald) ‚Äî uses Fourier transforms to compute infinite-range Coulomb interactions efficiently.</td></tr>
<tr><td>Production</td><td class="n">20 ns √ó 3 reps</td><td>20 ns: Long enough to see if drug leaves (control left by ~5 ns). 3 replicates for statistical confidence.</td></tr>
<tr><td>Total MD time</td><td class="n">520 ns</td><td>26 trajectories √ó 20 ns. GPU time: ~8 hrs per trajectory on RTX 4060 Ti.</td></tr>
</table>

<h2>Your Actual Code</h2>
<pre><span class="cmt"># From PHASE_6/gpu_scripts/03_run_md_febuxostat.py</span>
<span class="kw">from</span> openmm <span class="kw">import</span> *
<span class="kw">from</span> openmm.app <span class="kw">import</span> *

forcefield = ForceField(<span class="str">'amber14-all.xml'</span>, <span class="str">'amber14/tip3pfb.xml'</span>)
system = forcefield.createSystem(
    pdb.topology,
    nonbondedMethod=PME,            <span class="cmt"># Ewald for long-range electrostatics</span>
    nonbondedCutoff=1.0*nanometers, <span class="cmt"># vdW cutoff</span>
    constraints=AllBonds,           <span class="cmt"># Fix bonds ‚Üí enables 4fs</span>
    hydrogenMass=1.5*amu            <span class="cmt"># HMR ‚Üí 4fs safe</span>
)
integrator = LangevinMiddleIntegrator(
    310.15*kelvin,    <span class="cmt"># Body temp</span>
    1.0/picoseconds,  <span class="cmt"># Friction</span>
    4.0*femtoseconds  <span class="cmt"># Timestep</span>
)
platform = Platform.getPlatformByName(<span class="str">'CUDA'</span>)
simulation = Simulation(pdb.topology, system, integrator, platform)
simulation.minimizeEnergy(maxIterations=5000)      <span class="cmt"># Stage 1</span>
simulation.step(25000)   <span class="cmt"># NVT: 100ps √∑ 4fs</span>
system.addForce(MonteCarloBarostat(1*atmospheres, 310.15*kelvin))
simulation.step(125000)  <span class="cmt"># NPT: 500ps √∑ 4fs</span>
simulation.step(5000000) <span class="cmt"># Production: 20ns √∑ 4fs</span></pre>

${ex('x','NaN Explosion ‚Äî Jan 1 (Worst Crash)',`
<p>System: 217,986 atoms, heavy restraints (k=1000 kJ/mol/nm¬≤), timestep 4 fs with HMR.</p>
<p>OpenMM: "Particle coordinate is NaN."</p>
<p><strong>Physics:</strong> Restraint force = k √ó displacement. With k=1000, a small displacement ‚Üí huge force ‚Üí huge acceleration (F=ma, small mass from HMR) ‚Üí atom flies across box ‚Üí overlaps another atom ‚Üí Lennard-Jones r‚Åª¬π¬≤ ‚Üí infinite repulsion ‚Üí NaN.</p>
<p><strong>The lethal combo:</strong> High restraints + HMR + 4fs timestep. Any two would have been fine. All three = guaranteed crash.</p>
<p><strong>Fix:</strong> Reduced restraints, ramped up gradually, dropped to 2 fs for restraint phase.</p>
`)}

<h2>Key MD Results</h2>
<div class="c cg">
<h3>APO Dynamics (Protein Without Drug) ‚Äî Proving the Allosteric Effect</h3>
<table>
<tr><th>Metric</th><th>Wild-Type</th><th>R702W</th><th>Meaning</th></tr>
<tr><td>${au('RMSD','RMSD')}</td><td class="n">4.05 √Ö</td><td class="n">3.27 √Ö</td><td>R702W backbone moves LESS ‚Äî more rigid</td></tr>
<tr><td>Frames >5 √Ö</td><td class="n">12.6%</td><td class="n">0%</td><td>WT regularly visits large conformations; R702W NEVER does</td></tr>
</table>
<p>This proves R702W rigidifies the entire protein ‚Äî the allosteric effect propagates 79.4 √Ö from HD2 to LRR.</p>

<h3>Drug Binding Stability</h3>
<table>
<tr><th>Compound</th><th>Pocket Occupancy</th><th>H-bonds</th><th>Verdict</th></tr>
<tr><td>${au('febuxostat','Febuxostat')}</td><td class="n">~73%</td><td class="n">~2</td><td>Stays in pocket ‚úì</td></tr>
<tr><td>${au('bufadienolide','Bufadienolide')}</td><td class="n">~80%</td><td class="n">~2</td><td>Most stable of all candidates ‚úì</td></tr>
<tr><td>Negative control</td><td class="n">~0%</td><td class="n">0</td><td>Left pocket by ~5 ns ‚Äî validates method</td></tr>
</table>
</div>

${bridge("MD confirmed drugs stay in the pocket. But HOW TIGHTLY? And does R702W change that? Only FEP can answer this.")}
`},


// ============ FEP ‚Äî AP Bio ‚Üí PhD ============
{id:'fep',icon:'‚ö°',label:'6. FEP',ct:`
<h1>6. Free Energy Perturbation ‚Äî The Gold Standard ${au('FEP','FEP')}</h1>
<p class="sub">This is the most rigorous calculation in your project. You will understand every step ‚Äî from "what is free energy" to your actual MBAR analysis code.</p>

${build("Why FEP After MD?",`<p>MD showed drugs STAY in the pocket. But how TIGHTLY? And does R702W change binding strength? You need a NUMBER ‚Äî not "it stays" but "it binds with ‚àí10.36 ¬± 0.18 kcal/mol." Only FEP provides that with pharmaceutical-grade accuracy.</p>`)}

<h2>Free Energy ‚Äî From AP Chem to Drug Discovery</h2>

<p>In AP Chemistry, you learned about Gibbs free energy: <strong>ŒîG = ŒîH ‚àí TŒîS</strong>. Negative ŒîG = spontaneous reaction. This EXACT same equation governs drug binding:</p>

<div class="c ca">
<p><strong>${au('enthalpy','ŒîH (Enthalpy change)')}</strong> ‚Äî the energy from molecular interactions when the drug binds. Every ${au('hydrogen_bond','H-bond')} formed (~2‚Äì5 kcal/mol each), every ${au('van_der_waals','van der Waals')} contact (~0.5‚Äì1 kcal/mol), every ${au('electrostatic','salt bridge')} (~3‚Äì5 kcal/mol) makes ŒîH more negative (favorable). More interactions = more negative ŒîH = tighter binding.</p>

<p><strong>${au('entropy','TŒîS (Entropy penalty)')}</strong> ‚Äî the drug loses freedom when it binds. In solution, the drug can rotate, translate, and flex freely. When it binds, it's locked in one orientation. Each lost degree of freedom costs ~0.5‚Äì1 kcal/mol. More rigid binding = bigger entropy penalty = less favorable.</p>

<p><strong>ŒîG<sub>bind</sub></strong> = net result. If the enthalpy gain (good contacts) outweighs the entropy cost (lost freedom), ŒîG is negative ‚Üí binding is spontaneous ‚Üí the drug sticks.</p>

<p><strong>Your numbers:</strong> Febuxostat ŒîG = ‚àí10.36 kcal/mol (strong binding). Bufadienolide ŒîG = ‚àí15.22 kcal/mol (very strong).</p>
</div>

<h2>The Disappearing Drug ‚Äî How FEP Works</h2>

<p>You can't directly compute ŒîG<sub>bind</sub> because binding involves the drug going from bulk water into the protein pocket ‚Äî an astronomically complex process with trillions of water rearrangements. Instead, FEP uses a trick: <strong>gradually make the drug disappear</strong> and measure the energy cost.</p>

<div class="c cc">
<ol>
<li>Start with the drug fully present (all interactions ON)</li>
<li>Use a "dimmer switch" called <strong>Œª (lambda)</strong> to slowly turn off the drug's interactions. Œª=1 ‚Üí fully present. Œª=0 ‚Üí completely gone ("ghost").</li>
<li>Use <span class="n">20</span> intermediate Œª values (${au('lambda_window','lambda windows')}). At each, run a separate MD simulation and measure energy.</li>
<li>The total energy to disappear the drug = ŒîG<sub>decouple</sub></li>
</ol>
<p>Do this in the <strong>protein pocket</strong> ‚Üí get ŒîG<sub>complex</sub> (expensive to remove ‚Äî many contacts).<br>
Do this in <strong>pure water</strong> ‚Üí get ŒîG<sub>solvent</sub> (cheaper to remove ‚Äî fewer contacts).</p>
<p><strong>ŒîG<sub>bind</sub> = ŒîG<sub>solvent</sub> ‚àí ŒîG<sub>complex</sub></strong></p>
<p>This is the ${au('thermodynamic_cycle','thermodynamic cycle')} ‚Äî mathematically exact by the laws of thermodynamics. No approximations.</p>
</div>

<h2>Lambda Windows ‚Äî The Dimmer Switch in Detail</h2>

<p>You can't just flip from Œª=1 to Œª=0 in one step ‚Äî that would be like instantly removing a magnet from a fridge. Too violent. Instead, 20 gentle steps:</p>

<table>
<tr><th>Windows</th><th>What Happens</th><th>Why This Order</th></tr>
<tr><td>0‚Äì4</td><td>${au('Boresch','Boresch restraints')} turn on</td><td>Lock drug position/orientation BEFORE removing interactions (otherwise ghost drug drifts randomly)</td></tr>
<tr><td>5‚Äì12</td><td>Electrostatic charges fade out</td><td>Charge removal is smooth ‚Äî no singularities</td></tr>
<tr><td>13‚Äì19</td><td>Steric shape (${au('van_der_waals','van der Waals')}) fades out</td><td>Must use ${au('softcore','softcore potentials')} because removing shape allows atoms to overlap ‚Üí would cause infinite repulsion without softcore</td></tr>
</table>

<p><strong>3 legs per compound:</strong> WT_complex + R702W_complex + solvent. <strong>√ó 2 compounds = 6 legs √ó 20 windows = 120 total simulations.</strong></p>

<h2>Your FEP Code</h2>
<pre><span class="cmt"># From fep_pmx_natural/run_fep_gpu.py</span>
TIMESTEP = 2.0 * femtoseconds   <span class="cmt"># Conservative (not 4fs) ‚Äî precision matters</span>
TEMPERATURE = 310.0 * kelvin
EQUIL_STEPS = 50000    <span class="cmt"># 100 ps warmup per window</span>
PROD_STEPS = 500000    <span class="cmt"># 1 ns production per window</span>
ENERGY_INTERVAL = 500  <span class="cmt"># Sample every 1 ps ‚Üí 1000 samples</span>

<span class="cmt"># At each sample, evaluate energy at ALL 20 states (for MBAR)</span>
u_nk = np.zeros((1000, 20))  <span class="cmt"># rows=samples, cols=states</span>
<span class="kw">for</span> sample <span class="kw">in</span> range(1000):
    simulation.step(500)  <span class="cmt"># 1 ps of MD</span>
    <span class="kw">for</span> k <span class="kw">in</span> range(20):    <span class="cmt"># Evaluate at every lambda</span>
        context.setParameter(<span class="str">'lambda_sterics'</span>, schedule[k])
        u_nk[sample, k] = getEnergy() / kT</pre>

<pre><span class="cmt"># From run_mbar_analysis.py ‚Äî the final calculation</span>
<span class="kw">from</span> pymbar <span class="kw">import</span> MBAR

KB = 0.008314462618  <span class="cmt"># kJ/mol/K</span>
BETA = 1.0 / (KB * 310.0)  <span class="cmt"># = 0.388 mol/kJ</span>

<span class="cmt"># Stack u_nk from all 20 windows ‚Üí feed to MBAR</span>
mbar = MBAR(u_kn_matrix, N_k)
<span class="cmt"># ‚Üí ŒîG_decouple for this leg</span></pre>

<p>${au('MBAR','MBAR')} (Multistate Bennett Acceptance Ratio) is the statistically optimal method ‚Äî it simultaneously uses data from ALL 20 windows to extract the maximum-precision free energy estimate. It's the standard in pharma industry FEP.</p>

${ex('x','13 FEP Windows Failed ‚Äî Endpoint Catastrophe',`
<p>13 of 60 windows crashed (NaN). All at high lambda (windows 15‚Äì19) where steric interactions are being removed.</p>
<p><strong>Root cause: ${au('endpoint_catastrophe','Endpoint catastrophe')}.</strong> At low Œª_sterics, van der Waals repulsion becomes very weak. Water molecules rush into where the drug was. Starting from "drug present" coordinates when forces say "drug is a ghost" ‚Üí atoms overlap ‚Üí r‚Åª¬π¬≤ ‚Üí infinity ‚Üí NaN.</p>
<p><strong>Fix: Sequential seeding.</strong> Start each window from the final coordinates of the PREVIOUS window. System is already relaxed at nearby Œª. No cold-start crashes. All 120 windows completed after fix.</p>
`)}

${bridge("FEP gives you the numbers. Now let's read those numbers and understand what they mean for your project ‚Äî and for patients.")}
`},


// ============ RESULTS ‚Äî Poster Figure Walk-Through ============
{id:'res',icon:'üìä',label:'7. Results',ct:`
<h1>7. Results ‚Äî Walking Through Your Poster, Figure by Figure</h1>
<p class="sub">Every figure, every number, every bar on your poster ‚Äî explained until you could present it to a PhD committee.</p>

<h2>Poster Figure 1 ‚Äî NOD2 Signaling Pathway</h2>
<div class="c ca">
<p>This figure shows the MDP ‚Üí NOD2 ‚Üí RIPK2 ‚Üí TAK1 ‚Üí IKK ‚Üí NF-Œ∫B ‚Üí cytokines cascade (covered in the Biology section). When presenting, point to each step and say: "MDP binds the LRR domain, triggering a conformational change that exposes the CARD domain, which recruits RIPK2 to activate the NF-Œ∫B signaling pathway."</p>
<p>Why it's on the poster: It establishes <strong>biological context</strong>. Judges need to know what NOD2 does before understanding why drugging it matters.</p>
</div>

<h2>Poster Figure 10 ‚Äî The Full Pipeline</h2>
<div class="c ca">
<p>This is your visual funnel showing the 9,566 ‚Üí 2 cascade:</p>
<table>
<tr><th>Stage</th><th>Method</th><th>In ‚Üí Out</th></tr>
<tr><td>Library</td><td>e-Drug3D + COCONUT</td><td>‚Äî ‚Üí <span class="n">9,566</span></td></tr>
<tr><td>Docking</td><td>GNINA CNN</td><td>9,566 ‚Üí 9,566 scored</td></tr>
<tr><td>ML</td><td>NOD2-Scout XGBoost</td><td>9,566 ‚Üí <span class="n">2,129</span></td></tr>
<tr><td>ADMET</td><td>Lipinski/Veber/PAINS/Brenk</td><td>150 ‚Üí <span class="n">148</span></td></tr>
<tr><td>Curation</td><td>Expert manual selection</td><td>148 ‚Üí <span class="n">8</span></td></tr>
<tr><td>MD</td><td>OpenMM 520 ns</td><td>5 ‚Üí <span class="n">2</span></td></tr>
<tr><td>FEP</td><td>120 lambda windows</td><td>2 ‚Üí <span class="n">2 characterized</span></td></tr>
</table>
<p>When presenting: "Each stage is more expensive but more accurate. Cheap methods first screen thousands; expensive methods validate the best few."</p>
</div>

<h2>Poster ML Validation Figures ‚Äî AUC and Controls</h2>
<div class="c cc">
<p>These figures show two things:</p>
<p><strong>ROC Curve:</strong> Plots true positive rate vs false positive rate at different classification thresholds. The area under this curve (${au('AUC','AUC')}) measures how well the model discriminates binders from non-binders. Your AUC: <span class="n">0.85‚Äì0.93</span> across 5-fold scaffold-split CV. Perfect = 1.0. Random = 0.50.</p>
<p><strong>Shuffled control:</strong> When labels are randomized ‚Üí AUC drops to <span class="n">~0.50</span>. This proves the real model learned genuine binding signal.</p>
<p>What to say: "Scaffold-split cross-validation with an AUC of 0.85 to 0.93 means the model generalizes to entirely new chemical families. The shuffled-label control at 0.50 confirms this isn't an artifact."</p>
</div>

<h2>Poster MD Figures ‚Äî RMSD and Occupancy</h2>
<div class="c cc">
<p><strong>APO RMSD plots</strong> show backbone deviation over 20 ns:</p>
<ul>
<li>Wild-type: RMSD fluctuates around <span class="n">4.05 √Ö</span> with visits up to 5+ √Ö in 12.6% of frames</li>
<li>R702W: RMSD plateaus at <span class="n">3.27 √Ö</span>, NEVER exceeds 5 √Ö (0% of frames)</li>
</ul>
<p>What to say: "The mutant protein is quantifiably more rigid. This rigidification propagates 79.4 Angstroms from the mutation site to the binding pocket ‚Äî a classic allosteric mechanism."</p>

<p><strong>Pocket occupancy plots</strong> show drug position over time:</p>
<ul>
<li>Febuxostat: ~73% occupancy, maintains ~2 H-bonds on average</li>
<li>Bufadienolide: ~80% occupancy, most stable candidate</li>
<li>Negative control: leaves pocket by ~5 ns ‚Üí 0% occupancy after that</li>
</ul>
<p>The negative control is essential ‚Äî it proves your method correctly distinguishes real binders from non-binders.</p>
</div>

<h2>Poster Figure 16 ‚Äî THE Key Result (FEP)</h2>

<p>This is the figure that makes your project competition-winning. Every number matters:</p>

<div class="c cg" style="border-left-width:4px">
<table>
<tr><th>Compound</th><th>${au('delta_G','ŒîG')}<sub>bind</sub> (WT)</th><th>ŒîG<sub>bind</sub> (R702W)</th><th>${au('delta_delta_G','ŒîŒîG')}</th><th>Significance</th></tr>
<tr><td><strong>${au('febuxostat','Febuxostat')}</strong></td><td class="n">‚àí10.36 ¬± 0.18</td><td class="n">‚àí8.02 ¬± 0.19</td><td class="n" style="color:var(--red)">+2.34 ¬± 0.26</td><td class="n">8œÉ, p < 0.001</td></tr>
<tr><td><strong>${au('bufadienolide','Bufadienolide')}</strong></td><td class="n">‚àí15.22 ¬± 0.26</td><td class="n">‚àí15.66 ¬± 0.26</td><td class="n" style="color:var(--grn)">‚àí0.44 ¬± 0.37</td><td>1.8œÉ, not significant</td></tr>
</table>
</div>

<p>Let's decode every number:</p>

<h3>ŒîG = ‚àí10.36 ¬± 0.18 kcal/mol (Febuxostat, Wild-Type)</h3>
<div class="c">
<p><strong>‚àí10.36:</strong> Febuxostat binds wild-type NOD2 strongly. For reference: a "drug-like" affinity is ‚àí6 to ‚àí10 ${au('kcal_mol','kcal/mol')}. Anything more negative than ‚àí8 is considered strong binding. ‚àí10.36 is excellent.</p>
<p><strong>¬± 0.18:</strong> The uncertainty from finite sampling. You ran 1 ns per lambda window, not infinity. ${au('MBAR','MBAR')} estimates this statistical error. ¬±0.18 is remarkably precise ‚Äî typical FEP uncertainty is ¬±0.5‚Äì1.5. Your low error bars mean the calculation converged well.</p>
</div>

<h3>ŒîŒîG = +2.34 ¬± 0.26 kcal/mol (Febuxostat)</h3>
<div class="c co">
<p><strong>Positive ŒîŒîG = weaker binding in the mutant.</strong> The R702W mutation makes Febuxostat bind 2.34 kcal/mol less tightly. In drug discovery, anything >1 kcal/mol is considered significant.</p>
<p><strong>Converting to fold-change</strong> using the ${au('Boltzmann','Boltzmann relationship')}:</p>
<p>At 310 K: RT = 0.616 kcal/mol</p>
<p><strong>Fold-change = e<sup>(ŒîŒîG/RT)</sup> = e<sup>(2.34/0.616)</sup> = e<sup>3.80</sup> ‚âà <span class="n">45‚Äì50√ó weaker</span></strong></p>
<p>In practical terms: If Febuxostat has a dissociation constant (Kd) of 10 nM for wild-type, it would be ~500 nM for R702W. That's typically the difference between a viable drug and a failed clinical trial.</p>
</div>

<h3>What 8œÉ Means</h3>
<div class="c co">
<p>œÉ = standard deviation of uncertainty. <strong>Sigma level = |ŒîŒîG| / œÉ<sub>ŒîŒîG</sub> = 2.34 / 0.26 ‚âà 9.0œÉ</strong> (poster rounds to 8œÉ).</p>
<p>Context: In particle physics, <strong>5œÉ is a "discovery"</strong> (the Higgs boson was announced at 5œÉ). In drug discovery, 3œÉ is "significant." Your 8œÉ is extraordinarily robust. The probability of this being a random fluctuation: p < 10‚Åª¬π‚Åµ. <strong>This is not noise.</strong></p>
</div>

<h3>Bufadienolide: ŒîŒîG = ‚àí0.44 ¬± 0.37 (Not Significant)</h3>
<div class="c cg">
<p>The ‚àí0.44 suggests Bufadienolide might bind slightly BETTER to R702W, but at 1.8œÉ (below the 2œÉ threshold), this is <strong>indistinguishable from zero</strong> within statistical uncertainty. The safe conclusion: Bufadienolide's binding is <strong>unaffected by the mutation</strong>.</p>
</div>

<h2>WHY the Drugs Behave Differently ‚Äî The Mechanism</h2>

<div class="vs">
<div class="vl">
<h3 style="color:var(--red)">Febuxostat ‚Äî Mutation-SENSITIVE</h3>
<p>Binding depends on ${au('electrostatic','electrostatic contacts')} ‚Äî specifically H-bonds with ${au('ASP1011','ASP1011')} (a negatively charged residue).</p>
<p>H-bonds require precise geometry: donor-acceptor distance <3.5 √Ö AND angle 120‚Äì180¬∞. When R702W rigidifies the protein, the pocket shifts subtly (~0.5‚Äì1.0 √Ö). ASP1011's position changes just enough to break the H-bond. Lost H-bonds ‚Üí lost enthalpy ‚Üí +2.34 kcal/mol penalty.</p>
</div>
<div class="vw">
<h3 style="color:var(--grn)">Bufadienolide ‚Äî Mutation-RESISTANT</h3>
<p>Binding depends on ${au('hydrophobic','hydrophobic contacts')} ‚Äî van der Waals with nonpolar residues (LEU, ILE, VAL).</p>
<p>Hydrophobic contacts are geometry-tolerant ‚Äî they need surface complementarity (4‚Äì6 √Ö contact distance) but not the precision of H-bonds. Even though R702W rigidifies the pocket, the nonpolar surface geometry stays similar enough. Contacts survive ‚Üí binding energy unchanged.</p>
</div>
</div>

<div class="ky">
<p><strong>THE DISCOVERY:</strong> Mutation effects on drug binding are <strong>ligand-dependent</strong>. The same mutation makes one drug 50√ó weaker while leaving another unaffected. This means you can't develop "a NOD2 drug" for all patients ‚Äî drug selection must account for genotype. This is ${au('pharmacogenomics','pharmacogenomics')}: choosing the right drug based on the patient's genetics. That's ${au('precision_medicine','precision medicine')}.</p>
<p><strong>Novel finding:</strong> No prior reports of Bufadienolide interacting with NOD2 exist in the literature. This is a genuinely new discovery.</p>
</div>

<h2>MM-GBSA vs FEP ‚Äî Why You Needed Both</h2>
<div class="c co">
<p>Your earlier, cheaper calculation (MM-GBSA ‚Äî takes snapshots and approximates water as a smooth field) gave a <strong>different ranking</strong> than FEP. If you had stopped at MM-GBSA, you would have drawn wrong conclusions about which drugs are mutation-sensitive.</p>
<p>FEP was necessary because the ŒîŒîG depends on subtle water rearrangements around the drug ‚Äî something implicit solvent (MM-GBSA) can't capture. This is why FEP is the gold standard and why pharma companies pay $100K+/year for Schr√∂dinger's FEP+ software. You implemented it for free using OpenMM + pymbar.</p>
</div>

<h2>Limitations ‚Äî Be Ready for These</h2>
<div class="c cr">
<ul>
<li><strong>Computational only:</strong> No experimental validation yet (SPR, ITC, cell assays needed)</li>
<li><strong>AlphaFold structure:</strong> No crystal structure exists. pLDDT >90 is high confidence but not experimental proof.</li>
<li><strong>Only R702W tested:</strong> G908R and 1007fs variants remain unexplored</li>
<li><strong>Only 2 compounds through FEP:</strong> 120 lambda windows per compound is computationally expensive; more variants would strengthen the finding</li>
<li><strong>No cell-level validation:</strong> Binding ‚â† functional modulation. Drug could bind but not change NOD2 signaling.</li>
</ul>
<p>Always acknowledge limitations BEFORE a judge brings them up. It shows scientific maturity.</p>
</div>

${ex('j','Judge: "What would you do next?"',`
<p>"Three experimental approaches. First, SPR ‚Äî surface plasmon resonance ‚Äî to measure binding kinetics and confirm the predicted 50-fold affinity difference between wild-type and R702W. Second, ITC ‚Äî isothermal titration calorimetry ‚Äî to decompose binding into enthalpy and entropy, validating whether Febuxostat's penalty is enthalpic as our simulations predict. Third, HDX mass spectrometry to map which residues change dynamics upon drug binding, directly testing the allosteric mechanism. Computationally, I'd extend to G908R and 1007fs to build a complete mutation sensitivity profile."</p>
`)}
`},


// ============ PRESENTATION ============
{id:'talk',icon:'üé§',label:'8. Presentation',ct:`
<h1>8. Presenting Your Project ‚Äî 3 Minutes to Win</h1>
<p class="sub">Your pitch script, top judge questions with full scripted answers, and delivery tips.</p>

<h2>The 3-Minute Pitch</h2>
<div class="c ca">
<h3>HOOK (20 seconds)</h3>
<p><em>"When I was 14, a genetic test showed I carry the R702W variant of NOD2 ‚Äî a mutation linked to Crohn's disease. I receive Remicade infusions that treat the inflammation, but they don't fix the underlying defect in my immune sensor. I wanted to know: can we find drugs that work despite the mutation?"</em></p>

<h3>PIPELINE (60 seconds) ‚Äî Point at Figure 10</h3>
<p><em>"I built a computational drug discovery pipeline. Starting with 9,566 compounds from FDA-approved and natural product libraries, I used GNINA ‚Äî a convolutional neural network docking tool ‚Äî to score each compound's fit in NOD2's LRR binding pocket.</em></p>
<p><em>I then trained NOD2-Scout, an XGBoost classifier validated with scaffold-split cross-validation ‚Äî meaning the model must generalize to entirely new chemical families, not just variants of known scaffolds. We caught and corrected data leakage that initially inflated our AUC to 0.998; the honest AUC is 0.85 to 0.93.</em></p>
<p><em>After ADMET safety filtering and expert curation, I ran 520 nanoseconds of molecular dynamics to confirm stable pocket binding."</em></p>

<h3>DISCOVERY (40 seconds) ‚Äî Point at Figure 16</h3>
<p><em>"The key experiment was Free Energy Perturbation across 120 lambda windows. Febuxostat shows a ŒîŒîG of plus 2.34 kcal/mol ‚Äî 8 sigma significance ‚Äî meaning it binds roughly 50-fold weaker to the R702W mutant. The mutation disrupts an electrostatic contact network with ASP1011.</em></p>
<p><em>But Bufadienolide, a natural cardiac glycoside, shows no significant change. Its hydrophobic contacts survive the mutation-induced rigidification. This is a previously unreported NOD2 interaction."</em></p>

<h3>CLOSE (20 seconds)</h3>
<p><em>"This demonstrates that mutation effects on drug binding are ligand-dependent ‚Äî you can't develop a one-size-fits-all NOD2 drug. Drug selection should account for patient genotype. That's pharmacogenomic-guided precision medicine."</em></p>
</div>

<h2>Top Judge Questions ‚Äî Full Scripted Answers</h2>

${ex('j','Why AlphaFold instead of a crystal structure?',`
<p>"No complete crystal structure of human NOD2 exists. PDB 5IRM covers only the CARD and NBD domains ‚Äî residues 1 through 577. The LRR domain where our compounds bind, residues 744 to 1040, is entirely absent. AlphaFold2 predicted full-length NOD2 with pLDDT scores above 90 in the LRR region, indicating very high confidence comparable to approximately 2-Angstrom experimental resolution. We acknowledge this as a limitation and plan to validate with experimental structures when they become available."</p>
`)}

${ex('j','How do you know the ML model isn\'t memorizing?',`
<p>"Three controls. First, scaffold-split cross-validation ‚Äî no molecule in the test set shares a Murcko scaffold with any training molecule. The model generalizes to entirely new chemical families. Second, the shuffled-label control ‚Äî randomize labels, retrain identically ‚Äî AUC drops to 0.50, pure chance. The real AUC of 0.85 to 0.93 is genuine signal. Third, we initially detected data leakage when random splits gave 0.998, identified scaffold overlap as the cause, and corrected it."</p>
`)}

${ex('j','Explain ŒîŒîG = +2.34 in practical terms',`
<p>"Through the Boltzmann relationship at body temperature, 2.34 kcal/mol converts to approximately 50-fold weaker binding. If Febuxostat had a Kd of 10 nanomolar for wild-type NOD2, it would be about 500 nanomolar for R702W. In drug development, that magnitude of affinity loss is typically the difference between a viable drug and a failed clinical candidate. The 8-sigma significance means this is far beyond statistical noise."</p>
`)}

${ex('j','How does a mutation 79 Angstroms away affect the binding pocket?',`
<p>"Classic allosteric mechanism, supported by our MD data. Apo simulations show R702W reduces backbone RMSD from 4.05 to 3.27 Angstroms ‚Äî the mutant is more rigid. Wild-type visits large conformations exceeding 5 Angstroms in 12.6% of frames; R702W never does. This rigidification propagates through the HD2-to-LRR helical interface. The consequence: Febuxostat's hydrogen bond network with ASP1011 is disrupted because the pocket can't accommodate the same geometry, while Bufadienolide's hydrophobic contacts are shape-tolerant and survive."</p>
`)}

${ex('j','Did AI write your code?',`
<p>"Claude Code CLI helped write and debug Python implementation ‚Äî OpenMM setup, batch scripts, CUDA errors. The scientific decisions ‚Äî method selection, parameter choices, interpreting results, designing the pipeline ‚Äî those were mine. Every AI interaction is documented with timestamps in my logbook and a dedicated AI Prompt Log appendix. I can show you specific examples of what I asked AI versus what I decided independently."</p>
`)}

${ex('j','What would you do next?',`
<p>"Three experimental approaches. First, SPR to measure binding kinetics and confirm the predicted 50-fold affinity difference. Second, ITC to decompose binding thermodynamics into enthalpy and entropy contributions ‚Äî validating whether Febuxostat's penalty is enthalpic as we predict. Third, HDX mass spectrometry to directly test the allosteric mechanism by mapping which residues change dynamics upon drug binding. Computationally, I'd extend to G908R and 1007fs variants to build a complete mutation sensitivity profile."</p>
`)}

${ex('j','Why only 2 compounds through FEP?',`
<p>"FEP requires 120 lambda windows total ‚Äî each with 1 nanosecond of simulation. On my RTX 4060 Ti, each compound pair took about 48 GPU-hours. Running all 148 ADMET-passing compounds would take over 3,500 GPU-hours. The two selected represent distinct binding mechanisms ‚Äî electrostatic-dependent versus hydrophobic-dependent ‚Äî sufficient to demonstrate the principle that mutation effects are ligand-specific."</p>
`)}

${ex('j','Why is Crohn\'s inflammatory if the mutation REDUCES immune sensing?',`
<p>"Paradoxically, the initial immune deficiency leads to chronic inflammation. When NOD2 can't detect bacteria through MDP sensing, the innate immune system fails to clear bacteria early. Bacteria proliferate, and the body compensates through alternative, less precise pathways ‚Äî Toll-like receptors, the inflammasome ‚Äî which trigger a massive, sustained inflammatory response that damages tissue. It's like a fire alarm with dead batteries: the fire smolders, then eventually someone notices and calls every fire department in the city. The response does more damage than the original problem."</p>
`)}

${ex('j','What is Febuxostat normally used for?',`
<p>"Febuxostat is an FDA-approved xanthine oxidase inhibitor used to treat gout ‚Äî it reduces uric acid production. It has no established connection to NOD2 or Crohn's disease. This is a drug repurposing approach ‚Äî finding new therapeutic applications for existing approved drugs. The advantage is that safety and pharmacokinetic data already exist, so if it showed promise for NOD2, clinical development would be years faster than a novel molecule."</p>
`)}

<h2>Delivery Tips</h2>
<div class="c">
<p><strong>Point at your poster</strong> as you talk ‚Äî physically touch near each figure. Guide the judge's eyes. When you say "Figure 16," point at it.</p>
<p><strong>Slow down for key numbers:</strong> "Eight sigma significance‚Ä¶ approximately fifty-fold weaker‚Ä¶ zero prior reports in the literature." Pause after each. Let them land.</p>
<p><strong>Eye contact:</strong> Look at the poster when explaining methods. Look at the JUDGE when delivering the discovery and close.</p>
<p><strong>If you don't know:</strong> "That's a great question. I haven't investigated that specific aspect, but based on my results, my hypothesis would be‚Ä¶" ‚Äî then reason through it. Judges LOVE when students reason through unknowns honestly.</p>
<p><strong>Personal connection:</strong> If they ask about motivation, briefly mention carrying the variant and receiving Remicade infusions. ~10 seconds max. Let the science speak for itself.</p>
</div>
`},

];

// ============ RENDER ENGINE ============
const sb=document.getElementById('sb'),mn=document.getElementById('mn'),ct=document.getElementById('ct');
S.forEach((s,i)=>{
const b=document.createElement('button');b.className='sb'+(i===0?' on':'');b.innerHTML=s.icon+' '+s.label;b.onclick=()=>go(s.id);sb.appendChild(b);
const m=document.createElement('button');m.className='mb'+(i===0?' on':'');m.textContent=s.icon;m.title=s.label;m.onclick=()=>go(s.id);mn.appendChild(m);
const d=document.createElement('div');d.id='s_'+s.id;d.className='sec'+(i===0?' on':'');d.innerHTML=s.ct;ct.appendChild(d);
});
function go(id){
document.querySelectorAll('.sb,.mb').forEach(b=>b.classList.remove('on'));
document.querySelectorAll('.sec').forEach(s=>s.classList.remove('on'));
const ix=S.findIndex(s=>s.id===id);
document.querySelectorAll('.sb')[ix]?.classList.add('on');
document.querySelectorAll('.mb')[ix]?.classList.add('on');
document.getElementById('s_'+id).classList.add('on');
window.scrollTo(0,0);
}
</script>
</body>
</html>
