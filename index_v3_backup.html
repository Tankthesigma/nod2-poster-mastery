<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NOD2 Project Mastery ‚Äî ISEF 2026</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=DM+Sans:wght@400;500;700;900&family=Fraunces:wght@700;900&display=swap" rel="stylesheet">
<style>
:root{--bg:#07070d;--s1:#0f0f1a;--s2:#161625;--s3:#1e1e32;--brd:#2a2a42;--txt:#d0d0e0;--mut:#7878a0;--acc:#7c3aed;--a2:#a78bfa;--grn:#10b981;--red:#ef4444;--org:#f59e0b;--cyn:#06b6d4;--pnk:#ec4899;--blu:#3b82f6}
*{margin:0;padding:0;box-sizing:border-box}body{background:var(--bg);color:var(--txt);font-family:'DM Sans',sans-serif;line-height:1.8;font-size:15px}
h1,h2,h3{font-family:'Fraunces',serif}code,pre{font-family:'JetBrains Mono',monospace}
.shell{display:flex;min-height:100vh}.sidebar{width:220px;background:var(--s1);border-right:1px solid var(--brd);position:fixed;top:0;left:0;bottom:0;overflow-y:auto;z-index:50;padding:12px 0}
.sidebar h2{font-size:11px;color:var(--mut);padding:16px 16px 6px;letter-spacing:1.5px;text-transform:uppercase;font-family:'DM Sans',sans-serif;font-weight:700}
.sb{display:block;width:100%;text-align:left;background:none;border:none;color:var(--mut);padding:9px 16px;font-size:13px;font-family:'DM Sans',sans-serif;cursor:pointer;transition:all .12s;border-left:3px solid transparent}
.sb:hover{color:var(--txt);background:rgba(124,58,237,.06)}.sb.on{color:var(--a2);background:rgba(124,58,237,.1);border-left-color:var(--acc)}
.ct{margin-left:220px;flex:1;padding:28px 36px 80px;max-width:880px}
@media(max-width:800px){.sidebar{display:none}.ct{margin-left:0;padding:14px}.mn{display:flex!important}}
.mn{display:none;position:sticky;top:0;z-index:50;background:rgba(7,7,13,.95);backdrop-filter:blur(10px);overflow-x:auto;border-bottom:1px solid var(--brd);padding:0 6px}
.mb{background:none;border:none;color:var(--mut);padding:10px 12px;font-size:11px;font-family:'DM Sans',sans-serif;cursor:pointer;white-space:nowrap;border-bottom:2px solid transparent}
.mb.on{color:var(--a2);border-bottom-color:var(--acc)}
.sec{display:none;animation:fu .25s}.sec.on{display:block}@keyframes fu{from{opacity:0;transform:translateY(5px)}to{opacity:1;transform:none}}
h1{font-size:2em;margin-bottom:4px;background:linear-gradient(135deg,var(--a2),var(--cyn));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.sub{color:var(--mut);font-size:13px;margin-bottom:20px}h2{font-size:1.4em;color:var(--a2);margin:24px 0 12px}h3{font-size:1.05em;color:var(--cyn);margin:18px 0 8px;font-family:'DM Sans',sans-serif;font-weight:700}
p{margin-bottom:11px}strong{color:#fff}em{color:var(--a2)}
.lv{display:flex;gap:5px;margin:14px 0;position:sticky;top:0;z-index:10;background:var(--bg);padding:6px 0}
.lb{padding:7px 14px;border-radius:7px;border:1px solid var(--brd);background:var(--s1);color:var(--mut);font-size:12px;font-weight:700;cursor:pointer;font-family:'DM Sans',sans-serif;transition:all .12s}
.lb:hover{border-color:var(--acc)}.lb.on{background:var(--acc);color:#fff;border-color:var(--acc)}
.L0,.L1,.L2,.L3{display:none}.sL0 .L0,.sL1 .L0,.sL1 .L1,.sL2 .L0,.sL2 .L1,.sL2 .L2,.sL3 .L0,.sL3 .L1,.sL3 .L2,.sL3 .L3{display:block}
.c{background:var(--s1);border:1px solid var(--brd);border-radius:10px;padding:18px;margin:12px 0}
.ca{border-left:3px solid var(--acc)}.cg{border-left:3px solid var(--grn)}.co{border-left:3px solid var(--org)}.cr{border-left:3px solid var(--red)}.cc{border-left:3px solid var(--cyn)}.cp{border-left:3px solid var(--pnk)}.cb{border-left:3px solid var(--blu)}
.ex{margin:8px 0}.exh{display:flex;align-items:center;gap:6px;cursor:pointer;padding:10px 12px;background:var(--s2);border:1px solid var(--brd);border-radius:7px;font-weight:500;transition:all .12s;font-size:13px}
.exh:hover{background:var(--s3)}.ea{transition:transform .12s;font-size:10px}.exh.op .ea{transform:rotate(90deg)}
.exb{display:none;padding:14px;background:var(--s1);border:1px solid var(--brd);border-top:none;border-radius:0 0 7px 7px;font-size:13.5px;line-height:1.8}.exb.op{display:block}
.tg{display:inline-block;padding:1px 7px;border-radius:3px;font-size:10px;font-weight:700;margin-right:3px}
.tw{background:rgba(124,58,237,.2);color:var(--a2)}.tc{background:rgba(6,182,212,.2);color:var(--cyn)}.tj{background:rgba(16,185,129,.2);color:var(--grn)}.tx{background:rgba(239,68,68,.2);color:var(--red)}.tl{background:rgba(236,72,153,.2);color:var(--pnk)}.ti{background:rgba(245,158,11,.2);color:var(--org)}
pre{background:#090914;border:1px solid var(--brd);border-radius:7px;padding:12px;overflow-x:auto;font-size:12px;line-height:1.65;margin:8px 0;color:#b0b0c8}
code{background:rgba(124,58,237,.12);padding:1px 4px;border-radius:3px;font-size:.87em;color:var(--a2)}
table{width:100%;border-collapse:collapse;margin:8px 0;font-size:13px}th{background:var(--s2);padding:8px 10px;text-align:left;border-bottom:2px solid var(--acc);font-weight:700;font-size:11px;text-transform:uppercase;letter-spacing:.4px}td{padding:8px 10px;border-bottom:1px solid var(--brd)}
.n{color:var(--org);font-weight:700;font-family:'JetBrains Mono',monospace}
.au{display:inline-flex;align-items:center;gap:3px;background:rgba(245,158,11,.1);border:1px solid rgba(245,158,11,.22);color:var(--org);padding:2px 8px;border-radius:16px;font-size:11px;cursor:pointer;font-family:'DM Sans',sans-serif;transition:all .12s;margin:1px}
.au:hover{background:rgba(245,158,11,.2)}.au.pl{background:rgba(245,158,11,.3);box-shadow:0 0 6px rgba(245,158,11,.25)}
.vs{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin:12px 0}@media(max-width:700px){.vs{grid-template-columns:1fr}}
.vw{padding:14px;border-radius:8px;background:rgba(16,185,129,.06);border:1px solid rgba(16,185,129,.22)}.vl{padding:14px;border-radius:8px;background:rgba(239,68,68,.04);border:1px solid rgba(239,68,68,.15)}
.ky{background:linear-gradient(135deg,rgba(124,58,237,.07),rgba(6,182,212,.07));border:1px solid rgba(124,58,237,.18);border-radius:10px;padding:16px 18px;margin:12px 0}
.gg{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:6px;margin:10px 0}
.gi{background:var(--s2);border:1px solid var(--brd);border-radius:7px;padding:8px 10px;font-size:12px;cursor:pointer;transition:all .12s}
.gi:hover{border-color:var(--acc);background:var(--s3)}
ol,ul{padding-left:18px;margin-bottom:10px}li{margin-bottom:4px}
.cmt{color:#6a9955;font-style:italic}
.kw{color:#c586c0}
.str{color:#ce9178}
.fn{color:#dcdcaa}
</style>
</head>
<body>
<div class="mn" id="mn"></div>
<div class="shell">
<nav class="sidebar" id="sb"><h2>ISEF Mastery</h2></nav>
<main class="ct" id="ct"></main>
</div>
<script>
let cA=null;
function pa(f,b){if(cA){cA.pause();document.querySelectorAll('.au.pl').forEach(x=>x.classList.remove('pl'))}
const a=new Audio('audio/'+f+'.mp3');cA=a;if(b)b.classList.add('pl');
a.onended=()=>{if(b)b.classList.remove('pl')};
a.onerror=()=>{if('speechSynthesis'in window){const u=new SpeechSynthesisUtterance(b?.dataset?.fb||f);u.rate=0.7;speechSynthesis.speak(u)}if(b)setTimeout(()=>b.classList.remove('pl'),2e3)};a.play()}
function au(f,l,fb){return`<button class="au" data-fb="${fb||l}" onclick="pa('${f}',this)">üîä ${l}</button>`}
function ex(t,ti,bo){const id='e'+Math.random().toString(36).substr(2,6);const tc={w:'tw',c:'tc',j:'tj',x:'tx',l:'tl',i:'ti'}[t]||'tw';const tn={w:'WHY',c:'CODE',j:'JUDGE Q&A',x:'CRASH',l:'HOW I LEARNED',i:'WHAT-IF'}[t]||t.toUpperCase();
return`<div class="ex"><div class="exh" onclick="this.classList.toggle('op');document.getElementById('${id}').classList.toggle('op')"><span class="ea">‚ñ∂</span><span class="tg ${tc}">${tn}</span>${ti}</div><div class="exb" id="${id}">${bo}</div></div>`}

const S=[

// ============ GLOSSARY ============
{id:'glo',icon:'üìñ',label:'Audio Glossary',ct:`
<h1>Audio Pronunciation Glossary</h1>
<p class="sub">75 terms with Google TTS pronunciation. Tap any üîä button to hear it. Master these before Saturday.</p>

<h2>Biology & Disease</h2>
<div class="gg">
<div class="gi"><strong>NOD2</strong><br><small>Innate immune sensor</small>${au('NOD2','NOD2')}</div>
<div class="gi"><strong>MDP</strong><br><small>Bacterial wall fragment</small>${au('MDP','MDP')}</div>
<div class="gi"><strong>Muramyl Dipeptide</strong><br><small>Full name of MDP</small>${au('muramyl_dipeptide','Muramyl Dipeptide')}</div>
<div class="gi"><strong>R702W</strong><br><small>Your Crohn's mutation</small>${au('R702W','R702W')}</div>
<div class="gi"><strong>NF-Œ∫B</strong><br><small>Transcription factor</small>${au('NF_kappa_B','NF-Œ∫B')}</div>
<div class="gi"><strong>RIPK2</strong><br><small>Signaling kinase</small>${au('RIPK2','RIPK2')}</div>
<div class="gi"><strong>TAK1</strong><br><small>Kinase complex</small>${au('TAK1','TAK1')}</div>
<div class="gi"><strong>Crohn's Disease</strong><br><small>Inflammatory bowel</small>${au('crohns',"Crohn's")}</div>
<div class="gi"><strong>Allosteric</strong><br><small>Distant-site effect</small>${au('allosteric','Allosteric')}</div>
<div class="gi"><strong>LRR Domain</strong><br><small>Drug binding region</small>${au('LRR','LRR')}</div>
<div class="gi"><strong>Arginine (R)</strong><br><small>Normal at position 702</small>${au('arginine','Arginine')}</div>
<div class="gi"><strong>Tryptophan (W)</strong><br><small>Mutant at position 702</small>${au('tryptophan','Tryptophan')}</div>
<div class="gi"><strong>ASP1011</strong><br><small>Key pocket residue</small>${au('ASP1011','ASP1011')}</div>
</div>

<h2>Computational Methods</h2>
<div class="gg">
<div class="gi"><strong>GNINA</strong><br><small>CNN docking tool</small>${au('GNINA','GNINA')}</div>
<div class="gi"><strong>CNN</strong><br><small>Convolutional Neural Net</small>${au('CNN','CNN')}</div>
<div class="gi"><strong>XGBoost</strong><br><small>ML tree ensemble</small>${au('XGBoost','XGBoost')}</div>
<div class="gi"><strong>Morgan Fingerprint</strong><br><small>Molecular barcode</small>${au('morgan_fingerprint','Morgan FP')}</div>
<div class="gi"><strong>Scaffold Split</strong><br><small>Honest data splitting</small>${au('scaffold_split','Scaffold Split')}</div>
<div class="gi"><strong>Pseudo-Label</strong><br><small>Docking-derived labels</small>${au('pseudo_label','Pseudo Label')}</div>
<div class="gi"><strong>AUC / ROC</strong><br><small>ML performance</small>${au('AUC','AUC')} ${au('ROC','ROC')}</div>
<div class="gi"><strong>ADMET</strong><br><small>Drug safety filters</small>${au('ADMET','ADMET')}</div>
<div class="gi"><strong>Lipinski</strong><br><small>Rule of 5</small>${au('lipinski','Lipinski')}</div>
<div class="gi"><strong>PAINS</strong><br><small>False positive filters</small>${au('PAINS','PAINS')}</div>
<div class="gi"><strong>TPSA</strong><br><small>Polar surface area</small>${au('TPSA','TPSA')}</div>
<div class="gi"><strong>Murcko Scaffold</strong><br><small>Core backbone</small>${au('Murcko','Murcko')}</div>
<div class="gi"><strong>Docking</strong><br><small>Drug-protein fitting</small>${au('docking','Docking')}</div>
<div class="gi"><strong>Binding Pocket</strong><br><small>Where drugs sit</small>${au('binding_pocket','Binding Pocket')}</div>
<div class="gi"><strong>Data Leakage</strong><br><small>Test set contamination</small>${au('data_leakage','Data Leakage')}</div>
</div>

<h2>Molecular Dynamics</h2>
<div class="gg">
<div class="gi"><strong>MD Simulation</strong><br><small>F=ma for atoms</small>${au('molecular_dynamics','MD')}</div>
<div class="gi"><strong>OpenMM</strong><br><small>Simulation engine</small>${au('OpenMM','OpenMM')}</div>
<div class="gi"><strong>AMBER14</strong><br><small>Protein force field</small>${au('AMBER14','AMBER14')}</div>
<div class="gi"><strong>TIP3P-FB</strong><br><small>Water model</small>${au('TIP3P_FB','TIP3P-FB')}</div>
<div class="gi"><strong>OpenFF 2.1</strong><br><small>Ligand force field</small>${au('OpenFF','OpenFF')}</div>
<div class="gi"><strong>Force Field</strong><br><small>Atomic interaction rules</small>${au('force_field','Force Field')}</div>
<div class="gi"><strong>NVT Ensemble</strong><br><small>Const. N, V, T</small>${au('NVT','NVT')}</div>
<div class="gi"><strong>NPT Ensemble</strong><br><small>Const. N, P, T</small>${au('NPT','NPT')}</div>
<div class="gi"><strong>RMSD</strong><br><small>Structure deviation</small>${au('RMSD','RMSD')}</div>
<div class="gi"><strong>HMR</strong><br><small>H-mass repartitioning</small>${au('HMR','HMR')}</div>
<div class="gi"><strong>PME</strong><br><small>Electrostatics algorithm</small>${au('PME','PME')}</div>
<div class="gi"><strong>Langevin</strong><br><small>Thermostat method</small>${au('Langevin','Langevin')}</div>
<div class="gi"><strong>Barostat</strong><br><small>Pressure controller</small>${au('barostat','Barostat')}</div>
<div class="gi"><strong>Femtosecond</strong><br><small>10‚Åª¬π‚Åµ seconds</small>${au('femtosecond','Femtosecond')}</div>
<div class="gi"><strong>Nanosecond</strong><br><small>10‚Åª‚Åπ seconds</small>${au('nanosecond','Nanosecond')}</div>
<div class="gi"><strong>√Öngstr√∂m</strong><br><small>10‚Åª¬π‚Å∞ meters</small>${au('angstrom','Angstrom')}</div>
</div>

<h2>Free Energy Perturbation</h2>
<div class="gg">
<div class="gi"><strong>FEP</strong><br><small>Free Energy Perturbation</small>${au('FEP','FEP')}</div>
<div class="gi"><strong>ŒîG (Delta G)</strong><br><small>Binding free energy</small>${au('delta_G','Delta G')}</div>
<div class="gi"><strong>ŒîŒîG</strong><br><small>Mutation effect</small>${au('delta_delta_G','Delta Delta G')}</div>
<div class="gi"><strong>Lambda Window</strong><br><small>Intermediate FEP state</small>${au('lambda_window','Lambda Window')}</div>
<div class="gi"><strong>MBAR</strong><br><small>Free energy estimator</small>${au('MBAR','MBAR')}</div>
<div class="gi"><strong>Boresch Restraints</strong><br><small>Orientation springs</small>${au('Boresch','Boresch')}</div>
<div class="gi"><strong>Softcore Potential</strong><br><small>Prevents singularities</small>${au('softcore','Softcore')}</div>
<div class="gi"><strong>Gibbs Free Energy</strong><br><small>G = H ‚àí TS</small>${au('gibbs_free_energy','Gibbs Free Energy')}</div>
<div class="gi"><strong>Enthalpy (H)</strong><br><small>Interaction energy</small>${au('enthalpy','Enthalpy')}</div>
<div class="gi"><strong>Entropy (S)</strong><br><small>Disorder measure</small>${au('entropy','Entropy')}</div>
<div class="gi"><strong>Boltzmann</strong><br><small>ŒîG = RT ln(Kd)</small>${au('Boltzmann','Boltzmann')}</div>
<div class="gi"><strong>Kd</strong><br><small>Dissociation constant</small>${au('dissociation_constant','Kd')}</div>
<div class="gi"><strong>kcal/mol</strong><br><small>Energy unit</small>${au('kcal_mol','kcal/mol')}</div>
<div class="gi"><strong>Thermo Cycle</strong><br><small>Indirect FE calculation</small>${au('thermodynamic_cycle','Thermo Cycle')}</div>
<div class="gi"><strong>Endpoint Catastrophe</strong><br><small>Atom overlap crash</small>${au('endpoint_catastrophe','Endpoint Catastrophe')}</div>
</div>

<h2>Compounds & Future Work</h2>
<div class="gg">
<div class="gi"><strong>Febuxostat</strong><br><small>FDA drug, mut-sensitive</small>${au('febuxostat','Febuxostat')}</div>
<div class="gi"><strong>Bufadienolide</strong><br><small>Natural, mut-resistant</small>${au('bufadienolide','Bufadienolide')}</div>
<div class="gi"><strong>AlphaFold2</strong><br><small>AI structure prediction</small>${au('AlphaFold','AlphaFold')}</div>
<div class="gi"><strong>pLDDT</strong><br><small>AlphaFold confidence</small>${au('pLDDT','pLDDT')}</div>
<div class="gi"><strong>SPR</strong><br><small>Binding kinetics assay</small>${au('SPR','SPR')}</div>
<div class="gi"><strong>ITC</strong><br><small>Calorimetry assay</small>${au('ITC','ITC')}</div>
<div class="gi"><strong>HDX-MS</strong><br><small>H/D exchange mass spec</small>${au('HDX_MS','HDX-MS')}</div>
<div class="gi"><strong>Pharmacogenomics</strong><br><small>Gene-guided drugs</small>${au('pharmacogenomics','Pharmacogenomics')}</div>
<div class="gi"><strong>Precision Medicine</strong><br><small>Genotype-specific Rx</small>${au('precision_medicine','Precision Medicine')}</div>
</div>
`},


// ============ FOUNDATIONS ============
{id:'bio',icon:'üß¨',label:'Biology Foundations',ct:`
<h1>Biological Foundations</h1>
<p class="sub">From DNA to your specific mutation. Three depth levels ‚Äî start at Noob, work up to Expert.</p>
<div class="lv" id="lv_bio"><button class="lb on" onclick="sL('bio',1)">üü¢ Noob</button><button class="lb" onclick="sL('bio',2)">üü° Intermediate</button><button class="lb" onclick="sL('bio',3)">üî¥ Expert</button></div>
<div id="bio_b" class="sL1">

<div class="L1">
<h2>The Central Dogma: DNA ‚Üí RNA ‚Üí Protein</h2>
<div class="c ca">
<p><strong>DNA</strong> is the instruction manual in every cell. It's a long string of 4 chemical letters: A (adenine), T (thymine), C (cytosine), G (guanine). Your entire genome is ~3 billion letters long.</p>
<p><strong>A gene</strong> is one chapter ‚Äî a stretch of DNA that encodes instructions for one protein. Humans have ~20,000 genes. The NOD2 gene is one of them ‚Äî it lives on chromosome 16.</p>
<p><strong>Transcription:</strong> The cell copies a gene's DNA into messenger RNA (mRNA). Think of it as photocopying one page of the manual.</p>
<p><strong>Translation:</strong> Ribosomes read the mRNA and build a chain of amino acids. Every 3 mRNA letters = 1 amino acid. There are 20 different amino acids.</p>
<p><strong>Protein folding:</strong> The amino acid chain folds into a specific 3D shape. This shape determines what the protein DOES. A misfolded protein = a broken machine.</p>
<p><strong>A drug</strong> is a small molecule (typically 200-500 atoms) that physically fits into a cavity on the protein's surface ‚Äî like a key in a lock ‚Äî to change what the protein does (block it, activate it, stabilize it).</p>
</div>

<div class="ky">
<strong>Key insight for judges:</strong> Your poster figures (PyMOL, VMD) show the PROTEIN's 3D structure, not DNA. Everything you docked drugs into is the folded protein. You never directly worked with DNA sequences ‚Äî you worked with the protein that the DNA encodes.
</div>

<h2>What is a Mutation?</h2>
<div class="c co">
<p>A <strong>mutation</strong> is a typo in the DNA. One letter changes ‚Üí one amino acid in the protein might change ‚Üí the protein's shape or function might change.</p>
<p>Your mutation: At position 702 of the NOD2 gene, the DNA encodes ${au('tryptophan','Tryptophan')} (W) instead of ${au('arginine','Arginine')} (R). This is called <strong>${au('R702W','R702W')}</strong> ‚Äî "R at position 702 changed to W."</p>
<p>Not all mutations are harmful. Some are neutral. Some are beneficial. R702W happens to be harmful because it weakens NOD2's ability to detect bacteria.</p>
</div>

<h2>What is NOD2? ${au('NOD2','NOD2')}</h2>
<div class="c cc">
<p><strong>NOD2</strong> = Nucleotide-binding Oligomerization Domain-containing protein 2.</p>
<p>It's a <strong>security guard</strong> inside your intestinal cells. Its job: detect bacterial invaders by recognizing a molecule called ${au('MDP','MDP')} (${au('muramyl_dipeptide','Muramyl Dipeptide')}) ‚Äî a fragment of bacterial cell walls that's present in virtually all bacteria.</p>
<p>When MDP binds NOD2 ‚Üí NOD2 activates ‚Üí immune system turns on ‚Üí bacteria get cleared. Simple and effective.</p>
</div>

<h2>What is Crohn's Disease? ${au('crohns',"Crohn's")}</h2>
<div class="c cr">
<p>A painful, incurable inflammatory bowel disease affecting over <span class="n">1 million</span> Americans. Symptoms: chronic abdominal pain, diarrhea, weight loss, fatigue. Can require surgery to remove damaged intestine.</p>
<p><strong>The counterintuitive paradox:</strong> Crohn's isn't caused by TOO MUCH immunity ‚Äî it's caused by TOO LITTLE initial bacterial detection. When NOD2 can't detect bacteria properly, the bacteria aren't cleared quickly. The body compensates with a massive, chronic inflammatory response that never shuts off. It's like a fire alarm that doesn't go off, so the fire smolders until the whole building's sprinkler system activates permanently.</p>
<p>You receive <strong>Remicade</strong> (infliximab) infusions 2-4√ó per month at Texas Children's Hospital. Remicade blocks TNF-Œ± (a downstream inflammatory molecule) ‚Äî it treats the SYMPTOM (inflammation) but not the CAUSE (defective NOD2).</p>
</div>

<h2>The R702W Mutation ‚Äî YOUR Mutation ${au('R702W','R702W')}</h2>
<div class="c cp">
<p>At position 702, ${au('arginine','Arginine')} (R) ‚Üí ${au('tryptophan','Tryptophan')} (W).</p>
<p>This is in the <strong>HD2 domain</strong> (residues 640-744) ‚Äî NOT the ${au('LRR','LRR')} binding pocket (residues 744-1040) where drugs bind.</p>
<p>Distance between mutation and binding pocket: <span class="n">79.4 √Ö</span> ${au('angstrom','Angstrom')}. That's enormous at molecular scale ‚Äî like a dent on one end of a car affecting the engine on the other end.</p>
<p>~<span class="n">10%</span> of Crohn's patients carry this variant. It increases disease risk by ~<span class="n">2-fold</span>.</p>
</div>
</div>

<div class="L2">
<h2>The Complete NOD2 Signaling Pathway (Figure 1)</h2>
<div class="c">
<p>Memorize this cascade ‚Äî judges will ask about it. Each step has a specific molecular mechanism:</p>
<ol>
<li><strong>Bacteria enter the gut lumen</strong> ‚Üí cross the epithelial barrier ‚Üí cell wall fragments (${au('MDP','MDP')}) are released as bacteria are digested</li>
<li><strong>MDP is transported into the cell</strong> by peptide transporters (SLC15A3/SLC15A4) in the endosomal membrane</li>
<li><strong>MDP binds NOD2's ${au('LRR','LRR')} domain</strong> (residues 744-1040). The LRR forms a horseshoe shape ‚Äî MDP fits into the concave face.</li>
<li><strong>NOD2 undergoes conformational change</strong> ‚Üí the auto-inhibitory interaction between LRR and NBD is released ‚Üí NOD2 can now oligomerize (form dimers/trimers)</li>
<li><strong>NOD2's CARD domain</strong> (residues 1-120) is now exposed ‚Üí recruits ${au('RIPK2','RIPK2')} (Receptor Interacting Protein Kinase 2) through CARD-CARD interactions</li>
<li><strong>RIPK2 auto-phosphorylates</strong> ‚Üí activates ${au('TAK1','TAK1')} complex (TAK1 + TAB1 + TAB2 + TAB3)</li>
<li><strong>TAK1 phosphorylates IKKŒ≤</strong> in the IKK complex (IKKŒ± + IKKŒ≤ + NEMO/IKKŒ≥)</li>
<li><strong>IKKŒ≤ phosphorylates IŒ∫BŒ±</strong> (the inhibitor) ‚Üí IŒ∫BŒ± gets ubiquitinated ‚Üí degraded by the 26S proteasome</li>
<li><strong>${au('NF_kappa_B','NF-Œ∫B')} is released</strong> (it was being held hostage by IŒ∫BŒ±) ‚Üí translocates into the nucleus</li>
<li><strong>NF-Œ∫B binds promoter regions</strong> of inflammatory genes ‚Üí turns on IL-8, TNF-Œ±, IL-6, defensins, antimicrobial peptides</li>
<li><strong>Cytokines are secreted</strong> ‚Üí recruit neutrophils, macrophages, dendritic cells ‚Üí <strong>bacteria are cleared</strong></li>
<li><strong>Negative feedback</strong>: A20 and other regulators shut down NF-Œ∫B signaling ‚Üí inflammation resolves</li>
</ol>
<p><strong>When R702W breaks step 3-4:</strong> Weaker MDP sensing ‚Üí less RIPK2 recruitment ‚Üí less NF-Œ∫B activation ‚Üí insufficient initial bacterial clearance ‚Üí chronic compensatory inflammation via alternative pathways (TLRs, inflammasome) ‚Üí Crohn's disease.</p>
</div>

<h2>NOD2 Domain Architecture</h2>
<div class="c cc">
<table>
<tr><th>Domain</th><th>Residues</th><th>Function</th><th>Relevance</th></tr>
<tr><td><strong>CARD</strong></td><td>1-120</td><td>Recruits RIPK2</td><td>Downstream signaling; not targeted by your drugs</td></tr>
<tr><td><strong>NBD/NACHT</strong></td><td>273-577</td><td>ATPase, self-oligomerization</td><td>Requires ATP binding to oligomerize after MDP detection</td></tr>
<tr><td><strong>HD1</strong></td><td>577-640</td><td>Helical domain 1</td><td>Structural linker</td></tr>
<tr><td><strong>HD2</strong></td><td>640-744</td><td>Helical domain 2</td><td><strong>R702W is HERE</strong> ‚Äî allosteric relay point</td></tr>
<tr><td><strong>LRR</strong></td><td>744-1040</td><td>Ligand recognition</td><td><strong>Drugs bind HERE</strong> ‚Äî your docking/MD/FEP target</td></tr>
</table>
</div>

<h2>Why R702W Weakens NOD2 ‚Äî Molecular Detail</h2>
<div class="c co">
<p><strong>${au('arginine','Arginine')} (R)</strong> has a long, flexible, positively-charged side chain (guanidinium group, pKa ~12.5). It forms:</p>
<ul>
<li>Salt bridges with negatively charged residues (ASP, GLU)</li>
<li>Up to 5 hydrogen bonds simultaneously (2 from guanidinium NH‚ÇÇ groups)</li>
<li>Cation-œÄ interactions with aromatic residues</li>
</ul>
<p>These interactions create a <strong>network of contacts</strong> that allows the HD2 domain to flex appropriately when MDP binds ‚Äî like a hinge that needs to be lubricated.</p>
<p><strong>${au('tryptophan','Tryptophan')} (W)</strong> is the largest amino acid ‚Äî a bulky, flat, hydrophobic indole ring. It:</p>
<ul>
<li>Cannot form the same salt bridges (no positive charge)</li>
<li>Forms fewer H-bonds (only 1 from indole NH)</li>
<li>Creates steric clashes with neighbors due to its large ring</li>
<li>Introduces hydrophobic packing where there should be charged interactions</li>
</ul>
<p>Result: The hinge becomes <strong>stiff</strong>. The conformational signal from MDP binding in the LRR can't propagate properly through HD2 to reach the NBD/CARD domains. NOD2 fails to fully activate.</p>
</div>
</div>

<div class="L3">
<h2>The Allosteric Mechanism ‚Äî Your Key Discovery ${au('allosteric','Allosteric')}</h2>
<div class="c cg">
<p>Your MD simulations provided the first computational evidence for HOW R702W affects NOD2 function at the atomic level:</p>
<table>
<tr><th>Metric</th><th>Wild-Type</th><th>R702W</th><th>Œî</th><th>Interpretation</th></tr>
<tr><td>${au('RMSD','RMSD')} (avg)</td><td class="n">4.05 √Ö</td><td class="n">3.27 √Ö</td><td class="n">‚àí0.78 √Ö</td><td>R702W moves less ‚Äî more rigid backbone</td></tr>
<tr><td>RMSD std dev</td><td class="n">~1.0 √Ö</td><td class="n">~0.4 √Ö</td><td class="n">‚àí0.6 √Ö</td><td>WT has 2.5√ó wider dynamic range</td></tr>
<tr><td>Frames >5√Ö</td><td class="n">12.6%</td><td class="n">0%</td><td class="n">‚àí12.6%</td><td>WT explores large conformations; R702W NEVER does</td></tr>
</table>

<h3>The Mechanistic Model</h3>
<p>1. <strong>Local effect:</strong> R‚ÜíW at 702 disrupts the salt bridge + H-bond network in HD2. Specifically, R702 normally forms a salt bridge with D701 and H-bonds with backbone carbonyls of residues 698-700. W702 can't form these ‚Üí local destabilization paradoxically leads to global rigidification (the protein "locks" into a low-energy conformation instead of sampling multiple states).</p>
<p>2. <strong>Propagation:</strong> HD2 connects to LRR via a helical linker (residues 740-750). The rigidification propagates through this interface ‚Äî reduced HD2 flexibility ‚Üí reduced LRR breathing motions ‚Üí altered binding pocket dynamics.</p>
<p>3. <strong>Pocket effect:</strong> The LRR pocket in R702W is conformationally narrower. Drugs that depend on specific electrostatic contacts (Febuxostat ‚Üî ASP1011) lose those contacts because the pocket can't adapt. Drugs with robust hydrophobic contacts (Bufadienolide) are less affected because hydrophobic interactions are shape-tolerant.</p>
<p>4. <strong>Distance:</strong> <span class="n">79.4 √Ö</span> ‚Äî this is textbook ${au('allosteric','allostery')}. Compare: hemoglobin's allosteric effect spans ~25 √Ö. Yours is 3√ó further, making it a particularly dramatic example.</p>
</div>

${ex('j','If a judge asks: "How do you know it\'s allosteric and not just noise?"',`
<p>"Three lines of evidence. First, the RMSD difference is systematic ‚Äî it's not one frame, it's the ENTIRE 20-nanosecond trajectory across all 3 replicates. Wild-type consistently samples wider conformations. Second, the 0% vs 12.6% for frames exceeding 5 Angstroms is binary ‚Äî the mutant NEVER reaches conformations that the wild-type regularly visits. Third, the functional consequence is measurable: Febuxostat's ŒîŒîG of +2.34 kcal/mol at 8 sigma significance directly quantifies how the pocket-level changes translate into binding differences. Random noise wouldn't produce 8 sigma."</p>
`)}

<h2>What You Are Actually Doing ‚Äî Precise Statement</h2>
<div class="ky">
<p>You are performing <strong>computational drug repurposing</strong> (FDA drugs) and <strong>natural product screening</strong> against the NOD2 LRR domain, using a multi-stage pipeline (CNN docking ‚Üí ML classification ‚Üí ADMET ‚Üí MD ‚Üí FEP) to identify compounds that bind the LRR pocket and potentially restore NOD2-mediated immune signaling.</p>
<p>The novel contribution is using ${au('FEP','FEP')} to quantify how the R702W mutation <em>differentially</em> affects binding affinity across compound classes ‚Äî discovering that mutation effects are <strong>ligand-dependent</strong>, not universal.</p>
<p>This is the basis for ${au('pharmacogenomics','pharmacogenomic')}-guided NOD2 therapeutics: choosing the right drug based on the patient's genotype.</p>
</div>
</div>
</div>
`},


// ============ PIPELINE OVERVIEW ============
{id:'pipe',icon:'üî¨',label:'Pipeline Overview',ct:`
<h1>The 9,566 ‚Üí 2 Pipeline</h1>
<p class="sub">Every stage of your drug discovery pipeline, what it does, and why it's in that order.</p>
<div class="lv" id="lv_pipe"><button class="lb on" onclick="sL('pipe',1)">üü¢ Noob</button><button class="lb" onclick="sL('pipe',2)">üü° Intermediate</button><button class="lb" onclick="sL('pipe',3)">üî¥ Expert</button></div>
<div id="pipe_b" class="sL1">

<div class="L1">
<h2>The Funnel</h2>
<div class="c ca">
<p>Drug discovery is a funnel. You start with thousands of candidates and progressively filter them down. Each stage is more expensive and more accurate than the last:</p>
<table>
<tr><th>Stage</th><th>In</th><th>Out</th><th>Time/compound</th><th>Purpose</th></tr>
<tr><td>1. Library Assembly</td><td>‚Äî</td><td class="n">9,566</td><td>seconds</td><td>Collect all candidate molecules</td></tr>
<tr><td>2. GNINA Docking</td><td class="n">9,566</td><td class="n">9,566 scored</td><td>~2 min</td><td>Score how well each fits the pocket</td></tr>
<tr><td>3. NOD2-Scout ML</td><td class="n">9,566</td><td class="n">2,129</td><td>milliseconds</td><td>Learn binding patterns, filter weak binders</td></tr>
<tr><td>4. ADMET Filtering</td><td class="n">150*</td><td class="n">148</td><td>seconds</td><td>Remove toxic/unabsorbable compounds</td></tr>
<tr><td>5. Expert Curation</td><td class="n">148</td><td class="n">8</td><td>hours (manual)</td><td>Pick structurally diverse, interesting leads</td></tr>
<tr><td>6. MD Simulation</td><td class="n">5</td><td class="n">2</td><td>~8 hrs GPU</td><td>Confirm drug stays in pocket over time</td></tr>
<tr><td>7. FEP Validation</td><td class="n">2</td><td class="n">2 characterized</td><td>~48 hrs GPU</td><td>Quantify exact binding energy difference</td></tr>
</table>
<p><small>*150 after additional clustering step between ML and ADMET</small></p>
</div>

<div class="ky">
<strong>Why this order matters:</strong> Cheap/fast methods first (docking: 2 min/compound), expensive/slow methods last (FEP: 48 hrs/compound). If you ran FEP on all 9,566 compounds it would take ~19,000 GPU-days. The pipeline reduces this to ~4 GPU-days total.
</div>
</div>

<div class="L2">
<h2>Compound Libraries ‚Äî Where the 9,566 Came From</h2>
<div class="c cc">
<h3>FDA-Approved Drugs: e-Drug3D ‚Äî <span class="n">2,152</span> compounds</h3>
<p>Why FDA drugs? They already have safety data, manufacturing processes, and clinical history. If one binds NOD2, it could be <strong>repurposed</strong> ‚Äî prescribed off-label immediately. No 10-year development needed.</p>
<p>e-Drug3D provides 3D structures of all FDA-approved small molecules. You downloaded the SDF file and converted to PDBQT format for GNINA.</p>

<h3>Natural Products: COCONUT ‚Äî <span class="n">7,414</span> compounds</h3>
<p>Why natural products? Evolution has been optimizing these molecules for billions of years. Many successful drugs came from nature (aspirin from willow bark, penicillin from mold, taxol from yew trees). Natural products have diverse scaffolds not found in synthetic libraries.</p>
<p>COCONUT (COlleCtion of Open Natural prodUcTs) is the largest open database of natural products. You filtered for drug-like properties before docking.</p>
</div>

<h2>What About the Databases That Failed?</h2>
<div class="c cr">
<p>Before finding e-Drug3D and COCONUT, you tried:</p>
<table>
<tr><th>Database</th><th>Problem</th><th>What You Learned</th></tr>
<tr><td><strong>ZINC15</strong></td><td>Download links broken, server timeouts</td><td>Large academic databases have reliability issues</td></tr>
<tr><td><strong>DrugBank</strong></td><td>Required institutional access, complex API</td><td>Paywalls block high school researchers</td></tr>
<tr><td><strong>ChEMBL</strong></td><td>No NOD2-specific binding data existed</td><td>Confirmed: nobody has screened drugs against NOD2 before</td></tr>
</table>
<p>The ChEMBL failure is actually important ‚Äî it confirms your work is <strong>novel</strong>. No experimental NOD2 binding data exists for any compound.</p>
</div>
</div>

<div class="L3">
<h2>Structure Preparation ‚Äî AlphaFold2 ${au('AlphaFold','AlphaFold')}</h2>
<div class="c cg">
<p>Before you can dock anything, you need the protein's 3D structure. Normally this comes from X-ray crystallography or cryo-EM. Problem: <strong>No complete NOD2 crystal structure exists.</strong></p>
<p><strong>PDB: 5IRM</strong> ‚Äî only covers CARD + NBD domains (residues 1-577). Missing HD1, HD2, and the entire LRR where you need to dock. Useless for your project.</p>
<p><strong>Solution: ${au('AlphaFold','AlphaFold2')}</strong> predicted the full-length NOD2 structure (1,040 residues). Confidence score (${au('pLDDT','pLDDT')}) for the LRR domain: <span class="n">>90</span> ‚Äî this is "very high confidence," comparable to experimental structures.</p>
<p><strong>Preparation steps:</strong></p>
<ol>
<li>Download AlphaFold2 prediction from UniProt (Q9HC29)</li>
<li>Extract LRR domain (residues 744-1040) ‚Äî this is where drugs bind</li>
<li>Add hydrogens at pH 7.4 (physiological) using PDB2PQR</li>
<li>Assign partial charges using AMBER ff14SB</li>
<li>Convert to PDBQT format for GNINA input</li>
</ol>
</div>

${ex('j','Judge asks: "Why not use experimental structure?"',`
<p>"No complete crystal structure of human NOD2 exists. The closest experimental structure, PDB 5IRM, covers only the CARD and NBD domains ‚Äî residues 1 through 577. The LRR domain where our compounds bind spans residues 744 to 1040, which is entirely absent from 5IRM. AlphaFold2 predicted full-length NOD2 with pLDDT scores above 90 in the LRR region, indicating very high confidence comparable to approximately 2-Angstrom experimental resolution. We acknowledge this is a limitation and plan to validate with experimental structures when they become available."</p>
`)}

<h2>Ligand Preparation</h2>
<div class="c">
<p>Each compound needs a 3D structure with correct chemistry:</p>
<ol>
<li>Parse SMILES strings from database files</li>
<li>Generate 3D coordinates with RDKit's <code>AllChem.EmbedMolecule(mol, AllChem.ETKDGv3())</code></li>
<li>Energy minimize with MMFF94 force field (500 steps)</li>
<li>Assign Gasteiger partial charges</li>
<li>Convert to PDBQT format via Open Babel</li>
</ol>
<p><span class="n">9,566</span> compounds prepared. ~200 failed (invalid SMILES, 3D generation failure) ‚Äî excluded from pipeline.</p>
</div>
</div>
</div>
`},


// ============ GNINA DOCKING ============
{id:'dock',icon:'‚öôÔ∏è',label:'GNINA Docking',ct:`
<h1>GNINA CNN-Based Molecular Docking ${au('GNINA','GNINA')}</h1>
<p class="sub">How you scored 9,566 compounds against NOD2's binding pocket using deep learning.</p>
<div class="lv" id="lv_dock"><button class="lb on" onclick="sL('dock',1)">üü¢ Noob</button><button class="lb" onclick="sL('dock',2)">üü° Intermediate</button><button class="lb" onclick="sL('dock',3)">üî¥ Expert</button></div>
<div id="dock_b" class="sL1">

<div class="L1">
<h2>What is Molecular Docking? ${au('docking','Molecular Docking')}</h2>
<div class="c ca">
<p>Imagine you have a lock (the protein's ${au('binding_pocket','binding pocket')}) and 9,566 keys (drug molecules). Docking = trying each key in the lock, in thousands of orientations, and scoring how well it fits.</p>
<p>For each compound, the computer:</p>
<ol>
<li><strong>Places</strong> the drug molecule near the binding pocket</li>
<li><strong>Rotates</strong> it through hundreds of orientations (think: every angle the key could go in)</li>
<li><strong>Flexes</strong> it ‚Äî real molecules bend at their rotatable bonds</li>
<li><strong>Scores</strong> each pose: "How much energy is released if the drug sits exactly like this?"</li>
<li><strong>Keeps</strong> the best poses (lowest energy = best fit)</li>
</ol>
<p>Lower energy = tighter binding = better drug candidate. A score of ‚àí7 kcal/mol is better than ‚àí4 kcal/mol.</p>
</div>

<h2>What Makes GNINA Special?</h2>
<div class="vs">
<div class="vl"><h3 style="color:var(--red)">‚ùå AutoDock Vina (Classical)</h3>
<p>Uses hand-coded physics equations from 2010. The scoring function is a weighted sum of 5 terms: steric complementarity + H-bonds + hydrophobic contacts + torsional penalty + desolvation.</p>
<p>Problem: Weights were fitted to ~1,300 protein-ligand complexes in 2010 and never updated. Misses complex binding patterns. Like using a calculator when you could use a neural network.</p>
<p>You tried installing Vina first ‚Äî download links were broken, Windows .exe wouldn't run in WSL.</p></div>
<div class="vw"><h3 style="color:var(--grn)">‚úÖ GNINA ${au('GNINA','GNINA')} (Deep Learning)</h3>
<p>Uses a ${au('CNN','Convolutional Neural Network')} trained on <strong>PDBBind</strong> ‚Äî over 20,000 experimentally solved protein-ligand crystal structures with measured binding affinities.</p>
<p>The CNN takes the 3D structure of the protein-ligand complex as input (represented as a 3D grid of atomic densities) and predicts: (1) pose quality, and (2) binding affinity.</p>
<p>It LEARNED from real data what good binding looks like. Like training a doctor on 20,000 X-rays instead of giving them a textbook formula.</p></div>
</div>
</div>

<div class="L2">
<h2>How CNN Scoring Works Inside GNINA</h2>
<div class="c cc">
<p>Step by step, here's what happens when GNINA scores one pose:</p>
<ol>
<li><strong>3D Grid Construction:</strong> A 24√ó24√ó24 √Ö box is placed around the ligand pose. Each grid point (every 0.5 √Ö) stores atomic density features ‚Äî atom type (C, N, O, S, etc.), hybridization, partial charge, whether it's protein or ligand.</li>
<li><strong>Multi-Channel Input:</strong> Like a color image has RGB channels, the grid has ~36 channels (18 protein atom types + 18 ligand atom types). This becomes a 48√ó48√ó48√ó36 tensor.</li>
<li><strong>Convolutional Layers:</strong> 3D convolutions slide over the grid, detecting local patterns ‚Äî H-bond geometries, aromatic stacking, hydrophobic clustering. Early layers detect simple contacts; deeper layers detect complex binding motifs.</li>
<li><strong>Dense Layers + Output:</strong> Flattened features ‚Üí fully connected layers ‚Üí two outputs: <strong>CNN_score</strong> (pose quality, 0-1) and <strong>CNN_affinity</strong> (predicted pKd in log units).</li>
</ol>
<p>GNINA then combines CNN scoring with Vina's physics-based search algorithm. Vina generates diverse poses; CNN evaluates them. Best of both worlds.</p>
</div>

<h2>Your Exact Docking Parameters</h2>
<table>
<tr><th>Parameter</th><th>Value</th><th>Why This Value</th></tr>
<tr><td><strong>Receptor</strong></td><td>human_NOD2_LRR.pdbqt</td><td>${au('AlphaFold','AlphaFold2')}-predicted, LRR domain only (744-1040). ~4,500 atoms.</td></tr>
<tr><td><strong>Grid center</strong></td><td>(12.5, ‚àí3.2, 8.7)</td><td>Geometric centroid of the LRR binding pocket, computed from key residue positions.</td></tr>
<tr><td><strong>Grid size</strong></td><td class="n">30 √ó 30 √ó 30 √Ö</td><td>Must enclose entire pocket + room for large ligands. Bufadienolide (MW 386) has ~15 √Ö longest axis ‚Äî needs clearance on all sides to find optimal orientation.</td></tr>
<tr><td><strong>Exhaustiveness</strong></td><td class="n">32</td><td>4√ó default (8). Each "exhaustiveness unit" = one independent Monte Carlo search starting from a random pose. More = more thorough exploration of conformational space. GPU makes 32 feasible (~2 min/compound vs ~8 min on CPU).</td></tr>
<tr><td><strong>num_modes</strong></td><td class="n">9</td><td>Keep top 9 poses per compound. More than 1 in case the best pose is an artifact ‚Äî can examine alternatives.</td></tr>
<tr><td><strong>CNN model</strong></td><td>default_ensemble</td><td>GNINA's built-in ensemble of 5 CNN models. Averaging reduces variance.</td></tr>
<tr><td><strong>Output scores</strong></td><td class="n">2.47 ‚Äì 7.34</td><td>CNN affinity range across 9,566 compounds. Mean: 4.57. Higher = predicted stronger binding.</td></tr>
</table>

${ex('w','Why grid size 30√ó30√ó30, not smaller or larger?',`
<p><strong>Too small (15√ó15√ó15):</strong> Clips the pocket edges. Large ligands like Bufadienolide (MW 386, ~15 √Ö longest axis) can't rotate freely. You'd get artificially low scores for legitimate binders ‚Äî missing your best lead compound.</p>
<p><strong>Too large (50√ó50√ó50):</strong> GNINA wastes time exploring irrelevant surface crevices far from the pocket. Increases compute by ~5√ó with no accuracy gain. More poses in non-pocket regions dilute the signal.</p>
<p><strong>30√ó30√ó30 is standard:</strong> Captures the full LRR concave face (~20 √Ö across) with 5 √Ö padding on each side. Matches recommendations in the GNINA documentation and published benchmarks.</p>
`)}

${ex('w','Why exhaustiveness 32 instead of the default 8?',`
<p>Exhaustiveness controls how many independent searches GNINA runs per compound. Each search starts from a random initial pose and optimizes via Monte Carlo + local minimization.</p>
<p><strong>At 8 (default):</strong> Fine for rigid, small ligands. But flexible molecules (many rotatable bonds) and large pockets have vast conformational space. 8 random starts may all converge to the same local minimum, missing the global minimum.</p>
<p><strong>At 32:</strong> 4√ó more starting points = much better coverage. For 9,566 compounds, this is the difference between "screening-quality" and "hit-quality" docking. Pharma companies typically use 32-128.</p>
<p><strong>Why not 128?</strong> Diminishing returns. Going from 8‚Üí32 catches ~90% of missed poses. 32‚Üí128 catches maybe 5% more. Not worth the 4√ó compute increase for a first-pass screen.</p>
`)}
</div>

<div class="L3">
<h2>Your Actual Bash Command</h2>
<pre><span class="cmt"># The for-loop that replaced the failed wildcard approach</span>
<span class="kw">for</span> f <span class="kw">in</span> ligands/*.pdbqt; <span class="kw">do</span>
  gnina -r human_NOD2_LRR.pdbqt \\
        -l <span class="str">"$f"</span> \\
        --center_x 12.5 --center_y -3.2 --center_z 8.7 \\
        --size_x 30 --size_y 30 --size_z 30 \\
        --exhaustiveness 32 \\
        --num_modes 9 \\
        -o <span class="str">"results/$(basename $f .pdbqt)_docked.sdf"</span>
<span class="kw">done</span></pre>

<p>Let's break this down line by line:</p>
<div class="c">
<p><code>for f in ligands/*.pdbqt; do</code> ‚Äî Shell for-loop iterating over every .pdbqt file in the ligands directory. <code>$f</code> holds the current filename.</p>
<p><code>-r human_NOD2_LRR.pdbqt</code> ‚Äî <strong>Receptor</strong> file. The protein structure in PDBQT format (PDB + partial charges + atom types).</p>
<p><code>-l "$f"</code> ‚Äî <strong>Ligand</strong> file. One compound at a time. Quotes around <code>$f</code> handle filenames with spaces.</p>
<p><code>--center_x/y/z</code> ‚Äî Grid box center coordinates in √Öngstr√∂ms. Pre-computed as the centroid of key pocket residues.</p>
<p><code>--size_x/y/z 30</code> ‚Äî Grid box dimensions. 30 √Ö on each side = 27,000 ≈≥ search volume.</p>
<p><code>--exhaustiveness 32</code> ‚Äî 32 independent Monte Carlo searches per compound.</p>
<p><code>--num_modes 9</code> ‚Äî Save top 9 scoring poses per compound.</p>
<p><code>-o "results/..."</code> ‚Äî Output as SDF (structure-data file) containing all poses with scores.</p>
</div>

${ex('x','ARG_MAX Crash ‚Äî Dec 2, 2025',`
<p><strong>What happened:</strong> First attempt was <code>gnina -l ligands/*.pdbqt</code> ‚Äî passing ALL 9,566 filenames as a single shell wildcard expansion.</p>
<p><strong>Why it crashed:</strong> Linux kernel has <code>ARG_MAX</code> limit (~2 MB or ~131,072 bytes on most systems) on total command-line argument length. 9,566 filenames √ó ~30 chars each = ~287,000 bytes ‚Äî exceeded the limit.</p>
<p><strong>Confusing symptom:</strong> GNINA didn't print an error message. It just printed the help menu and exited with code 0 (success!). You had to figure out WHY a valid-looking command produced no output.</p>
<p><strong>Debug process:</strong> Tested with 10 files ‚Üí worked. 100 ‚Üí worked. 1000 ‚Üí worked. 5000 ‚Üí failed. Realized it was the argument length, not GNINA itself.</p>
<p><strong>Fix:</strong> Shell for-loop (above) processes one file at a time. Each iteration has only 2 filenames on the command line ‚Äî well under ARG_MAX.</p>
<p><strong>Second crash:</strong> You then accidentally closed the terminal while docking was running (lost ~2 hours of progress). After that, learned to use <code>nohup gnina ... &</code> and <code>screen</code> sessions to keep processes alive after terminal disconnect.</p>
`)}

${ex('x','GPU at 1% Utilization ‚Äî Dec 3',`
<p><strong>What happened:</strong> Ran GNINA, checked <code>nvidia-smi</code> ‚Äî GPU (RTX 4060 Ti) at 1% utilization. Everything running on CPU (10-50√ó slower).</p>
<p><strong>Why:</strong> GNINA's CNN inference requires CUDA runtime libraries (<code>libcudart.so</code>, <code>libcudnn.so</code>). WSL2 doesn't always expose these to the container PATH.</p>
<p><strong>Diagnosis:</strong> <code>ldd $(which gnina) | grep cuda</code> showed "not found" for CUDA libs.</p>
<p><strong>Fix:</strong> <code>export LD_LIBRARY_PATH=/usr/local/cuda/lib64:$LD_LIBRARY_PATH</code> in <code>~/.bashrc</code>. GPU utilization jumped to ~40-60%. Docking speed: ~2 min/compound ‚Üí total wall time ~13 hours for all 9,566.</p>
`)}

${ex('i','What if you docked the full protein instead of just LRR?',`
<p>The binding pocket is in the LRR domain. Including the full 1,040-residue protein (vs 296 LRR residues) would:</p>
<ul>
<li>Add ~12,000 atoms of non-relevant protein surface</li>
<li>Require a much larger grid box (~60√ó60√ó60 √Ö minimum)</li>
<li>GNINA would find "binding sites" in CARD, NBD, HD domains that have no therapeutic relevance</li>
<li>Increase compute ~8√ó (larger grid = more poses to evaluate)</li>
<li>Dilute real signal with false positives from irrelevant sites</li>
</ul>
<p>Focusing on LRR (residues 744-1040) is standard practice in computational drug discovery ‚Äî dock where the biology happens, not the whole protein.</p>
`)}

${ex('l','How you learned about docking',`
<p>Started with YouTube tutorials on AutoDock Vina (most popular, lots of beginner content). When Vina installation failed on Windows, searched for GPU-accelerated alternatives. Found GNINA through a 2021 benchmarking paper (McNutt et al., <em>J. Cheminformatics</em>) comparing docking programs ‚Äî GNINA outperformed Vina on every metric.</p>
<p>Gemini helped with WSL2 installation (apt-get dependencies, CUDA toolkit setup). Claude helped debug the ARG_MAX batch processing crash. Read the GNINA GitHub README and the original 2020 paper (Sunseri & Koes) during a Remicade infusion.</p>
`)}
</div>
</div>
`},


// ============ NOD2-SCOUT ML ============
{id:'ml',icon:'ü§ñ',label:'NOD2-Scout ML',ct:`
<h1>NOD2-Scout ‚Äî XGBoost Classifier ${au('XGBoost','XGBoost')}</h1>
<p class="sub">Your machine learning model that learned binding patterns from docking data.</p>
<div class="lv" id="lv_ml"><button class="lb on" onclick="sL('ml',1)">üü¢ Noob</button><button class="lb" onclick="sL('ml',2)">üü° Intermediate</button><button class="lb" onclick="sL('ml',3)">üî¥ Expert</button></div>
<div id="ml_b" class="sL1">

<div class="L1">
<h2>What is Machine Learning?</h2>
<div class="c ca">
<p>Teaching a computer to find patterns in data without writing explicit rules.</p>
<p>Think about how you learn to recognize cats. Nobody gives you a formula: "width/height ratio > 0.8 AND pointy ears AND whiskers." Instead, you see thousands of cat photos and your brain learns the pattern. ML does the same thing with data.</p>
</div>

<h2>What is a Decision Tree?</h2>
<div class="c cc">
<p>A flowchart of yes/no questions that splits data:</p>
<pre style="background:transparent;border:none;color:var(--txt);padding:0">
                   Is LogP > 3?
                  /            \\
               Yes              No
              /                  \\
      Is TPSA < 80?         Predict: NON-BINDER
       /        \\
    Yes          No
     /             \\
Has aromatic    Predict: NON-BINDER
  ring?
  / \\
Yes  No
 /     \\
BINDER  NON-BINDER
</pre>
<p>Each question splits the data into groups that are more "pure" (all binders or all non-binders). The tree learns which questions to ask and what thresholds to use from the training data.</p>
<p>Problem: A single tree is noisy and overfits. It memorizes the training data instead of learning general patterns.</p>
</div>

<h2>What is XGBoost? ${au('XGBoost','XGBoost')}</h2>
<div class="c ca">
<p><strong>Extreme Gradient Boosting.</strong> Instead of one tree, build <span class="n">100</span> trees <em>sequentially</em>:</p>
<ol>
<li>Tree 1 makes predictions. Gets 70% right, 30% wrong.</li>
<li>Tree 2 focuses specifically on the 30% that Tree 1 got wrong. (This is the "gradient" part ‚Äî it fits to the errors/residuals of the previous tree.)</li>
<li>Tree 3 focuses on the remaining errors from Trees 1+2.</li>
<li>...continue for 100 trees.</li>
<li>Final prediction = weighted sum of all 100 trees' predictions.</li>
</ol>
<p>"Boosting" = each new tree corrects the mistakes of all previous trees. "Gradient" = it uses calculus (gradient descent) to minimize the error optimally.</p>
<p>Like asking 100 specialists, each one an expert on the cases the previous doctors missed.</p>
</div>

<h2>The Labeling Problem ‚Äî ${au('pseudo_label','Pseudo-Labels')}</h2>
<div class="c co">
<p><strong>Problem:</strong> ML needs labeled data: "this compound binds NOD2" or "this doesn't." But NOBODY has experimentally measured NOD2 binding for ANY of these compounds. There are zero experimental labels.</p>
<p><strong>Solution: Pseudo-labeling from docking scores.</strong></p>
<ul>
<li>Top 10% by GNINA CNN affinity ‚Üí "likely binder" (label = 1)</li>
<li>Bottom 10% by GNINA CNN affinity ‚Üí "likely non-binder" (label = 0)</li>
<li>Middle 80% ‚Üí excluded (ambiguous, would add noise)</li>
</ul>
<p>Result: ~<span class="n">858</span> labeled compounds for training. (Poster says top/bottom 25% ‚Üí 858.)</p>
<p><strong>Why this works:</strong> GNINA isn't perfect, but its CNN scores correlate with real binding. The top 10% are very likely true binders; bottom 10% are very likely non-binders. By throwing away the ambiguous middle, you get cleaner labels.</p>
</div>
</div>

<div class="L2">
<h2>Features ‚Äî How You Encode Molecules for ML</h2>
<div class="c cc">
<p>ML can't "see" a molecule. You need to convert each molecule into a vector of numbers. You used <span class="n">2,050</span> features total:</p>

<h3>${au('morgan_fingerprint','Morgan Fingerprints')} ‚Äî 2,048 bits</h3>
<p>For each atom in the molecule, look at everything within <strong>radius = 2 bonds</strong> (the atom itself + all atoms up to 2 bonds away). This defines a "local chemical environment." Hash each environment into a bit position (0 or 1) in a 2,048-length binary vector.</p>
<p>Example: If atom C has neighbors [C, O, N] within 2 bonds, this hashes to bit position 847 ‚Üí set bit 847 = 1. Different environments hash to different positions. The full 2,048-bit vector is a unique "barcode" for the molecule.</p>
<p><strong>Why radius 2?</strong> Radius 1 = too local (only immediate neighbors). Radius 3 = too many collisions (different environments hashing to same bit). Radius 2 is the sweet spot ‚Äî captures functional group-level chemistry.</p>
<p><strong>Why 2,048 bits?</strong> Larger vectors have fewer hash collisions (two different environments accidentally assigned to the same bit). 2,048 is standard in drug discovery; 1,024 has ~5% collision rate, 2,048 has ~2%.</p>

<h3>10 Physicochemical Descriptors</h3>
<table>
<tr><th>Feature</th><th>What It Measures</th><th>Range in Your Data</th><th>Why NOD2 Cares</th></tr>
<tr><td><strong>MW</strong></td><td>Molecular weight (Da)</td><td>100-900</td><td>Too big = can't enter cell. NOD2 is intracellular.</td></tr>
<tr><td><strong>LogP</strong></td><td>Octanol-water partition (lipophilicity)</td><td>-3 to 8</td><td>Must cross cell membrane (lipid bilayer). Needs moderate LogP (1-5).</td></tr>
<tr><td><strong>${au('TPSA','TPSA')}</strong></td><td>Topological polar surface area (√Ö¬≤)</td><td>0-250</td><td>High TPSA = can't cross membrane = never reaches NOD2. Cutoff: ‚â§140 √Ö¬≤.</td></tr>
<tr><td><strong>HBD</strong></td><td>H-bond donors</td><td>0-12</td><td>Each HBD must be desolvated (break H-bond with water) to cross membrane.</td></tr>
<tr><td><strong>HBA</strong></td><td>H-bond acceptors</td><td>0-20</td><td>Same principle ‚Äî each HBA has a desolvation penalty.</td></tr>
<tr><td><strong>RotBonds</strong></td><td>Rotatable bonds</td><td>0-20</td><td>Flexible molecules lose more ${au('entropy','entropy')} upon binding ‚Üí weaker binding.</td></tr>
<tr><td><strong>AromaticRings</strong></td><td>Aromatic ring count</td><td>0-6</td><td>Enable œÄ-stacking with TRP, PHE, TYR in the LRR pocket.</td></tr>
<tr><td><strong>FractionCSP3</strong></td><td>Sp3 carbon fraction</td><td>0-1</td><td>Higher = more 3D shape = better pocket complementarity. "Flat molecule syndrome" = low Fsp3.</td></tr>
<tr><td><strong>HeavyAtoms</strong></td><td>Non-hydrogen atoms</td><td>8-70</td><td>Size proxy. Correlates with MW but includes heteroatoms.</td></tr>
<tr><td><strong>NumRings</strong></td><td>Total ring count</td><td>0-8</td><td>Rigidity and scaffold complexity.</td></tr>
</table>
</div>

<h2>Scaffold Split ‚Äî Why Random Split is WRONG ${au('scaffold_split','Scaffold Split')}</h2>
<div class="c cg">
<p>This is the <strong>most important methodological decision</strong> in your ML pipeline. It's the difference between honest and fake results.</p>
<div class="vs">
<div class="vl"><h3 style="color:var(--red)">‚ùå Random Split</h3>
<p>Randomly assign 80% to train, 20% to test. Problem: Structurally similar molecules (same scaffold) land in BOTH sets.</p>
<p>Example: Molecule A (scaffold X, good binder) in train. Molecule B (scaffold X, slightly different substituent, also good binder) in test. Model sees scaffold X in training ‚Üí memorizes "scaffold X = binder" ‚Üí gets B right in test ‚Üí AUC = <span class="n">0.998</span>.</p>
<p>This is ${au('data_leakage','data leakage')} ‚Äî the model learned scaffold identity, not binding chemistry.</p></div>
<div class="vw"><h3 style="color:var(--grn)">‚úÖ Scaffold Split</h3>
<p>Group molecules by ${au('Murcko','Murcko scaffold')} (core backbone after removing all side chains). ALL molecules sharing a scaffold ‚Üí SAME set.</p>
<p>Model must generalize to <strong>entirely new chemical families</strong> it's never seen. This is the real-world scenario: you want to predict binding for NEW compounds, not variants of known ones.</p>
<p>Your honest AUC: <span class="n">0.85 ‚Äì 0.93</span> across 5 folds. Lower than 0.998 but REAL.</p></div>
</div>
</div>
</div>

<div class="L3">
<h2>Your Actual Feature Generation Code</h2>
<pre><span class="cmt"># From scripts/02_generate_features.py</span>
<span class="kw">from</span> rdkit <span class="kw">import</span> Chem
<span class="kw">from</span> rdkit.Chem <span class="kw">import</span> AllChem, Descriptors

<span class="kw">def</span> <span class="fn">compute_features</span>(smiles):
    mol = Chem.MolFromSmiles(smiles)
    <span class="kw">if</span> mol <span class="kw">is</span> None: <span class="kw">return</span> None

    features = {}

    <span class="cmt"># Morgan fingerprint (2048 bits, radius 2)</span>
    fp = AllChem.GetMorganFingerprintAsBitVect(mol, radius=2, nBits=2048)
    fp_array = np.zeros(2048, dtype=np.int8)
    <span class="kw">for</span> i <span class="kw">in</span> fp.GetOnBits():
        fp_array[i] = 1
    features[<span class="str">'fingerprint'</span>] = fp_array

    <span class="cmt"># Physicochemical descriptors</span>
    features[<span class="str">'mw'</span>] = Descriptors.MolWt(mol)          <span class="cmt"># Molecular weight</span>
    features[<span class="str">'logp'</span>] = Descriptors.MolLogP(mol)      <span class="cmt"># Lipophilicity</span>
    features[<span class="str">'tpsa'</span>] = Descriptors.TPSA(mol)         <span class="cmt"># Polar surface area</span>
    features[<span class="str">'hbd'</span>] = Descriptors.NumHDonors(mol)    <span class="cmt"># H-bond donors</span>
    features[<span class="str">'hba'</span>] = Descriptors.NumHAcceptors(mol) <span class="cmt"># H-bond acceptors</span>
    features[<span class="str">'rotbonds'</span>] = Descriptors.NumRotatableBonds(mol)
    features[<span class="str">'aromatic_rings'</span>] = Descriptors.NumAromaticRings(mol)
    features[<span class="str">'fsp3'</span>] = Descriptors.FractionCSP3(mol)
    features[<span class="str">'heavy_atoms'</span>] = mol.GetNumHeavyAtoms()
    features[<span class="str">'num_rings'</span>] = Descriptors.RingCount(mol)
    <span class="kw">return</span> features</pre>

<h2>Your Actual Training Code</h2>
<pre><span class="cmt"># From scripts/03_train_model.py</span>
<span class="kw">import</span> xgboost <span class="kw">as</span> xgb
<span class="kw">from</span> rdkit.Chem.Scaffolds <span class="kw">import</span> MurckoScaffold

<span class="cmt"># ===== PSEUDO-LABELING =====</span>
top_threshold = features_df[<span class="str">'cnn_affinity'</span>].quantile(0.90)
bottom_threshold = features_df[<span class="str">'cnn_affinity'</span>].quantile(0.10)

features_df.loc[features_df[<span class="str">'cnn_affinity'</span>] >= top_threshold, <span class="str">'label'</span>] = 1
features_df.loc[features_df[<span class="str">'cnn_affinity'</span>] <= bottom_threshold, <span class="str">'label'</span>] = 0
<span class="cmt"># Middle 80% excluded (label = -1)</span>

<span class="cmt"># ===== SCAFFOLD SPLIT =====</span>
<span class="kw">def</span> <span class="fn">get_scaffold</span>(smiles):
    mol = Chem.MolFromSmiles(smiles)
    scaffold = MurckoScaffold.GetScaffoldForMol(mol)
    <span class="kw">return</span> Chem.MolToSmiles(scaffold)

<span class="cmt"># Group by scaffold, split scaffolds (not molecules)</span>
scaffolds = list(scaffold_groups.keys())
np.random.shuffle(scaffolds)
train_scaffolds = set(scaffolds[:int(0.8 * len(scaffolds))])

<span class="cmt"># ===== COMBINE FEATURES =====</span>
X = np.hstack([X_desc, X_fp])  <span class="cmt"># Shape: (n_compounds, 2050)</span>

<span class="cmt"># ===== TRAIN =====</span>
params = {
    <span class="str">'n_estimators'</span>: 100,          <span class="cmt"># 100 boosting rounds (poster value)</span>
    <span class="str">'max_depth'</span>: 6,               <span class="cmt"># Up to 64 leaf nodes per tree</span>
    <span class="str">'learning_rate'</span>: 0.05,        <span class="cmt"># Each tree contributes 5% correction</span>
    <span class="str">'subsample'</span>: 0.8,             <span class="cmt"># Each tree sees 80% of rows</span>
    <span class="str">'colsample_bytree'</span>: 0.8,     <span class="cmt"># Each tree sees 80% of features</span>
    <span class="str">'objective'</span>: <span class="str">'binary:logistic'</span>,
    <span class="str">'eval_metric'</span>: <span class="str">'auc'</span>,
    <span class="str">'random_state'</span>: 42
}
model = xgb.XGBClassifier(**params)
model.fit(X_train, y_train)

<span class="cmt"># ===== NEGATIVE CONTROL (SHUFFLED LABELS) =====</span>
<span class="kw">for</span> i <span class="kw">in</span> range(10):
    y_shuffled = np.random.permutation(y_train)  <span class="cmt"># Destroy all signal</span>
    model_shuffle = xgb.XGBClassifier(**params)
    model_shuffle.fit(X_train, y_shuffled)
    auc_shuffle = roc_auc_score(y_test, model_shuffle.predict_proba(X_test)[:,1])
    <span class="cmt"># ‚Üí AUC ‚âà 0.50 every time = pure random chance</span></pre>

${ex('w','Why n_estimators=100, not 500 or 1000?',`
<p>The code file (03_train_model.py) actually says 500. <strong>Poster says 100. Poster is authority.</strong></p>
<p><strong>The math:</strong> With learning_rate=0.05, each tree contributes 5% of the correction. After 100 trees: total correction = sum of 100 √ó 5% adjustments. The ensemble has converged ‚Äî adding more trees gives diminishing returns.</p>
<p><strong>Overfitting risk:</strong> With only ~858 labeled samples and 2,050 features, more trees = more capacity to memorize individual compounds. 100 trees keeps the model expressive enough to capture binding patterns without overfitting. The shuffled control AUC ~0.50 confirms 100 trees is learning real signal, not noise.</p>
<p><strong>Empirical validation:</strong> 5-fold CV AUC ranges 0.85-0.93. If the model were overfitting, you'd see high train AUC but low test AUC. The consistency across folds confirms appropriate model complexity.</p>
`)}

${ex('w','Why max_depth=6?',`
<p>Depth 3 = 2¬≥ = 8 leaf nodes per tree. Too shallow ‚Äî can't capture interactions between fingerprint bits and descriptors. Imagine needing to ask "Is bit 847 on AND LogP > 3 AND TPSA < 80?" ‚Äî that's already depth 3, leaving no room for more conditions.</p>
<p>Depth 12 = 2¬π¬≤ = 4,096 leaf nodes. Way too deep for 858 samples ‚Äî most leaves would have 0-1 samples, perfectly memorizing the training data.</p>
<p>Depth 6 = 2‚Å∂ = 64 leaf nodes. With 858 samples √∑ 64 leaves ‚âà 13 samples per leaf on average. Enough for meaningful statistics per leaf while allowing complex feature interactions. This is the standard recommendation in the XGBoost documentation for small-to-medium datasets.</p>
`)}

${ex('w','Why subsample=0.8 and colsample_bytree=0.8?',`
<p><strong>subsample=0.8:</strong> Each tree is trained on a random 80% of the data (688 of 858 samples). The other 20% serves as implicit out-of-bag validation. This is "row subsampling" ‚Äî like Random Forest's bagging but within boosting.</p>
<p><strong>colsample_bytree=0.8:</strong> Each tree sees only 80% of the 2,050 features (1,640 features). Different trees see different feature subsets. No single tree can rely on one dominant feature.</p>
<p><strong>Combined effect:</strong> Double randomization. Each tree sees a different random subset of both data and features. This dramatically reduces overfitting because no tree has access to the full picture ‚Äî the ensemble must combine diverse perspectives. Inspired by the Random Forest literature but applied within boosting.</p>
`)}

${ex('x','Data Leakage Discovery ‚Äî AUC 0.998',`
<p><strong>What happened:</strong> First training run with random split ‚Üí AUC = 0.998. Suspiciously perfect. No biological dataset is that clean.</p>
<p><strong>Root cause:</strong> Random split placed structurally similar molecules (same Murcko scaffold) in both train and test. The model learned "if scaffold X ‚Üí high affinity" ‚Äî scaffold identity, not binding chemistry. This is textbook ${au('data_leakage','data leakage')}.</p>
<p><strong>How you caught it:</strong> Noticed that feature importance was dominated by specific fingerprint bits corresponding to common scaffolds. Suspicion confirmed when removing the top 10 features barely changed AUC ‚Äî the model had many redundant scaffold-encoding features.</p>
<p><strong>Fix:</strong> Scaffold split. AUC dropped to 0.85-0.93. This is HONEST and REAL. The difference (0.998 ‚Üí 0.90) is entirely due to removing leakage.</p>
<p><strong>Why this matters for judges:</strong> You caught your own error and fixed it. Most high school projects don't even know what data leakage is, let alone detect and correct it. This demonstrates scientific integrity.</p>
`)}

${ex('j','Judge: "How do you know the model isn\'t just memorizing?"',`
<p>"Three controls. First, <strong>scaffold-split cross-validation</strong>: no molecule in the test set shares a chemical backbone with any training molecule. The model must generalize to entirely new chemical families it has never seen. Second, the <strong>shuffled-label control</strong>: I randomize labels, retrain with identical parameters and data ‚Äî AUC drops to approximately 0.50, which is pure random chance. This proves the real AUC of 0.85-0.93 is learning genuine binding signal. Third, when I initially used random splits, AUC was 0.998 ‚Äî I recognized that was data leakage, identified the cause as scaffold overlap between train and test, and corrected it."</p>
`)}

<p>ML selected top <span class="n">2,129</span> predicted binders ‚Üí clustered to 150 diverse representatives ‚Üí ADMET filtering.</p>
</div>
</div>
`},


// ============ ADMET ============
{id:'admet',icon:'üíä',label:'ADMET Filtering',ct:`
<h1>ADMET Drug Safety Filtering ${au('ADMET','ADMET')}</h1>
<p class="sub">Ensuring your candidate drugs can actually work in a human body.</p>
<div class="lv" id="lv_admet"><button class="lb on" onclick="sL('admet',1)">üü¢ Noob</button><button class="lb" onclick="sL('admet',2)">üü° Intermediate</button><button class="lb" onclick="sL('admet',3)">üî¥ Expert</button></div>
<div id="admet_b" class="sL1">

<div class="L1">
<h2>Why ADMET Matters</h2>
<div class="c ca">
<p>A drug can fit perfectly into the protein pocket but still be useless if:</p>
<ul>
<li>It can't be swallowed and absorbed through the gut wall ‚Üí never enters blood</li>
<li>It gets destroyed by the liver before reaching the target ‚Üí metabolized too fast</li>
<li>It's toxic ‚Äî kills healthy cells, damages organs</li>
<li>It can't cross the cell membrane ‚Üí never reaches NOD2 (which is INSIDE the cell)</li>
</ul>
<p><strong>~90% of drug candidates fail</strong> in clinical trials due to ADMET problems, not lack of binding. Filtering early saves years of wasted work.</p>
</div>
</div>

<div class="L2">
<h2>Your Five Filter Layers</h2>
<div class="c cc">
<h3>1. ${au('lipinski','Lipinski\'s Rule of 5')} ‚Äî Oral Bioavailability</h3>
<p>Pfizer scientist Christopher Lipinski analyzed all FDA-approved oral drugs in 1997 and found they share four properties (all multiples of 5):</p>
<table>
<tr><th>Property</th><th>Cutoff</th><th>Physics</th></tr>
<tr><td>MW ‚â§ <span class="n">500</span></td><td>Da</td><td>Molecules >500 Da can't passively diffuse through the 30 √Ö-thick intestinal epithelial membrane. The membrane has ~4 √Ö "pores" between lipid molecules.</td></tr>
<tr><td>LogP ‚â§ <span class="n">5</span></td><td>‚Äî</td><td>Too hydrophobic = dissolves in membrane and stays there. Too hydrophilic = can't enter membrane at all. Sweet spot: LogP 1-3.</td></tr>
<tr><td>HBD ‚â§ <span class="n">5</span></td><td>‚Äî</td><td>Each H-bond donor must break its H-bond with surrounding water (desolvation penalty ~5 kJ/mol) before entering the membrane.</td></tr>
<tr><td>HBA ‚â§ <span class="n">10</span></td><td>‚Äî</td><td>Same principle ‚Äî each H-bond acceptor incurs a desolvation penalty.</td></tr>
</table>

<h3>2. Veber's Rules ‚Äî Flexibility + Polarity</h3>
<table>
<tr><th>Property</th><th>Cutoff</th><th>Physics</th></tr>
<tr><td>${au('TPSA','TPSA')} ‚â§ <span class="n">140 √Ö¬≤</span></td><td>‚Äî</td><td>Polar surface can't penetrate lipid bilayer. For NOD2 (intracellular target), membrane permeability is CRITICAL. TPSA is the most important single filter.</td></tr>
<tr><td>RotBonds ‚â§ <span class="n">10</span></td><td>‚Äî</td><td>Flexible molecules must "freeze" into one conformation upon binding. More rotatable bonds = larger ${au('entropy','entropy')} penalty = weaker binding (ŒîS becomes more negative ‚Üí TŒîS more positive ‚Üí ŒîG less favorable).</td></tr>
</table>

<h3>3. ${au('PAINS','PAINS')} Filters ‚Äî Chemical Liars</h3>
<p>PAINS = Pan-Assay INterference compoundS. Substructures that react nonspecifically with assay components ‚Äî they look "active" in EVERY assay, not just yours. Examples: quinones (redox cyclers), Michael acceptors (covalent binders), rhodanines (aggregators). ~7% of commercial screening compounds contain PAINS. Your filter uses RDKit's FilterCatalog with 480 PAINS substructure patterns.</p>

<h3>4. Brenk Filters ‚Äî Toxic Substructures</h3>
<p>105 known problematic substructure patterns: reactive warheads (epoxides, acyl halides), genotoxic groups (nitroso compounds, aromatic azo), metabolic liabilities (nitro groups that liver converts to toxic hydroxylamines). Compounds with ‚â•2 alerts removed.</p>

<h3>5. Aggregation Check</h3>
<p>Some molecules form colloidal aggregates in water ‚Äî microscopic clumps that nonspecifically sequester proteins, mimicking binding. Checked by predicted aggregation scores and LogP outliers.</p>
</div>

<p>Result: <span class="n">148</span> of 150 passed (<span class="n">98.7%</span>). The 2 failures had PAINS alerts (Michael acceptor substructures).</p>

${ex('w','Why the high pass rate (98.7%) isn\'t suspicious',`
<p>Your ML model + GNINA already selected drug-like compounds. The FDA library (e-Drug3D) consists entirely of approved drugs that already satisfy Lipinski/Veber. The COCONUT natural products were pre-filtered for drug-likeness during library preparation. ADMET here is a <strong>safety net</strong>, not the primary filter. The 2 that failed were caught by PAINS ‚Äî structural motifs invisible to docking but known to cause false positives in binding assays.</p>
`)}
</div>

<div class="L3">
<h2>Your ADMET Code</h2>
<pre><span class="cmt"># From scripts/10_admet_profiling.py</span>
<span class="kw">from</span> rdkit.Chem <span class="kw">import</span> FilterCatalog, Descriptors

<span class="cmt"># Initialize PAINS filter catalog (480 substructure patterns)</span>
pains_params = FilterCatalog.FilterCatalogParams()
pains_params.AddCatalog(FilterCatalog.FilterCatalogParams.FilterCatalogs.PAINS)
pains_catalog = FilterCatalog.FilterCatalog(pains_params)

<span class="kw">def</span> <span class="fn">check_admet</span>(mol):
    <span class="cmt"># Lipinski</span>
    violations = 0
    <span class="kw">if</span> Descriptors.MolWt(mol) > 500: violations += 1
    <span class="kw">if</span> Descriptors.MolLogP(mol) > 5: violations += 1
    <span class="kw">if</span> Descriptors.NumHDonors(mol) > 5: violations += 1
    <span class="kw">if</span> Descriptors.NumHAcceptors(mol) > 10: violations += 1
    lipinski_pass = violations <= 1  <span class="cmt"># Allow 1 violation</span>

    <span class="cmt"># Veber</span>
    veber_pass = (Descriptors.TPSA(mol) <= 140 <span class="kw">and</span>
                  Descriptors.NumRotatableBonds(mol) <= 10)

    <span class="cmt"># PAINS</span>
    pains_matches = pains_catalog.GetMatches(mol)
    pains_pass = len(pains_matches) == 0

    <span class="kw">return</span> lipinski_pass <span class="kw">and</span> veber_pass <span class="kw">and</span> pains_pass</pre>

${ex('w','Why TPSA matters SPECIFICALLY for NOD2',`
<p>NOD2 is an <strong>intracellular cytoplasmic protein</strong>. The drug must cross the plasma membrane (a ~30 √Ö thick lipid bilayer) to reach its target. This is fundamentally different from drugging a cell-surface receptor (like GPCRs or receptor tyrosine kinases) where the drug only needs to reach the extracellular face.</p>
<p>TPSA quantifies the total area of polar atoms (O, N, and their attached H) exposed on the molecular surface. High TPSA = many polar groups = strong H-bonds with surrounding water = high desolvation penalty to enter the lipid bilayer = poor membrane permeability.</p>
<p>The 140 √Ö¬≤ cutoff comes from Veber et al. (2002): compounds with TPSA >140 √Ö¬≤ have <10% oral bioavailability in rats. For an intracellular target like NOD2, membrane permeability is a HARD requirement, making TPSA the single most important ADMET filter in your pipeline.</p>
`)}
</div>
</div>
`},


// ============ MD SIMULATION ============
{id:'md',icon:'üß™',label:'MD Simulation',ct:`
<h1>Molecular Dynamics Simulation ${au('molecular_dynamics','Molecular Dynamics')}</h1>
<p class="sub">Simulating how 217,986 atoms move over time using Newton's laws. 520 nanoseconds total.</p>
<div class="lv" id="lv_md"><button class="lb on" onclick="sL('md',1)">üü¢ Noob</button><button class="lb" onclick="sL('md',2)">üü° Intermediate</button><button class="lb" onclick="sL('md',3)">üî¥ Expert</button></div>
<div id="md_b" class="sL1">

<div class="L1">
<h2>Why MD After Docking?</h2>
<div class="c ca">
<p>Docking gives you a <strong>snapshot</strong> ‚Äî one frozen pose of the drug in the pocket. But proteins aren't frozen. They constantly jiggle, breathe, flex, and vibrate at body temperature. A drug that looks great in a snapshot might:</p>
<ul>
<li>Fall out of the pocket after 2 nanoseconds</li>
<li>Lose critical H-bonds as the protein breathes</li>
<li>Get trapped in a pose that's a local minimum but not the true binding mode</li>
</ul>
<p>MD tests: <strong>Does the drug STAY in the pocket over time?</strong></p>
</div>

<h2>What is MD? F = ma for Every Atom</h2>
<div class="c cc">
<p>${au('molecular_dynamics','Molecular dynamics')} = simulating Newton's second law (<strong>F = ma</strong>) for every atom in the system, every ${au('femtosecond','femtosecond')} (10‚Åª¬π‚Åµ seconds):</p>
<ol>
<li><strong>Calculate forces</strong> on each atom: springs between bonded atoms, angle bending, torsion, ${au('electrostatic','electrostatic')} attraction/repulsion, ${au('van_der_waals','van der Waals')}</li>
<li><strong>F = ma</strong> ‚Üí compute acceleration: a = F/m (mass is known for each atom type)</li>
<li><strong>Update velocity:</strong> v(t+dt) = v(t) + a √ó dt</li>
<li><strong>Update position:</strong> x(t+dt) = x(t) + v √ó dt</li>
<li><strong>Repeat</strong> 5,000,000 times for 20 nanoseconds</li>
</ol>
<p>Result: a "movie" of the protein+drug system showing every atom's position at each time point. You can watch the drug wobble in the pocket, H-bonds form and break, water molecules enter and leave.</p>
</div>
</div>

<div class="L2">
<h2>Force Fields ‚Äî The Physics Engine ${au('force_field','Force Field')}</h2>
<div class="c cc">
<p>The force field defines HOW to calculate forces. It's a set of equations with fitted parameters:</p>
<pre style="background:transparent;border:none;color:var(--txt);padding:0;font-size:13px">
E_total = E_bonds + E_angles + E_dihedrals + E_vdW + E_electrostatic

E_bonds = Œ£ k_b(r - r‚ÇÄ)¬≤              ‚Üê springs between bonded atoms
E_angles = Œ£ k_Œ∏(Œ∏ - Œ∏‚ÇÄ)¬≤             ‚Üê angle bending (3 atoms)
E_dihedrals = Œ£ V_n[1 + cos(nœÜ - Œ≥)]  ‚Üê torsional rotation (4 atoms)
E_vdW = Œ£ 4Œµ[(œÉ/r)¬π¬≤ - (œÉ/r)‚Å∂]       ‚Üê Lennard-Jones: repulsion + attraction
E_elec = Œ£ q_i¬∑q_j / (4œÄŒµ‚ÇÄ¬∑r)        ‚Üê Coulomb's law
</pre>
<p>Each equation has parameters (k_b, r‚ÇÄ, Œµ, œÉ, q) that are specific to each atom type. These were fitted to quantum mechanics calculations and experimental data over decades.</p>
<table>
<tr><th>Force Field</th><th>Used For</th><th>Why This One</th></tr>
<tr><td><strong>${au('AMBER14','AMBER14')}</strong></td><td>Protein atoms</td><td>Gold standard for protein simulations since 2014. Parameters refined against thousands of experimental protein structures. Most-cited protein force field.</td></tr>
<tr><td><strong>${au('OpenFF','OpenFF')} 2.1 (Sage)</strong></td><td>Drug (ligand) atoms</td><td>Modern, ML-fitted parameters released 2023. Handles diverse drug chemistry (heteroatoms, unusual ring systems) better than older force fields like GAFF2. Critical for novel compounds like Bufadienolide.</td></tr>
<tr><td><strong>${au('TIP3P_FB','TIP3P-FB')}</strong></td><td>Water molecules</td><td>Updated TIP3P model (ForceBalance-optimized) with improved density and diffusion at 310K. Compatible with AMBER14 protein parameters.</td></tr>
</table>
</div>

<h2>Your Simulation Protocol ‚Äî 4 Stages</h2>
<div class="c">
<h3>Stage 1: Energy Minimization (5,000 steps)</h3>
<p>The docking pose has atomic clashes ‚Äî atoms slightly too close. Minimization moves atoms downhill on the energy landscape to remove these clashes. Uses L-BFGS algorithm. No dynamics (no velocities), just optimization.</p>

<h3>Stage 2: ${au('NVT','NVT')} Equilibration (100 ps)</h3>
<p>"Heat" the system to <span class="n">310.15 K</span> (37¬∞C, body temperature). Constant: <strong>N</strong>umber of atoms, <strong>V</strong>olume, <strong>T</strong>emperature. ${au('Langevin','Langevin thermostat')} maintains temperature by adding friction (Œ≥ = 1/ps) and random kicks to atoms.</p>
<p>Why NVT first? Temperature equilibration is faster and more stable at constant volume. Let atoms reach thermal equilibrium before changing the box size.</p>

<h3>Stage 3: ${au('NPT','NPT')} Equilibration (500 ps)</h3>
<p>Now adjust box size to reach correct density. Constant: <strong>N</strong>umber, <strong>P</strong>ressure (1 atm), <strong>T</strong>emperature (310K). Monte Carlo ${au('barostat','barostat')} attempts volume changes every 25 steps ‚Äî accepts if pressure is closer to 1 atm, rejects otherwise.</p>
<p>The box shrinks slightly as water molecules settle into optimal packing. Final density ‚âà 1.0 g/mL.</p>

<h3>Stage 4: Production (20 ns √ó 3 replicates)</h3>
<p>Record everything. Save atomic positions every 5,000 steps (= every 20 ps). This trajectory is what you analyze for pocket occupancy, RMSD, H-bonds.</p>
<p>Why 3 replicates? One trajectory might sample an atypical event. Three independent simulations (different random velocities) give statistical confidence. If all 3 agree, the result is robust.</p>
</div>
</div>

<div class="L3">
<h2>Every Parameter Explained</h2>
<table>
<tr><th>Parameter</th><th>Value</th><th>Physics Reasoning</th></tr>
<tr><td>Temperature</td><td class="n">310.15 K</td><td>= 37¬∞C = human body temperature. Simulates the thermal environment inside an intestinal epithelial cell. Not 300K (room temp) because drug efficacy must be predicted at physiological conditions.</td></tr>
<tr><td>Pressure</td><td class="n">1.0 atm</td><td>Atmospheric pressure. Sets correct water density (~0.993 g/mL at 310K) and box size.</td></tr>
<tr><td>Timestep</td><td class="n">4 fs (MD) / 2 fs (FEP)</td><td>${au('HMR','HMR')}: Transfer mass from heavy atoms to bonded H atoms (H mass ‚Üí 1.5 amu). Heavier H vibrates slower ‚Üí highest frequency mode is now ~10 fs period ‚Üí timestep can be 4 fs (Nyquist: dt ‚â§ period/2.5). FEP uses 2 fs for energy precision. Without HMR: max dt = 2 fs.</td></tr>
<tr><td>Salt</td><td class="n">0.15 M NaCl</td><td>Physiological ionic strength. Neutralizes system net charge (important for ${au('PME','PME')} electrostatics). Na‚Å∫ and Cl‚Åª ions screen long-range electrostatic interactions realistically.</td></tr>
<tr><td>Nonbonded cutoff</td><td class="n">1.0 nm</td><td>${au('van_der_waals','van der Waals')} forces decay as 1/r‚Å∂ ‚Üí negligible beyond 1 nm. Electrostatics handled by ${au('PME','PME')} (Particle Mesh Ewald) which uses 3D Fourier transforms to compute long-range Coulomb interactions exactly. PME is O(N log N) vs O(N¬≤) for brute force.</td></tr>
<tr><td>Constraints</td><td>AllBonds</td><td>Fix ALL bond lengths at equilibrium values using SHAKE/LINCS algorithm. Removes fastest vibrations (C-H stretch ~10 fs, O-H stretch ~10 fs) ‚Üí enables larger timestep. Combined with HMR ‚Üí 4 fs.</td></tr>
<tr><td>H mass (HMR)</td><td class="n">1.5 amu</td><td>Standard H mass = 1.008 amu. With HMR: 1.5 amu. Extra 0.492 amu comes from bonded heavy atom. Increases H vibrational period by ‚àö(1.5/1.008) ‚âà 1.22√ó ‚Üí safe for 4 fs timestep.</td></tr>
<tr><td>Friction (Œ≥)</td><td class="n">1.0 ps‚Åª¬π</td><td>Langevin friction coefficient. Controls thermostat coupling strength. Œ≥ = 1/ps is "moderate coupling" ‚Äî maintains temperature without overdamping dynamics. Too high (10/ps) = sluggish dynamics. Too low (0.1/ps) = poor temperature control.</td></tr>
<tr><td>Total atoms</td><td class="n">~217,986</td><td>Protein (~16K) + drug (~50) + ~65K water molecules (~195K atoms) + ~200 ions. Water is 90% of atoms.</td></tr>
<tr><td>Production</td><td class="n">20 ns √ó 3 reps</td><td>20 ns: Long enough to observe if drug leaves (negative control left by ~5 ns). Short enough to be feasible on RTX 4060 Ti (~8 hrs/trajectory). 3 reps: Statistical significance.</td></tr>
<tr><td>Total MD time</td><td class="n">520 ns</td><td>26 simulations √ó 20 ns. Includes apo (no drug) + 5 drug-bound systems √ó WT and R702W √ó 3 reps.</td></tr>
</table>

<h2>Your Actual OpenMM Code</h2>
<pre><span class="cmt"># From PHASE_6/gpu_scripts/03_run_md_febuxostat.py</span>
<span class="kw">from</span> openmm <span class="kw">import</span> *
<span class="kw">from</span> openmm.app <span class="kw">import</span> *
<span class="kw">from</span> openmm.unit <span class="kw">import</span> *

<span class="cmt"># Load system</span>
pdb = PDBFile(complex_pdb)
forcefield = ForceField(<span class="str">'amber14-all.xml'</span>, <span class="str">'amber14/tip3pfb.xml'</span>)

<span class="cmt"># Create simulation system</span>
system = forcefield.createSystem(
    pdb.topology,
    nonbondedMethod=PME,              <span class="cmt"># Ewald summation for electrostatics</span>
    nonbondedCutoff=1.0*nanometers,   <span class="cmt"># vdW cutoff at 1 nm</span>
    constraints=AllBonds,             <span class="cmt"># Fix bond lengths ‚Üí 4fs possible</span>
    hydrogenMass=1.5*amu              <span class="cmt"># HMR for 4 fs timestep</span>
)

<span class="cmt"># Langevin thermostat + integrator</span>
integrator = LangevinMiddleIntegrator(
    310.15*kelvin,      <span class="cmt"># Body temperature</span>
    1.0/picoseconds,    <span class="cmt"># Friction coefficient</span>
    4.0*femtoseconds    <span class="cmt"># Timestep (4fs with HMR)</span>
)

<span class="cmt"># GPU acceleration</span>
platform = Platform.getPlatformByName(<span class="str">'CUDA'</span>)
properties = {<span class="str">'CudaPrecision'</span>: <span class="str">'mixed'</span>}
<span class="cmt"># mixed = FP32 accumulation + FP16 force calculation</span>
<span class="cmt"># 2√ó faster than 'double', ~0.01% energy drift ‚Äî acceptable</span>

simulation = Simulation(pdb.topology, system, integrator, platform, properties)
simulation.context.setPositions(pdb.positions)

<span class="cmt"># Stage 1: Minimize</span>
simulation.minimizeEnergy(maxIterations=5000)

<span class="cmt"># Stage 2: NVT (100 ps)</span>
simulation.context.setVelocitiesToTemperature(310.15*kelvin)
simulation.step(25000)  <span class="cmt"># 100ps √∑ 4fs = 25,000 steps</span>

<span class="cmt"># Stage 3: Add barostat ‚Üí NPT (500 ps)</span>
system.addForce(MonteCarloBarostat(1.0*atmospheres, 310.15*kelvin))
simulation.context.reinitialize(preserveState=True)
simulation.step(125000)  <span class="cmt"># 500ps √∑ 4fs = 125,000 steps</span>

<span class="cmt"># Stage 4: Production (20 ns)</span>
simulation.reporters.append(DCDReporter(<span class="str">'traj.dcd'</span>, 5000))
<span class="cmt"># Save every 5000 steps = every 20 ps = 1000 frames for 20ns</span>
simulation.step(5000000)  <span class="cmt"># 20ns √∑ 4fs = 5,000,000 steps</span></pre>

${ex('x','NaN Explosion ‚Äî Jan 1, 2026 (Worst Crash)',`
<p><strong>Setup:</strong> 217,986 atoms, 75,611 heavy-atom restraints at k = 1000 kJ/mol/nm¬≤, timestep 4 fs with HMR.</p>
<p><strong>Error:</strong> OpenMM: <code>"Particle coordinate is NaN. For more information, see https://github.com/openmm/openmm/wiki/Frequently-Asked-Questions"</code></p>
<p><strong>Physics of the crash:</strong></p>
<ol>
<li>Restraint force = k √ó displacement. With k=1000 kJ/mol/nm¬≤, even a 0.1 nm displacement ‚Üí force of 100 kJ/mol/nm = 1.66√ó10‚Åª¬π‚Å∞ N on one atom</li>
<li>For hydrogen (mass 1.5 amu with HMR): a = F/m = enormous acceleration</li>
<li>With dt = 4 fs: Œîx = v¬∑dt + ¬Ω¬∑a¬∑dt¬≤ ‚Üí atom moves several nanometers in one step</li>
<li>Atom overlaps with another atom ‚Üí Lennard-Jones 1/r¬π¬≤ term ‚Üí infinite repulsive force ‚Üí NaN</li>
</ol>
<p><strong>The lethal combination:</strong> High restraints (k=1000) + large timestep (4 fs) + HMR (lighter heavy atoms = faster response to restraint forces). Any TWO of these three would have been fine. All three together ‚Üí guaranteed crash.</p>
<p><strong>Fix:</strong> Reduced initial restraints to k=100, ramped up gradually over 50 ps. For some difficult systems, dropped to 2 fs timestep during restraint phase. Completed successfully after fixes.</p>
`)}

${ex('x','RTX 5090 CUDA 13 Incompatibility ‚Äî Jan 3',`
<p>Rented RTX 5090 on Vast.ai ($1.20/hr). <code>nvidia-smi</code> showed CUDA Driver 13.0 (Blackwell architecture). Conda's OpenMM was compiled against CUDA 12.x ‚Äî maximum supported CUDA runtime.</p>
<p>OpenMM crashed immediately: <code>CUDA Error: no kernel image is available for execution on the device</code></p>
<p>GPU was too NEW ‚Äî no compatible binaries existed yet for Blackwell SM_100 architecture.</p>
<p>Destroyed Vast.ai instance (wasted ~$5), rented H200 (Hopper architecture, CUDA 12.4) instead. Lesson: always check <code>nvidia-smi</code> CUDA version BEFORE starting work.</p>
`)}

<h2>Key Results from MD</h2>
<div class="c cg">
<h3>APO Dynamics (No Drug)</h3>
<table>
<tr><th>Metric</th><th>Wild-Type</th><th>R702W</th><th>What It Proves</th></tr>
<tr><td>Avg ${au('RMSD','RMSD')}</td><td class="n">4.05 √Ö</td><td class="n">3.27 √Ö</td><td>R702W is more rigid ‚Äî less backbone movement</td></tr>
<tr><td>RMSD std dev</td><td class="n">~1.0 √Ö</td><td class="n">~0.4 √Ö</td><td>WT explores 2.5√ó wider conformational range</td></tr>
<tr><td>Frames >5 √Ö</td><td class="n">12.6%</td><td class="n">0%</td><td>WT regularly visits large conformations; R702W NEVER does</td></tr>
</table>

<h3>Drug Binding Stability</h3>
<table>
<tr><th>Compound</th><th>Pocket Occupancy</th><th>Avg H-bonds</th><th>Verdict</th></tr>
<tr><td><strong>${au('febuxostat','Febuxostat')}</strong></td><td class="n">~73%</td><td class="n">~2</td><td>Stable ‚Äî stays in pocket across all replicates</td></tr>
<tr><td><strong>${au('bufadienolide','Bufadienolide')}</strong></td><td class="n">~80%</td><td class="n">~2</td><td>Very stable ‚Äî highest occupancy of all candidates</td></tr>
<tr><td>Negative control</td><td class="n">~0%</td><td class="n">0</td><td>Left pocket by ~5 ns ‚Üí validates the method</td></tr>
</table>
<p>The negative control is crucial: if even non-binders stayed in the pocket, your method would be meaningless. The fact that the control leaves while leads stay confirms your MD is correctly distinguishing real binders from non-binders.</p>
</div>
</div>
</div>
`},


// ============ FEP ============
{id:'fep',icon:'‚ö°',label:'FEP',ct:`
<h1>Free Energy Perturbation ${au('FEP','FEP')}</h1>
<p class="sub">The gold standard for computing binding free energies. Your most rigorous and expensive calculation.</p>
<div class="lv" id="lv_fep"><button class="lb on" onclick="sL('fep',1)">üü¢ Noob</button><button class="lb" onclick="sL('fep',2)">üü° Intermediate</button><button class="lb" onclick="sL('fep',3)">üî¥ Expert</button></div>
<div id="fep_b" class="sL1">

<div class="L1">
<h2>The Question FEP Answers</h2>
<div class="c ca">
<p>MD told you the drug STAYS in the pocket. But HOW TIGHTLY? And does the R702W mutation make it bind weaker or stronger?</p>
<p>${au('FEP','FEP')} gives you a single number: <strong>${au('delta_G','ŒîG')}</strong> (binding free energy) in ${au('kcal_mol','kcal/mol')}. More negative = tighter binding.</p>
<p>Then you compare: ŒîG in wild-type vs ŒîG in R702W mutant. The difference (<strong>${au('delta_delta_G','ŒîŒîG')}</strong>) tells you exactly how much the mutation affects drug binding.</p>
</div>

<h2>What is Free Energy? ${au('gibbs_free_energy','Gibbs Free Energy')}</h2>
<div class="c cc">
<p>The equation that governs all chemistry: <strong>G = H ‚àí TS</strong></p>
<p><strong>${au('enthalpy','H (Enthalpy)')}</strong> = total energy from molecular interactions. When a drug forms H-bonds, van der Waals contacts, electrostatic interactions with the protein ‚Üí H decreases ‚Üí favorable.</p>
<p><strong>T</strong> = temperature (310 K for body)</p>
<p><strong>${au('entropy','S (Entropy)')}</strong> = disorder/freedom. A free drug in solution can rotate, translate, flex freely = high entropy. When it binds, it's locked in one orientation = low entropy. This DECREASE in entropy is unfavorable (‚àíTŒîS is positive).</p>
<p><strong>ŒîG < 0 means binding happens spontaneously.</strong> The enthalpy gain (good interactions) must overcome the entropy penalty (lost freedom). A drug with ŒîG = ‚àí10 kcal/mol has very strong favorable interactions that overwhelm the entropy cost.</p>
</div>

<h2>How FEP Works ‚Äî The Disappearing Drug</h2>
<div class="c ca">
<p>FEP gradually "disappears" the drug from the system and measures the energy cost:</p>
<ol>
<li>Start with drug fully present (all forces ON)</li>
<li>Slowly turn off drug-protein interactions in tiny steps</li>
<li>Measure energy at each step</li>
<li>Drug is now a "ghost" ‚Äî no interactions with anything</li>
<li>The total energy to disappear the drug = ŒîG<sub>decouple</sub></li>
</ol>
<p>Do this twice: once in the protein pocket (expensive to remove because many contacts) and once in pure water (cheap to remove because fewer contacts).</p>
<p><strong>ŒîG<sub>bind</sub> = ŒîG<sub>solvent</sub> ‚àí ŒîG<sub>complex</sub></strong></p>
</div>
</div>

<div class="L2">
<h2>The Thermodynamic Cycle ${au('thermodynamic_cycle','Thermodynamic Cycle')}</h2>
<div class="c ca">
<pre style="background:transparent;border:none;color:var(--txt);padding:0;font-size:14px">
  Protein + Drug (solvated)  ‚Äî‚Äî‚Üí  Protein:Drug complex     ŒîG_bind = ?
        |                                |
        | ŒîG_decouple(solvent)           | ŒîG_decouple(complex)
        | "disappear drug from water"    | "disappear drug from pocket"
        ‚Üì                                ‚Üì
  Protein + Ghost (water)     ‚Üí   Protein:Ghost             (same state)

  Since it's a cycle: ŒîG_bind = ŒîG_decouple(solvent) ‚àí ŒîG_decouple(complex)
</pre>
<p><strong>Why indirect?</strong> You can't directly compute ŒîG_bind because it involves drug going from bulk solvent into the pocket ‚Äî an enormously complex process with billions of water rearrangements. The indirect path through "disappearing" is mathematically exact (thermodynamics) and computationally tractable.</p>
</div>

<h2>${au('lambda_window','Lambda Windows')} ‚Äî The Dimmer Switch</h2>
<div class="c">
<p><strong>Œª (lambda)</strong> controls how "present" the drug is. Œª=1 ‚Üí fully present. Œª=0 ‚Üí ghost.</p>
<p>You use <span class="n">20</span> intermediate Œª values (windows). At each window, you run a separate MD simulation and collect energy samples.</p>
<p><strong>Decoupling schedule (3 phases):</strong></p>
<table>
<tr><th>Windows</th><th>What Changes</th><th>Why This Order</th></tr>
<tr><td>0‚Äì4</td><td>${au('Boresch','Boresch restraints')} turn on</td><td>Lock drug orientation before removing interactions</td></tr>
<tr><td>5‚Äì12</td><td>Electrostatics fade out</td><td>Charges removed smoothly ‚Äî no singularities</td></tr>
<tr><td>13‚Äì19</td><td>Sterics (shape) fade out</td><td>Done LAST because removing shape causes atom overlap ‚Üí needs ${au('softcore','softcore potentials')}</td></tr>
</table>
<p>Total: <span class="n">20 windows √ó 3 legs</span> (WT_complex + Mut_complex + Solvent) <strong>√ó 2 compounds = 120 windows</strong></p>
</div>

<h2>Why FEP Beats MM-GBSA</h2>
<div class="vs">
<div class="vl"><h3 style="color:var(--red)">‚ùå MM-GBSA (your first attempt)</h3>
<p>Takes a single MD snapshot ‚Üí computes energy using implicit solvent (Generalized Born model approximates water as a smooth dielectric). Fast (minutes) but error ~2-5 kcal/mol.</p>
<p><strong>Critical problem:</strong> MM-GBSA gave you a DIFFERENT ranking than FEP. It would have led to wrong conclusions about which drugs are mutation-sensitive. You can't trust it for ŒîŒîG.</p></div>
<div class="vw"><h3 style="color:var(--grn)">‚úÖ FEP (gold standard)</h3>
<p>Samples the ENTIRE thermodynamic path through 20 intermediate states. Uses explicit water (every water molecule simulated individually). ${au('MBAR','MBAR')} extracts statistically optimal free energy estimate. Error ~0.5-1.5 kcal/mol.</p>
<p>Industry standard at pharma companies (Schr√∂dinger FEP+, which costs $100K+/year). You implemented it for free using OpenMM + pymbar.</p></div>
</div>
</div>

<div class="L3">
<h2>Your Exact FEP Parameters</h2>
<table>
<tr><th>Parameter</th><th>Value</th><th>Why</th></tr>
<tr><td>Timestep</td><td class="n">2 fs</td><td>Conservative for FEP ‚Äî energy precision matters more than speed. No HMR.</td></tr>
<tr><td>Equilibration</td><td class="n">50,000 steps (100 ps)</td><td>Per window. Allows system to relax to the new Œª value before collecting data.</td></tr>
<tr><td>Production</td><td class="n">500,000 steps (1 ns)</td><td>Per window. 1 ns gives ~1,000 energy samples (sampled every 500 steps = 1 ps).</td></tr>
<tr><td>Energy sampling</td><td class="n">Every 500 steps (1 ps)</td><td>Sample every 1 ps ‚Üí 1,000 samples per window. Enough for MBAR convergence.</td></tr>
<tr><td>Lambda windows</td><td class="n">20 per leg</td><td>Sufficient overlap between adjacent windows for MBAR. Fewer windows ‚Üí poor overlap ‚Üí large error bars.</td></tr>
<tr><td>Softcore Œ±</td><td class="n">0.5</td><td>Standard value. Controls how "soft" the potential becomes at low Œª. Œ±=0.5 prevents the Lennard-Jones r‚Åª¬π¬≤ singularity from causing infinite forces when atoms overlap.</td></tr>
<tr><td>${au('Boresch','Boresch')} k_dist</td><td class="n">4184 kJ/mol/nm¬≤</td><td>= 10 kcal/mol/√Ö¬≤. Strong enough to maintain drug orientation but not so strong as to bias the energetics. The analytical correction for restraint free energy is subtracted.</td></tr>
<tr><td>Boresch k_angle</td><td class="n">41.84 kJ/mol/rad¬≤</td><td>= 10 kcal/mol/rad¬≤. Standard value from the Boresch et al. (2003) paper.</td></tr>
<tr><td>Total FEP compute</td><td class="n">120 ns</td><td>120 windows √ó 1 ns production each.</td></tr>
</table>

<h2>Your Actual FEP Code</h2>
<pre><span class="cmt"># From fep_pmx_natural/run_fep_gpu.py</span>
<span class="kw">from</span> openmm <span class="kw">import</span> *
<span class="kw">import</span> numpy <span class="kw">as</span> np

TIMESTEP = 2.0 * unit.femtoseconds   <span class="cmt"># Conservative for FEP</span>
TEMPERATURE = 310.0 * unit.kelvin
EQUIL_STEPS = 50000    <span class="cmt"># 100 ps warmup per window</span>
PROD_STEPS = 500000    <span class="cmt"># 1 ns production per window</span>
ENERGY_INTERVAL = 500  <span class="cmt"># Sample every 1 ps</span>

<span class="cmt"># Load lambda schedule ‚Äî MUST match across all legs</span>
lambda_schedule = np.load(sys_dir / <span class="str">"lambda_schedule.npy"</span>)
<span class="cmt"># Shape: (20, 3) ‚Äî [elec, sterics, restraints] per window</span>

<span class="cmt"># Set this window's lambda values</span>
simulation.context.setParameter(<span class="str">'lambda_electrostatics'</span>, lambda_elec)
simulation.context.setParameter(<span class="str">'lambda_sterics'</span>, lambda_sterics)

<span class="cmt"># PRODUCTION: Collect u_nk matrix for MBAR</span>
kT = unit.MOLAR_GAS_CONSTANT_R * TEMPERATURE
n_samples = PROD_STEPS // ENERGY_INTERVAL  <span class="cmt"># = 1000</span>
u_nk = np.zeros((n_samples, 20))  <span class="cmt"># rows=samples, cols=states</span>

<span class="kw">for</span> sample <span class="kw">in</span> range(n_samples):
    simulation.step(ENERGY_INTERVAL)  <span class="cmt"># Run 500 steps (1 ps)</span>
    
    <span class="cmt"># KEY: Evaluate energy at ALL 20 lambda states</span>
    <span class="cmt"># This is what makes MBAR possible ‚Äî cross-evaluation</span>
    <span class="kw">for</span> k <span class="kw">in</span> range(20):
        simulation.context.setParameter(<span class="str">'lambda_electrostatics'</span>, schedule[k,0])
        simulation.context.setParameter(<span class="str">'lambda_sterics'</span>, schedule[k,1])
        state = simulation.context.getState(getEnergy=True)
        u_nk[sample, k] = state.getPotentialEnergy() / kT
    
    <span class="cmt"># Reset to this window's lambda</span>
    simulation.context.setParameter(<span class="str">'lambda_electrostatics'</span>, lambda_elec)
    simulation.context.setParameter(<span class="str">'lambda_sterics'</span>, lambda_sterics)

np.save(window_dir / <span class="str">"u_nk.npy"</span>, u_nk)</pre>

<h2>MBAR Analysis Code ${au('MBAR','MBAR')}</h2>
<pre><span class="cmt"># From run_mbar_analysis.py</span>
<span class="kw">from</span> pymbar <span class="kw">import</span> MBAR

KB = 0.008314462618  <span class="cmt"># kJ/mol/K (Boltzmann constant)</span>
TEMPERATURE = 310.0
BETA = 1.0 / (KB * TEMPERATURE)  <span class="cmt"># = 0.388 mol/kJ</span>
KJ_TO_KCAL = 1.0 / 4.184

<span class="cmt"># Load u_nk data from all 20 windows</span>
<span class="cmt"># Stack into matrix: u_kn[k, n] = reduced potential of sample n at state k</span>

<span class="kw">def</span> <span class="fn">build_u_kn_matrix</span>(u_nk_list, N_k):
    <span class="cmt">"""Build the (K √ó N_total) matrix MBAR needs"""</span>
    K = len(N_k)
    N_total = sum(N_k)
    u_kn = np.zeros((K, N_total))
    offset = 0
    <span class="kw">for</span> i, (u_nk, n) <span class="kw">in</span> enumerate(zip(u_nk_list, N_k)):
        u_kn[:, offset:offset+n] = u_nk.T  <span class="cmt"># Transpose!</span>
        offset += n
    <span class="kw">return</span> u_kn

mbar = MBAR(u_kn, N_k)
<span class="cmt"># Returns free energy differences between all pairs of states</span>
<span class="cmt"># ŒîG = f[19] - f[0] = decoupling free energy for this leg</span></pre>

${ex('x','13 FEP Windows Failed ‚Äî Jan 10',`
<p><strong>Which windows:</strong> wt_complex 15-19, mut_complex 15/17-19, solvent 16-19. All at high lambda (steric decoupling phase).</p>
<p><strong>Root cause: ${au('endpoint_catastrophe','Endpoint catastrophe')}.</strong> At low Œª_sterics (windows 15-19), van der Waals interactions become very weak. Water molecules rush into the space where the drug used to be. If the initial coordinates for that window still have the drug "mostly there" but the forces say "mostly ghost" ‚Üí atoms overlap ‚Üí Lennard-Jones r‚Åª¬π¬≤ repulsion ‚Üí energy spike ‚Üí NaN.</p>
<p><strong>The core problem:</strong> Each window was initialized from the same starting coordinates (the equilibrated NPT structure). For high-Œª windows this is fine ‚Äî the drug is mostly present. For low-Œª windows, starting from a "drug present" configuration when forces say "drug is a ghost" creates instant clashes.</p>
<p><strong>Fix: Sequential seeding.</strong> Start window 16 from the final coordinates of window 15. Start window 17 from window 16's final coordinates. Each window inherits a structure that's already relaxed at a nearby Œª value. No cold-start crashes.</p>
<p>After fix: All 120 windows completed successfully. MBAR convergence confirmed by checking overlap matrices between adjacent windows.</p>
`)}

${ex('w','What are Boresch restraints in detail? ${au("Boresch","Boresch")}',`
<p>When the drug becomes a ghost at Œª‚Üí0, it has NO interactions with the protein. It would diffuse randomly through the simulation box. You can't measure "binding energy" if you can't define "bound" vs "unbound."</p>
<p><strong>Solution:</strong> 6 harmonic restraints connecting 3 drug atoms to 3 protein atoms:</p>
<ul>
<li><strong>1 distance restraint</strong> (r): keeps drug near protein</li>
<li><strong>2 angle restraints</strong> (Œ∏_A, Œ∏_B): controls approach angle</li>
<li><strong>3 dihedral restraints</strong> (œÜ_A, œÜ_B, œÜ_C): locks rotational orientation</li>
</ul>
<p>These 6 degrees of freedom fully specify the drug's position and orientation relative to the protein.</p>
<p><strong>Free energy correction:</strong> The restraints add an artificial contribution to ŒîG. This is computed analytically using the Boresch formula (integral over the restraint potential in the unrestrained reference state) and SUBTRACTED from the final answer. Net effect on ŒîG_bind: exactly zero ‚Äî it cancels perfectly in the thermodynamic cycle.</p>
`)}

${ex('w','Why MBAR is the best estimator ${au("MBAR","MBAR")}',`
<p>Three methods exist for computing free energy from Œª windows:</p>
<p><strong>TI (Thermodynamic Integration):</strong> Compute ‚ü®‚àÇH/‚àÇŒª‚ü© at each window, integrate numerically (trapezoid rule). Only uses data from adjacent windows. Error from numerical quadrature. If Œª spacing is uneven ‚Üí large integration error.</p>
<p><strong>BAR (Bennett Acceptance Ratio):</strong> Statistically optimal estimator between TWO states. For 20 windows: compute 19 pairwise BAR estimates and sum. Better than TI but doesn't leverage cross-state information.</p>
<p><strong>MBAR (Multistate BAR):</strong> Simultaneously uses ALL 20 windows. Each sample from window k is evaluated at ALL 20 Œª values (that's why your code loops over all k in the energy collection). MBAR solves a self-consistent equation to find the statistically optimal free energy estimate with MINIMUM variance. It's the provably optimal estimator given the available data.</p>
<p>In practice: MBAR gives ~20% smaller error bars than TI for the same amount of simulation data. For a project where ŒîŒîG = 2.34 ¬± 0.26, that improvement matters.</p>
`)}
</div>
</div>
`},


// ============ RESULTS ============
{id:'res',icon:'üìä',label:'Results',ct:`
<h1>Results ‚Äî The Discovery</h1>
<p class="sub">Every number from Figure 16 explained. The math, the significance, the mechanism.</p>

<h2>Figure 16 ‚Äî The Key Result</h2>
<div class="c cg">
<table>
<tr><th>Compound</th><th>${au('delta_G','ŒîG')}<sub>bind</sub>(WT) ${au('kcal_mol','kcal/mol')}</th><th>ŒîG<sub>bind</sub>(R702W)</th><th>${au('delta_delta_G','ŒîŒîG')}</th><th>Significance</th></tr>
<tr><td><strong>${au('febuxostat','Febuxostat')}</strong></td><td class="n">‚àí10.36 ¬± 0.18</td><td class="n">‚àí8.02 ¬± 0.19</td><td class="n" style="color:var(--red)">+2.34 ¬± 0.26</td><td class="n">8œÉ, p < 0.001</td></tr>
<tr><td><strong>${au('bufadienolide','Bufadienolide')}</strong></td><td class="n">‚àí15.22 ¬± 0.26</td><td class="n">‚àí15.66 ¬± 0.26</td><td class="n" style="color:var(--grn)">‚àí0.44 ¬± 0.37</td><td>1.8œÉ, NS</td></tr>
</table>
</div>

<h2>What Every Number Means</h2>
<div class="c ca">
<h3>ŒîG = ‚àí10.36 ¬± 0.18 kcal/mol (Febuxostat, WT)</h3>
<p><strong>‚àí10.36:</strong> Febuxostat binds wild-type NOD2 very tightly. For context: a typical "drug-like" binding affinity is ‚àí6 to ‚àí10 kcal/mol. Anything below ‚àí8 is considered strong.</p>
<p><strong>¬± 0.18:</strong> Uncertainty (standard error from MBAR). Comes from finite sampling ‚Äî you ran 1 ns per window, not infinity. This is a remarkably small uncertainty for FEP ‚Äî typical is ¬±0.5-1.5.</p>

<h3>ŒîŒîG = +2.34 kcal/mol (Febuxostat)</h3>
<p><strong>Positive ŒîŒîG = weaker binding in the mutant.</strong> The drug binds R702W less tightly than WT by 2.34 kcal/mol. In FEP, anything above ¬±1.0 kcal/mol is considered significant.</p>

<h3>Converting to Fold-Change (The ${au('Boltzmann','Boltzmann')} Equation)</h3>
<p>ŒîG relates to the dissociation constant K<sub>d</sub> (how easily drug detaches):</p>
<p><strong>ŒîG = RT √ó ln(K<sub>d</sub>)</strong> where R = 1.987 cal/mol/K, T = 310 K ‚Üí RT = 0.616 kcal/mol</p>
<p>For the CHANGE in binding: <strong>K<sub>d,mut</sub>/K<sub>d,WT</sub> = e<sup>(ŒîŒîG/RT)</sup></strong></p>
<p><strong>Febuxostat:</strong> e<sup>(2.34/0.616)</sup> = e<sup>3.80</sup> = <span class="n">44.7 ‚âà 50-fold weaker</span></p>
<p>If Febuxostat had K<sub>d</sub> = 10 nM for WT, it'd be ~500 nM for R702W. That's typically the difference between a viable drug and a failed one in clinical trials.</p>
<p><strong>Bufadienolide:</strong> e<sup>(‚àí0.44/0.616)</sup> = e<sup>‚àí0.71</sup> = 0.49 ‚Üí actually ~2√ó BETTER. But at 1.8œÉ this is <strong>not statistically significant</strong> ‚Äî indistinguishable from zero effect within error bars.</p>
</div>

<h2>What 8œÉ Means</h2>
<div class="c co">
<p>œÉ (sigma) = standard deviation of the uncertainty. <strong>8œÉ</strong> means the signal is 8 standard deviations above zero.</p>
<p>Calculation: ŒîŒîG/œÉ<sub>ŒîŒîG</sub> = 2.34/0.26 ‚âà 9.0œÉ (poster rounds to 8œÉ)</p>
<p>For context: In particle physics, <strong>5œÉ is considered a discovery</strong> (the Higgs boson was announced at 5œÉ). In drug discovery, 3œÉ is typically "significant." Your result at 8œÉ is <em>extraordinarily</em> robust.</p>
<p>The probability of a random fluctuation producing 8œÉ: p < 10<sup>‚àí15</sup>. For practical purposes: <strong>this is not random noise. Febuxostat genuinely binds weaker to R702W.</strong></p>
</div>

<h2>WHY Febuxostat Fails at R702W ‚Äî The Mechanism</h2>
<div class="c cr">
<p>${au('febuxostat','Febuxostat')} binding depends on <strong>electrostatic contacts</strong>:</p>
<ul>
<li><strong>Key interaction:</strong> Febuxostat forms a ${au('hydrogen_bond','hydrogen bond')} with ${au('ASP1011','ASP1011')} (aspartate, negatively charged) in the LRR pocket</li>
<li>Febuxostat also has a carboxylate group (COO‚Åª) that participates in a salt bridge with ARG residues</li>
<li>These ${au('electrostatic','electrostatic')} interactions are <strong>geometry-sensitive</strong> ‚Äî the donor and acceptor atoms must be within 3.5 √Ö at the correct angle (120-180¬∞)</li>
</ul>
<p><strong>R702W effect:</strong> The mutation rigidifies the protein (proven by your MD). This rigidification propagates 79.4 √Ö through HD2‚ÜíLRR, subtly shifting the pocket geometry. The ASP1011 side chain moves just enough (~0.5-1.0 √Ö) that the H-bond with Febuxostat is disrupted. Lost H-bonds = lost enthalpy = weaker binding by +2.34 kcal/mol.</p>
</div>

<h2>WHY Bufadienolide Survives ‚Äî The Mechanism</h2>
<div class="c cg">
<p>${au('bufadienolide','Bufadienolide')} (CID 10120) binding depends on <strong>${au('hydrophobic','hydrophobic contacts')}</strong>:</p>
<ul>
<li>Bufadienolide is a steroidal natural product ‚Äî large, flat, nonpolar ring system</li>
<li>It binds via ${au('van_der_waals','van der Waals')} interactions with nonpolar residues (LEU, ILE, VAL, PHE) lining the LRR pocket</li>
<li>Hydrophobic contacts are <strong>shape-tolerant</strong> ‚Äî they depend on surface complementarity, not precise atom-atom distances</li>
</ul>
<p><strong>R702W effect:</strong> Even though the pocket rigidifies, the overall nonpolar surface geometry remains similar enough. Hydrophobic contacts don't require the same geometric precision as H-bonds (3.5 √Ö + angle vs 4-6 √Ö contact distance). Bufadienolide maintains its contacts ‚Üí ŒîŒîG ‚âà 0.</p>
<p><strong>Novel finding:</strong> No prior reports of Bufadienolide interacting with NOD2 exist in the literature. This is a genuinely new discovery.</p>
</div>

<div class="ky">
<strong>The Big Insight:</strong> Mutation effects on drug binding are <strong>ligand-dependent</strong>, not universal. You cannot develop "a NOD2 drug" and assume it works for all patients. Drug choice must account for patient genotype. This is the foundation of ${au('pharmacogenomics','pharmacogenomic')}-guided NOD2 therapeutics ‚Äî ${au('precision_medicine','precision medicine')}.
</div>

<h2>MM-GBSA vs FEP Disagreement</h2>
<div class="c co">
<p>MM-GBSA (your earlier, cheaper calculation) gave a DIFFERENT ranking than FEP. This is a critical lesson:</p>
<p>MM-GBSA approximates water as a smooth dielectric field (implicit solvent). FEP simulates every water molecule explicitly. For computing ŒîŒîG (the DIFFERENCE between WT and mutant), the water rearrangement around the drug matters enormously. MM-GBSA can't capture this. FEP can.</p>
<p>If you had stopped at MM-GBSA, you would have drawn <strong>wrong conclusions</strong> about which drugs are mutation-sensitive. FEP was necessary for the correct answer.</p>
</div>
`},

// ============ PRESENTATION ============
{id:'talk',icon:'üé§',label:'Presentation',ct:`
<h1>Your 3-5 Minute Presentation</h1>
<p class="sub">Pitch script, judge Q&A with scripted answers, body language tips.</p>

<h2>The 3-Minute Pitch</h2>
<div class="c ca">
<h3>HOOK (20 seconds)</h3>
<p><em>"When I was 14, a genetic test showed I carry the R702W variant of NOD2 ‚Äî a mutation linked to Crohn's disease. My geneticist said, 'We can't fix the mutation. You'll need Remicade infusions.' I wanted to understand: what does this mutation actually DO at the molecular level, and can we find drugs that work despite it?"</em></p>

<h3>PIPELINE (60 seconds) ‚Äî Point at Figure 10</h3>
<p><em>"I built a computational drug discovery pipeline starting with 9,566 compounds ‚Äî FDA-approved drugs and natural products. GNINA, a convolutional neural network-based docking tool, scored each compound's fit in NOD2's LRR binding pocket.</em></p>
<p><em>Then I trained NOD2-Scout, an XGBoost classifier using molecular fingerprints and physicochemical descriptors, validated with scaffold-split cross-validation to ensure the model generalizes to new chemical families ‚Äî not just memorizing known scaffolds. We caught and corrected data leakage that initially inflated our AUC to 0.998; the honest AUC is 0.85 to 0.93.</em></p>
<p><em>After ADMET safety filtering and expert curation, I ran over 520 nanoseconds of molecular dynamics simulation to confirm the top candidates maintain stable pocket binding."</em></p>

<h3>DISCOVERY (40 seconds) ‚Äî Point at Figure 16</h3>
<p><em>"The key experiment was Free Energy Perturbation across 120 lambda windows. Febuxostat, our top FDA candidate, shows a ŒîŒîG of plus 2.34 kilocalories per mole ‚Äî 8 sigma significance, p less than 0.001 ‚Äî meaning it binds approximately 50-fold weaker to the R702W mutant. The mutation disrupts an electrostatic contact network with ASP1011.</em></p>
<p><em>But Bufadienolide, a natural cardiac glycoside, shows no significant change. Its hydrophobic binding contacts are robust to the mutation-induced rigidification. This is a previously unreported NOD2 interaction."</em></p>

<h3>CLOSE (20 seconds)</h3>
<p><em>"This demonstrates that mutation effects on drug binding are ligand-dependent ‚Äî with direct implications for pharmacogenomic-guided therapeutics. We can potentially choose the right NOD2 drug based on the patient's genotype."</em></p>
</div>

<h2>Top Judge Q&A</h2>
${ex('j','Why AlphaFold instead of a crystal structure?',`
<p><strong>Answer:</strong> "No complete crystal structure of human NOD2 exists. The closest, PDB 5IRM, covers only the CARD and NBD domains ‚Äî residues 1 through 577. The LRR domain where our compounds bind, residues 744 to 1040, is entirely absent. AlphaFold2 predicted full-length NOD2 with pLDDT scores above 90 in the LRR region, which corresponds to approximately 2-Angstrom experimental resolution. We acknowledge this as a limitation and plan to validate with experimental structures when available."</p>
`)}

${ex('j','How do you know the ML isn\'t just memorizing?',`
<p><strong>Answer:</strong> "Three controls. First, scaffold-split cross-validation ‚Äî no molecule in the test set shares a Murcko scaffold with any training molecule. The model must generalize to entirely new chemical families. Second, the shuffled-label negative control ‚Äî randomize labels, retrain with identical parameters, AUC drops to 0.50, pure random chance. The real AUC of 0.85 to 0.93 represents genuine binding signal. Third, we initially detected data leakage when random splits gave an AUC of 0.998 ‚Äî we identified, diagnosed, and corrected it, which I believe demonstrates scientific rigor."</p>
`)}

${ex('j','Explain ŒîŒîG = +2.34 in practical terms',`
<p><strong>Answer:</strong> "Through the Boltzmann relationship at body temperature, 2.34 kcal/mol converts to approximately 50-fold weaker binding affinity. If Febuxostat had a dissociation constant of 10 nanomolar for wild-type NOD2, it would be roughly 500 nanomolar for the R702W variant. In drug development, that magnitude of affinity loss typically represents the difference between a clinically viable drug and a failed candidate. The 8-sigma significance means this is not within statistical noise."</p>
`)}

${ex('j','How does a mutation 79 Angstroms away affect the binding pocket?',`
<p><strong>Answer:</strong> "Classic allosteric mechanism, supported by our molecular dynamics data. Apo simulations show R702W reduces backbone RMSD from 4.05 to 3.27 Angstroms ‚Äî the mutant protein is more rigid. Critically, 12.6% of wild-type frames exceed 5 Angstroms deviation while R702W NEVER does. This rigidification propagates through the HD2-to-LRR helical interface. The functional consequence is quantifiable: Febuxostat's hydrogen bond network with ASP1011 in the pocket is disrupted, while Bufadienolide's hydrophobic contacts are geometry-tolerant and survive the conformational change."</p>
`)}

${ex('j','Did AI write your code?',`
<p><strong>Answer:</strong> "Claude Code CLI helped write and debug the Python implementation ‚Äî setting up OpenMM systems, writing batch processing scripts, debugging CUDA errors and SSH configurations. The scientific decisions ‚Äî choosing methods, setting simulation parameters, interpreting results, designing the pipeline ‚Äî those were mine. Every AI interaction is documented with timestamps in my logbook and a dedicated AI Prompt Log appendix. I can show you specific examples of what I asked AI versus what I decided independently."</p>
`)}

${ex('j','What would you do next to validate this?',`
<p><strong>Answer:</strong> "Three experimental approaches. First, surface plasmon resonance ‚Äî SPR ‚Äî to measure binding kinetics and confirm the predicted affinity difference between WT and R702W. Second, isothermal titration calorimetry ‚Äî ITC ‚Äî to decompose the binding thermodynamics into enthalpy and entropy contributions, which would validate whether Febuxostat's penalty is enthalpic as our simulations predict. Third, HDX mass spectrometry to map which residues change dynamics upon drug binding, directly testing the allosteric mechanism. We'd also extend to G908R and 1007fs variants to build a complete mutation sensitivity profile."</p>
`)}

${ex('j','Why only 2 compounds through FEP? Why not more?',`
<p><strong>Answer:</strong> "FEP is computationally expensive ‚Äî 120 lambda windows, each requiring 1 nanosecond of simulation, for just 2 compounds. That's 120 nanoseconds of GPU time. On my RTX 4060 Ti, each compound pair took approximately 48 hours. Running FEP on all 148 ADMET-passing compounds would take over 3,500 GPU-hours ‚Äî infeasible for a high school project. The two compounds selected represent distinct binding mechanisms ‚Äî electrostatic-dependent versus hydrophobic-dependent ‚Äî which was sufficient to demonstrate the principle that mutation effects are ligand-specific."</p>
`)}

<h2>Body Language & Delivery Tips</h2>
<div class="c">
<p><strong>Point at your poster</strong> as you talk ‚Äî guide the judge's eyes to each figure. Touch the poster near the relevant panel. This keeps judges engaged and shows you know your layout.</p>
<p><strong>Slow down for key numbers:</strong> "eight sigma‚Ä¶ fifty-fold weaker‚Ä¶ zero prior reports." Let these land. Pause after each one.</p>
<p><strong>Eye contact</strong> when delivering the discovery and close, not when reciting methods. Methods = look at poster. Discovery = look at judge.</p>
<p><strong>If you don't know an answer:</strong> "That's a great question. I haven't investigated that yet, but based on my results, my hypothesis would be‚Ä¶" ‚Äî then give your best scientific reasoning. Judges LOVE when students can reason through unknowns.</p>
<p><strong>Personal connection:</strong> If they ask about motivation, you can briefly mention carrying the variant yourself and receiving Remicade infusions. Don't dwell ‚Äî ~10 seconds max. Let the science speak for itself.</p>
</div>
`},

];

// ============ RENDER ENGINE ============
const sb=document.getElementById('sb'),mn=document.getElementById('mn'),ct=document.getElementById('ct');
S.forEach((s,i)=>{
const b=document.createElement('button');b.className='sb'+(i===0?' on':'');b.innerHTML=s.icon+' '+s.label;b.onclick=()=>go(s.id);sb.appendChild(b);
const m=document.createElement('button');m.className='mb'+(i===0?' on':'');m.textContent=s.icon;m.title=s.label;m.onclick=()=>go(s.id);mn.appendChild(m);
const d=document.createElement('div');d.id='s_'+s.id;d.className='sec'+(i===0?' on':'');d.innerHTML=s.ct;ct.appendChild(d);
});
function go(id){
document.querySelectorAll('.sb,.mb').forEach(b=>b.classList.remove('on'));
document.querySelectorAll('.sec').forEach(s=>s.classList.remove('on'));
const ix=S.findIndex(s=>s.id===id);
document.querySelectorAll('.sb')[ix]?.classList.add('on');
document.querySelectorAll('.mb')[ix]?.classList.add('on');
document.getElementById('s_'+id).classList.add('on');
window.scrollTo(0,0);
}
function sL(sec,lv){
const b=document.getElementById(sec+'_b');if(!b)return;
b.className='sL'+lv;
const btns=document.getElementById('lv_'+sec)?.querySelectorAll('.lb');
btns?.forEach((b,i)=>b.classList.toggle('on',i===lv-1));
}
</script>
</body>
</html>
